基于反步法和非线性动态逆的无人机三维航路跟踪制导控制
为实现无人机在大范围内稳定、精确地跟踪三维参考航路,基于制导与控制回路独立设计的思路,提出了一种无人机三维航路跟踪制导控制方法.在制导外环,引入沿参考航路飞行的虚拟无人机作为向导并利用反步法设计三维航路跟踪的非线性制导律;在控制内环,以非线性动态逆理论和奇异摄动理论为基础,设计由机动指令生成器、角度转换器、慢回路姿态控制器和快回路角速度控制器所组成的飞行控制模块,对制导外环给出的制导指令进行快速精确地跟踪.基于Lya-punov稳定性理论证明了无人机航路跟踪制导控制方法的稳定性.通过对比分析无人机6自由度模型下的三维航路跟踪仿真,说明所提出的制导控制方法能够使得无人机精确地跟踪参考航路,从而验证了该方法的有效性、合理性.

飞行器控制、导航技术 无人机 航路跟踪 反步法 非线性动态逆 制导控制  

0引言
对于无人机来说,由于其为无人驾骇,《行及任
务执行都需要制导与控制系统操纵,使无人机按照
航路规划系统规划出的航路飞行。为了能沿着或贴
近规划好的航路飞行,要求无人机跟踪或者跟随该
规划好的航路“1。航路跟踪和航路跟随的区别在
于对时间有无严格要求“。相对于航路跟随而言,
航路跟踪较为复杂,不仅航路偏差需要控制,而且相
应的跟踪航路时间误差也需要控制,这意昧着需要
同时对无人机的速度大小和方向进行控制,对于航
路跟随问题,无人机的速度大小保持恒定不变,只需
对其速度方向进行控制即可。航路跟踪主要应用于
无人机编队控制,自动空中加油,对动态目标的追踪
等动态任务,相较航路跟随更有实际意义。
针对无人机的航路跟踪/路随问题,许多学者进
行研究并取得了一系列成果,提出诸如采用位置误
差的PD控制律、Serret-Frenet坐标系法、向量场法、
视线法等等航路跟踪/跟随的理论和算法。文
献[3-5]提出一种能跟随曲线航路的非线性制导
律,该制导律在路随直线航路时近似为PD控制律,
在路随曲线航路时,由于起到前馈控制的作用而使
跟踪能力得以提高并能抑制干扰的影响;
Nelson等〔(…〕和Lawrence砻「堇=瞠〔_′〕基于矢量场研究了一
种精确跟随航路的算法,并用Lyapunov方法证明了
在干扰条件下跟随误差方程的稳定性,但该方法一
般适用于由直线与圆弧组成的航路,并且用该方法
构造一般航路的矢量场较为复杂。文献[8]根据改
进的纯追踪法提出了一种非线性航路跟随导引方
法,并应用于受油机横、纵向导引控制,以实现精确
控制受油机的飞行轨迹。Skjetme等““将航路路蹈
问题分解为儿何任务和途度任务,几何任务使无人
机的位置收敛于参数化的期望航路,速度任务使得
相应的跟踪航路时间误差趋于0,但跟踪精度不高。
David等01在文献[3-5]的基础上设计了一种三
维航路跟随控制律,来跟踪三维空间中直线和圆弧,
该控制律能使无人机的航迹收敛于期望的航路,但
该方法需要在直线段和圆弧段进行切换,在工程上
难以实现。Ambrosino等“设计了一种基于视线的
方法用于跟随利用Dubin算法规划出的三维空间航
路。该方法在参考航路的切线上确定一个移动的前
视点,该点与无人机在参考航路上正交投影点的距
离为固定值L,称之为前视距离。利用无人机与前
视点的位置误差矢量来设计关于航迹角的制导律,
使得位置误差控制和航迹角误差控制解耦,反馈控
制律形式简单,跟踪精度较高,鲁棒性较好,工程上
易于实现,但该方法不足之处为不能给出无人机速
度制导指令,这意昧着其速度是恒定的,因此该方法
只能实现参考航路的跟随,不能实现航路跟踪。
另外值得指出的是,在上述文献中,无人机通常
以质点运动模型为主,较少考虑无人机的非线性动
力学特性,没有与无人机的飞行控制系统结合起来,
那么上述跟踪算法能否应用于工程实践还有待验
证。若考虑无人机的非线性动力学特性时,实现无
人机三维航路跟踪控制通常有两种方式“:一种是
制导和控制一体化设计;另一种是札用制导与控制
回路独立设计。制导与控制回路独立设计的方式物
理概念更明确,也更容易实现「“。Kaminer等21采
用制导和控制一体化设计的思想,给出了一种制导
和控制组合设计方法,给出了基于参考航路控制系
统的线性模型,并采用增益调度技术设计了飞行控
制系统。文献[11]采用制导与控制回路独立设计
的思想,在外回路中设计基于视线法的航路跟随制
导律,但其内回路的飞行控制系统仍然采用基于小
扰动方程的传统设计方法,同Kaminer等“的方法
一样存在着不能保证在全局范围内满足稳定性和精
确性要求的缺陷。导致这一问题的主要原因是在对
无人机6自由度非线性方程进行线性化过程中将不
可忽视的非线性关系用线性关系代替或忽略。
针对以上研究中的缺陷,本文采用制导与控制
回路独立设计的思路,在制导外环,通过引人沿参考
航路飞行的虚拟无人机作为向导,将无人机的跟踪
对象从参考航路转移到虚拟向导的位置信息和速度
信息上,在此基础上利用反步法设计了三维航路跟
能够满足无人机非线性强耦合的控制要求,因此在
控制内环,针对无人机非线性动力学特性,将非线性
动态逆方法和奇异摄动理论相结合,设计了由机动
指令生成器、角度转换器、慢回路娇态控制器和快回
路角速度控制器所组成的飞行控制模块,对制导外
环给出的制导指令进行精确地跟踪,解决了无人机
在大范围内满足稳定性和精确性要求的三维航路跟
踪问题。
1“航路跟踪制导控制系统结构
如图1所示,采用制导与控制回路独立设计思
路,将无人机三维航路跟踪制导控制问题划分为康
无人机6自由度、12个状态的非线性动态模
UV FOR Hy
式中:无人机状态变量x=[P￠r￠0￠〗
aBxyz]「,p、4、r分别为滚转角速度、俯仰
角速度和偏航角速度,4、0、4分别为滚转角、俯仰角
和偏航角,v、a、8分别为无人机的空速、攻角和侧滑
fay为无人机在惯性系中的位置;控制输人
u=[F58。5.]7,8.、5.、5.分别为升降舵、副翼
和方向舵偏转角,F为发动机的推力。
3“非线性动态逆飞行控制
直接应用状态反馈动态逆控制方法,需要求全
逆,必须满足控制量与状态量数量相同的条件,这在
导指令,该制导指令输人到飞行控制部分中,以驱动
无人机精确跟踪参考航路;飞行控制郜分主要包括
机动指令生成器、角度转换器、慢回路娅态控制器
和快回路角速度控制器。机动指令生成器主要是
根据航路跟踪制导指令,对无人机速度,航迹倾角
和航迹偏角进行控制,这是控制飞行轨迹所必需
的;角度转换部分实现航迹角和威态角的转换,其
本质是机动指后生成器和慢回路姿态控制器之间
的耦合环节;慢回路姿态控制器对无人机横滚角、
俯仰角和偏航角进行控制;快回路角速度控制器
用于对无人机娅态角速度进行控制。无人机非线
性模型是指无人机6自由度非线性微分方程。
状态量和4个控制量)。为了避免这种不足,需将
非线性动态逆方法与奇异摄动理论相结合,用部分
逆方法“5““近似求解。
当气动力的改变导致力矩大小改变时,首先会
引起无人机姿态角速度(p,e,r)的改变,然后会使得
无人机的娅态角(4,6,4)发生改变。因此,根据无
人机飞行状态的响应速度,可以设计出慢变的姿态
角控制和快变的威态角速度控制两个回路。如果快
回路带宽为慢回路带宽的5~10倍,就可以使得快
回路快速精确地跟踪慢回路。
3.1“快回路控制器设计
快回路动态逆控制器根据慢回路动态逆控制器
产生的角速度指令[p「,4「,r“],以及无人机自身的
状态变量,获得舵偏角指令[5.,5.,5.1,输人到无人
Rex, =v, a, B, p, 4, r, wu, Y] , 为 航 迹 滚 转
角,y为航迹俯仰角:f(x,)为飞机除去舷面操纵力
矩后的滚转、俯仰和偏航力矩,
弃 ( =14G) Sf, L(x) TT,
f(x) = (cur + cop)9 +
4为动压,为参考翼面积,e为平均气动弦长,为
翼展,Cf、CwCy分别为与上标有关的滚转、俯仰
和偏航气动系数或气动导数,c,=[(-D+).
L1/3,L001分别为各轴向转动惯量,1..为惯性
积 , 吊 =LL - 歪 ,o = [( - 工 ) - 一 ]/7c = F/ 丁 ,
co =1,/3c5= (I, =I)/1 eq = 厂 / ,c =1/1 ,cs =
[( -17) - 厂 ]/3,cs =1./5;8,(x,) 的 表 达 式 为
g(x) =
根据动态逆控制原理,快回路的控制律为
设忠回路期望的闭环动力学系统为一阶环节,
那么令伪控制量
式中:W,=diag(W,,W,,W,)为快回路带宽;xi=
及无人机自身的状态变量,获得角速度指令[p「,gq“,
r“],输人到快回路中。
慢回路动态逆控制器选取的状态变量为无人机
的姿态角x,=[4,0,%],控制量为角速度指令x],
则可得到如下形式的仿射函数:
x, =g,(x;) x. (9)
8g,(x,)的表达式为
同理,得到慢回路的控制律为
设慢回路期望的闭环动力学系统为一阶环节,
那么令伪控制量
式中:W,=diag(,,,,印,)为慢回路带宽;x:=
[67,00I"为姿态角指令信号,由角度转换器产
生。
3.3“角度转换器设计
由于机动指令生成器主要作用是根据非线性制
导指令来产生关于推力f攻角a、侧滢角8、航迹滚
转角人\航迹俯仰角y和航迹偏航角x的指令信号。
然而姿态角控制回路输人的信号是姿态角指令,因
此,需要在机动指令生成器和姿态角控制回路之间
加人一个角度转换器,用来根据攻角a,侧滑角,航
迹角解算出相对应的姿态角。反过来,也可以根据
攻角a、侧滑角8、姿态角解算出相对应的航迹角。
根据惯性系和机体系之间的变换关系,可以得
到如下矩阵方程:
F:(td)F,(8)F.( 外 ) =
当cos040时,如果已知[a,8,h,y炀】可以根
据(13)式唯一确定无人机的姿态角[,9,b]。
3.4“机动指令生成器
机动指令生成器主要是根据航路跟踪制导指
令,对无人机速度矢量(v,y,X%)进行控制,是控制飞
行轨迹所必需的。机动指令生成器也采用非线性动
BUHHERE,根据非线性制导指令[vx]
般要求保持为0“““1,忽略侧力,可将(14)式筒化为
氨2=素(F(〕()s(】【一J眨)_)镳′7矗(Fgsin`y)，(15)
AF,为空气阻力;FuL为升力。
如果忽略慢回路的动态响应,针对(15)式-
(17)式采用解析法求得的控制律为
COS ?&￠
B =0°, (21)
F, = mocos ysin py* +
〈r′Z警又′鏖′(i+r厂矗gC0Sy)cosu’―-F(22)
式中:m为无人机质量;g为重力加速度。
期望的闭环动力学系统可以选取为一阶环节,
那么令
超=[许,光]二印(-力),(24)
HAW,=diag(W,,W,,W,)为机动指令生成命的
带宽;x;=[,y「X「]由非线性制导律产生。
4“基于反步法的航路跟踪制导律
航路跟踪制导律的设计是实现无人机精确跟踪
参考航路的关键。无人机在进行航路跟踪之前,必
须确定其参考航路的特性,如果引人一个虚拟无人
机作为向导,让它沿着参考航路飞行,那么可以根据
无人机的质点运动方程得到每一时刻虚拟向导的位
BEL(x,yA)和速度信息(o.,y.,Xx:),将虚拟向
导的位置信息和速度信息作为真实无人机的参考信
号,从而可将无人机直接对参考航路的跟踪问题转
换成对虚拟向导的跟踪问题,这样做可以简化三维
基于反步法的航路跟踪制导律的原理如图2所
示,假设有一架沿着预定参考航路厂飞行的虚拟无
人机P作为真实无人机U的向导,那么预定的参考
航路乙可以用虚拟向导的质点运动学方程来描述:
Ax,yh,表示虑拟向导的位置;o.、y.,,分别
表 示 虚拟向导的速度、航迹倾角、航迹偏角。
的,其期望的闭环动力学系统设计成一阶环节。因
此,无人机的质心运动学和动力学模型可以写成如
下形式;
式中:“、o,分别表示空速和地速;ysFATWAx,
为航迹偏角;w,、w,和w分别为风速w在地面系上
的投影。
基于反步法的航路跟踏制导律由定理给出。
定理(基于反步法的航路跟踪制导律)当给
定的参考航路7由微分方程(25)式来描述,无人机
的质心运动学和动力学模型可以写成(26)式、
(27)式的形式时,那么按照(28)式给出的非线性航
式中:““、y“x为航路跟踪位置误差渐进收敛到0
的期望速度、期望航迹倾角、期望航迹偏角;e,ve,e
为航路跟踪的速度误差、航迹倾角误差和航迹偏角
误差。
1)引人虚拟控制量oyx"2古=o“cosy7,
谚=gtsin′)"i,则有
定义航路跟踪位置误差为
e,=%-1%,,6,=y~-￥,6=h-h,. (30)
对(30)式两边求导,可得
二光一光8二五一孕6=月-(31)
如果令航路跟踪位置误差指数收敛到0,则有
式中:a.、a,和a为大于0的常数。那么由(29)式、
(31)式、(32)式可得
后(33)式中右端项分别记为
根据(33)式和(34)式可以求得
口二训8=力一训8=元一元(41)
同样令航路跟踪速度误差指数收敛到0,则有
式中;B,、8B,MB,为大于0的常数。由(41)式、
(42)式可得
将(27)式代入(43)式经整理,即可得到非线性航路
跟踪制导律(28)式。其中i、y“x!可分别由(37)式、
(38)式、(39)式求导得到。
最后利用Lyapunov稳定性理论,来证明采用
(28)式所示的非线性航路跟踪制导律能够保证
|e‖―0.选取如下所示的Lyapunov函数
对时间求导得
JL(e) =e:6: + e,6, +ee, tee, +ee tee =
-a 吴 -ae - 吴 -B.e - Bel -B <0.
(45)
因此，当1一十?日寸_，撕_>宪l′，〕'_>〕/′r，/′′__′}/'′【，22_>誓/【】，
寸d
YY心一求,
4 v, =wvcosycosy,v, = 2Cosysiny ,0, = vsiny , =
碉00SydCOS%d ,09 二 渊c037dsin入/d ,v = gtsin y“ , 那 么 由
2一Vyyxox!司矫,5:一,一0,0\一D5,用
Fe, ―0,e,―0,e,―0, WHE (33) 式 、(34 ) 式 可 知 ,
2一克―w,vy,-w,,vy―h,―w,,因此0:一%,一
20,川y一〉夕r一鲁麓义y，餮义′'_}′乙r一趸h,那么有v,+w,x,,0,+
w,―Yy, ? Vp + w,―h, , BT LA V0, Ye Ys Xe Xr
证毕。
5“虚拟向导飞行轼迹的生成
从航路跟踪制导律的表达式可以看出,为了实
现无人机对参考航路的精确跟踪,需要知道每时刻
虚拟向导在参考航路上的飞行状态信息,例如位置
信息[x.,y.,h.]7,速度信息[5.,;7.,h.]7和加速度信
息[ .,7,,h:.]7。由于虚拟向导沿着参考航路飞行,
设航路点生成虚拟向导的飞行轨迹。
根据预设航路点生成虚拟向导的飞行轨迹的原
理如图3所示,将航路点按序号连线成为直线航路,
各直线段航路的航迹倾角y:s(-0.57,0.5T)和
航迹偏角xvs[0,2m)为
bx
图 3 根据航路点生成虚拟向导的飞行轨迹
Fig.3 Flight path planning for virtual vehicle in light
of reference waypoints
在无人机飞行过程中,虚拟向导P会沿着参考
航路飞行,而参考航路由连续的线段组成。因此,可
以根据无人机的当前位置选择合适的当前跟踪航路
段,并在当前路踪航路段上计算出虚拟向导P的速
Boo,及其变化率4.(o.、4,需要根据具体的飞行任
务和无人机的飞行性能综合确定),航迹倾角y.及
其变化率y.和航迹偏角x,及其变化率..
假设无人机当前跟踪第*段航路P:-,Px,则有
Ye SVX: =Xx,Y: =0,x, =0. 那 么 根 据 (25 ) 式 可 求
Bl, kh) ETH 5. =0,3, = 0,h, = 0 将
xy,ho,对时间5积分即可求得每时刻虚拟向导的
LExyh.这样就得到了每时刻虚拟向导在参
考航路上的飞行状态信息,并将其应用于非线性航
路跟踪制导律,可以驱动无人机对当前航路段进行
6.1“仿真实验1
采用无人机的6自由度非线性数学模型,对基
于反步法和非线性动态逆的无人机三维航路跟踪制
导控制方法进行了仿真验证。
仿真过程中,无人机的气动系数根据文献[14]
中给出的数据经过插值计算而来;给定的航路点参
数如表t所示;姿态角速度控制回路、姿态角控制回
路以及机动指令生成器的带宽为:W,=W,=W,=
10 rad/s, W, = W,=W, =2 rad/s, W, =W, =W, =
0.4rad/s;航路跟踪制导律参数为:a,=a,=a,=1s一,
B.=B,=B,=4s";无人机的初始位置为(1000m,
1000m,3000m),初始飞行速度为530mxs,初始航
迹偏角和航迹倾角均为0“,要求无人机沿着航路点
连线飞行,速度保持为50m/s,当无人机到航路点
P的距离小于r=50m时,开始跟踪下一直线航路
BPP,仿真时间步长为At=0.001s.
表 1 参考航路点数据
Tab. 1 Data of reference waypoints
航 路 点 x/m y/m ( 上 = -z) /m
P, 1 000 1000 3 000
巳 , 3 000 1 000 2 800
Ps 4 000 2 000 3200
P, 5 000 4 000 3 000
Ps 7 000 5 000 2 800
P, 9 000 7 000 2 600
在此,将基于反步法和非线性动态逆(BS+
NDI)的制导控制方法与文献[11]中的基于视线和
增益调度(LOS+GS)的制导控制方法进行仿真对
比。从跟踪精度和对参考角度的跟踪效果上来说明
BS+NDI方法的优点。
图 4 为参考航路点连线和两种方法的仿真飞行
航迹的对比结果。为了比较两种方法的跟踪精度,
引人交叉误差作为评价指标。在本文中,交叉误差
定义为无人机到参考直线航路段的垂直距离,在
图 3 中用4表示。
图 5 是两种方法的交叉误差对比结果,BS+
无人机的速度基本保持不变。
图 7 图8为参考航迹倾角、航迹偏角和实际航NDI方法分别存在8.9%4%的超调量,而LOS+
到P,P,时,对参考航迹倾角、航迹偏角的跟踪BS+
为真实无人机的跟踪对象,并且其外环制导律能与
内环的动态逆控制律有效地结合,更适于解决无人
机大机动的航路跟踪控制问题,所以对参考航迹倾
角和航迹偏角进行跟踪时,BS+NDI方法的超调量
更小,跟踪效果更好。
置误差的变化曲线,从中可以看出BS+NDI方法能
够保证位置误差指数收敛到0,因此能够实现对空
间三维参考航路的精确跟踪。
总之,所提出的BS+NDI方法实现了无人机在
大范围内满足稳定性和精确性要求的三维航路路踪
制导控制,在整个航路跟踪制导和控制系统的作用
下,无人机能以较小的偏差沿着参考航路飞行,只有
在航段切换的转弛机动过程中存在着较大的偏差,
这是因为在转弛机动时,虚拟向导将切换到下一个
航路点的连线上,此时无人机需要调整自身的速度、
航迹倾角和航迹偏角,以跟踪虚拟向导,但是在这之
后无人机的速度、航迹倾角和航迹偏角均实现了对
各自参考指令的跟跋,同时与虚拟向导的位置误差
精确跟踪,并且从表2中可以看出,无论是在跟踪精
度上,还是在对参考航迹倾角和航迹偏角的跟踪效
果上,BS+NDI方法均要优于LOS+GS方法。
表 2 两种方法的对比
Tab.2 Comparison of two methods
方法仿真时间/超调量平均交叉
s y X/% 误 差 /m
BS + NDI 211.171 万 8. 9 万 4.0 5.03
LOS + GS 215.001 <14.2 <7.3 6.32
6.2仿真实验2
为了分析BS+NDI方法在稳定侧风下对参考
航路的跟踪效果,进行有风环境下和无风环境下的
航路跟踪对比仿真。选取参考航路为一段直线航
路,航路起点为P,(0m,0m,3000m),航路终点为
P,(1000m,1 000 m,3 000 m ) 。 加 人 风 速 恒 为
20mxs的稳定侧风w,其在地面系s、y和z轴上的3个
投 影 分 量 为 w, =0 m/xs、w, = -20m/s 和 , =0 m/s.
无人机的初始位置为(0m,0m,3000m)。航路跟
踪 制 导 律 参 数 为 :a. =a, = a, = 0.1 s ,8B, = B, =
B,=0.4s"".其他条件与仿真实验1一致。
图 10 为有风和无风环境下,BS+NDI方法对参
考航路P,P,的路踪效果。图11为有风和无风条件
下的交叉误差对比结果。其中在有风环境下,平均
芝叉误差为32.3mi;无风环境下,平均交叉误差为
24.74m.从图10和图11中可以看出,在稳定侧风
的影响下,蚺然无人机的飞行轨迹与参考航路之间
的偏差比无风时要大,但BS+NDI方法仍然能够实
现无人机对参考航路的跟踪。
图 12 图13和图14分别为有风和无风条件下
的无人机速度、航迹倾角和航迹偏角的对比结果。
度,参考航迹倾角和参考航迹偏角,BS+NDI方法仍
具有良好的跟踪效果。因此,在有风环境下和无风
环境下的航路跟踪对比仿真结果,验证了BS+NDI
方法在稳定侧风的影响下仍然能够实现无人机对
三维参考航路的跟踪。
7“结论
基于制导与控制回路独立设计的思路,提出了
一种无人机三维航路跟踪制导控制方法,通过对比
仿真验证了该方法的可行性,得到了以下结论;
1)通过引人沿参考航路飞行的虚拟无人机作
为向导,将被控无人机的跟踪目标从参考航路转移
航路跟踪控制律的设计难度,提高航路路踪效果。
2)设计的非线性动态逆飞行控制器能对制导
指令进行精确跟踪,并在全局范围内滢足稳定性要
求,同时响应曲线平滑,超调量小。
3)采用无人机的6自由度非线性数学模型进
行的三维航路路踪的仿真对比实验表明,所提出的
无人机三维航路路踪制导控制方法能够实现无人机
对三维参考航路的精确路踪。
4)通过在有风环境下和无风环境下的航路跟
踪对比仿真,验证了所提出的无人机三维航路跟踪
制导控制方法在稳定侧风的影响下仍然能够实现无
人机对三维参考航路的路踪。
5)动态逆方法依赖于被控对象的精确数学模
型,当不能精确求逆而导致逆误差存在时,控制内环
的鲁棒性不能得到保证,所以在后续工作中,还需进
一步研究如何抑制或者消除逆误差,以提高控制内
环的鲁棒性。
参 考 文 献 ( References )
[1] Tsourdos A, White B , Shanmugavel M. Cooperative path planning
of unmanned aerial vehicles [ M]. Bognor Regis, West Sussex,
UK:John Wiley and Sons Ltd, 2011.
