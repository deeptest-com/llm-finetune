重构X射线脉冲星信号的纯数值模拟新算法
基于X射线脉冲星的导航技术，无论技术研究还是实验验证，都是以X射线脉冲星信号为基础。但是实际的观测数据无法确定其精确值，不便于进行导航算法的分析验证。因此，通过模拟算法重构X射线脉冲星信号十分必要。基于泊松分布建立X射线脉冲星信号模型，介绍脉冲轮廓的构建方法；介绍了两种纯数值的脉冲星信号模拟算法。针对这两种算法因近似导致信号模拟不精确的问题，提出一种基于精确光子流量函数的纯数值X射线脉冲星信号的模拟算法，该算法采用分段线性函数拟合的脉冲轮廓函数，基于分布函数及其反函数导出。模拟算法重构PSRB0531＋21脉冲星的信号，并利用x^2拟合优度检验验证模拟算法生成的光子到达时间服从泊松分布。将提出的算法与两种已有的算法进行比较，仿真结果表明从光子数目和脉冲轮廓误差来看，提出的算法都优于其他两种算法，更接近实际信号。由新算法重构的脉冲星信号进行历元折叠得到观测脉冲轮廓，并将其与标准脉冲轮廓比较，发现随着观测时间的增长，观测脉冲轮廓趋近于标准脉冲轮廓，验证了模拟算法是有效可行的。

X射线脉冲星 泊松分布 信号重构 卡方拟合优度检验 模拟算法  

空间探测中如何实现深空探测器的完全自主
导航是一个头等难题。目前应用的导航方式主要
有天文导航、卫星导航.惯性导航和地基导航。传
统的天文导航依赖近天体进行定位,定位精度不
高,且操作复杂“-“。近地空间航天器可以利用
卫星导航系统实现较精确导航,但卫星导航系统
本身需要定位,自主性较差。惯性导航系统的误
差昼积效应严重,不能单独进行长时间的导航,一
般作为组合导航的辅助导航手段“1。地基导航
系统通常使用雷达测距和光学跟踪进行定位,但
对于深空导航,其定位的横向精度差,万完全依赖
地面站,地面站要进行大量的运算“1!。X射线脉
冲星是一类高速旋转,并发射X射线的中子星,
探测器接收到的X射线信号体现为周期性的脉
冲,其周期稳定性可以嫂美现在精度最高的原子
钟1。X射线脉冲星是天然的导航信标,脉冲星
导航是目前最具潜力实现深空自主导航的技术。
目前对X射线脉冲星导航的研究主要集中
在定位方面“,关键之一是脉冲相位估
计““。脉冲相位估计算法的仿真分析需要以
X射线脉冲星光子的到达时间作为实验数据“。
由于观测数据的精确相位未知,不能进行误差分
析;而重构的X射线脉冲星信号其相位已知,因
此利用模拟算法重构的脉冲星信号进行相位估计
算法仿真十分必耐。
X射线脉冲星信号的模拟有两种方法,实物
模拟和纯数值模拟。文献[12]采用实物模拟方
法,该方法成本高、精度低。文献[13]提出使用
可见光源和单光子探测器搭建实物模拟系统,提
高系统的灵活性和精度。,
文献[14]提出的模拟方法为纯数值模拟,该
方法成本低、灵活性强,但模拟过程将非线性泊松
过程的强度函数分段近似为恒定值,极大地降低
了模拟的精度。文献[15-16]都基于反函数构
建了数值模拟算法的数学模型,但前者并没有进
一步阑述反函数如何求解,后者则是对模型进行
了近似化简,避免了反函数的求解,这导致了信号
模拟的精度不高。
本文提出一种基于精确光子流量函数的纯数
值X射线脉冲星信号的模拟算法。该算法的数
学模型基于反函数建立,脉冲轮廓通过分段线性
函数拟合,从而反函数易求。然后以X拟合优度
检验作为验证方法,对信号模拟算法的有效伯进
行定量验证。最后比较了三种信号模拟算法,并
将本文提出的算法生成的观测脉冲轮廓与标准轮
廓比较,对信号模拟算法的有效性进行验证。
1信号模拟算法
1.1“信号模型
X射线脉冲星发射X射线光子是一个随机
过程,探测器记录的光子到达时间则服从非齐次
治松分布。设光子流量函数为(2),该函数表征
单位时间到达探测器的光子数目,标准脉冲轮廓
函数的表达式与光子流量函数相同。观测时段
To=二-吊,NW,为(ib,刃内到达的光子数目,W=
N,-N,为(t,s)内到达的光子数目,则W服从参
Boh[A(6)dE的泊松分布,在(t,s)内到达k个
光子的概率为:
其期望和方差为
表 示 光子单位时间到达的数目,可表示为
其中,+do为5时刻对应的相位,4为信号
的初始相位,4(t》=I亡二/′(〕_]谚A,FA,分别是背景
辐射密度和脉冲星辐射平均密度,单位与A相同
(tph/s,即每秒接收的光子数目),这两个量可从
天文观测数据得知。h(d)以1为周期,一满足归
一化条件
当 d>1 时 ,4(d) =h(d -n),n=floor(d),n 是
不大于4的最大整数。
1.2脉冲轮廓函数
脉冲轮廓可由历元折叠方法构建。X射线脉
冲星的信号由时间序列组成,在信号周期已知的
前提下,可以将若十个周期的信号折叠到一个周
期内。时间序列可表示为1ti*,转换方法如式
(5)所示。
堵=嗝一T'伽俳(景)(5)
其中,7为信号周期,Aoor(x)表示不大于x
的最大整数。将一个周期划分为N,个足够小的
区间,统计落在每个区间的光子数目n;,每个区间
长度为7=TXNWy,共有N,个周期的数据,则第i
个区间的平均光子流量函数
当观测时间足够长时N一oo,Ny一oo每个区
间的长度L―0,可以得到光滑、近似连续的标准
脉冲轮廓。
由式(2)可得
其中t:为第;个时间段的中点,故
1.3信号模拟算法
X射线脉冲星信号的数值模拟算法可分为两
种,一种基于光子数分布率,一种基于分布函数的
反函数。
1.3.1“基于光子数分布率的信号朱拟算法
在(t,s)内到达〖个光子的概率PiN:=矿可
由式(1)计算,将一个周期划分为N,个足够小的
区间,每个区间称为一个时间仓(bin),第;个时
间仓内的光子数记为N:,其分布率可记为
k o 1 >p
P{N,=k}“PoP…【-工九
当时间仓足够小时,每个时间仓中的光子数
目取值基本为0或1。对于某一特定长度的时间
仓,大于p个光子数的事件为小概率事件,可以将
其光子数近似为p。
根据分布律可以利用随机数生成每个时间仓
内的光子数目,以时间仓的中点作为该时间仓内
光子的到达时刻。
1.3.2“基于反函数的信号模拟算法
要生成分布函数为F(x)的特定分布,可采
FIT HE:4A G=F (y),y 是 (0,1) 区 间 上 的
随机变量,其中F(y)是F(x)的反函数,由
PiCG<xi =P{F, (y) sx
=PlysF(x)} =F(x) (10)
可知C=Fxr“(y)服从分布函数为F(x)的
分布。
X射线脉冲星信号用光子到达时间表示,因
此,其模拟算法可按如下方法导出。
设X射线脉冲星光子的到达时间间隔为x,
则x的分布函数与具体的时刻!有关,可用条件
分布函数表示为
F(x1 = 1 - PIN: = 01
=1-exp[A(t) - A(t + a) ]
, (11)
其反函数为
RT1(yI0) = ―t +A [A(2) -In(1 -7) ]
其中,ye(0,1),4“为4(5)的反函数,从而
由于R是(0,1)区间上的随机变量,故(1-口)
也是(0,1)区间上的随机变量,式(12)可简化为
又G为光子到达时间差,t为当前时刻光子
的到达时间,故下一个光子的到达时间为
t'=t+G=A""[A(t) -InR] (14)
脉冲轮廓A(4)的表达式一般并不规则,故
使用解析方法不易求出AGMA,BFR
数的信号模拟算法之间的区别就在于如何处理
A(口和古。
1)针对这一问题文献[16]采用了近似模型,
当光子到达时刻间隔很小,即6t一0时,
但是当脉冲星光子流量较小时,并不满足8
一0的条件,不能采用上式进行信号模拟。
2)本文采用分段线性函数拟合脉冲轮廖函
数A(d)。脉冲标准轮廓也是通过历元折叠构
建,因此由离散点表示。当利用指数函数或高斯
函数等拟合时““““,虽然可以得到平滑的轮廓曲
线,但相应的求轮廓函数积分及积分函数的反函
数时十分困难。
信号模拟主要是为了分析相位估计算法,轮
廖形状会影响相位估计的精度,因此必须针对不
同的脉冲星采用其标准脉冲轮廊。但是轮廓是否
光滑并不影响结果。因此采用分段线性函数拟合
脉冲轮廓是可行的,而且A(4)分段可积,4(1)的
反函数也易求。
设历元折叠的时间仓数目为X,则标准脉冲
轮廓的离散点数目为M+1,为了保证离散点可以
表 示 整个周期的轮廓,使第一个点的相位为0,最
后一个点的相位为1。第;个离散点表示为
(河,(永),指旷中第一项为相位,第二项
为光子流量。线性函数拟合的脉冲轮廉可表示为
A D 司 ( 园 ] - (6-551)
》t(…二_ZI芗玉)(16)
其二【暮二】，茎-'畜景琴`(翼)<<,i=1,2,-MM+1,H1
是1024个离散点绘制的crab脉冲星(PSRB0531
+21)的标准脉冲轮廓。
由于式(16)是线性的,所以4(t)易求,而
A(口是关于相位“的二次函数,故ATGEN
求解二次方程得到,为了简化计算,还可以通过内
插值得到近似解。值得一提的是,这里的近似解
是利用精确模型确定光子到达时刻范围后取近似
值,基本不会影响后续信号的模拟,而式(15)则
是对模型取近似,然后用近似的模型生成光子到
达时刻,该时刻可能偏离精确模型计算值较远,从
而影响后续信号的生成。
数拟合的标准脉冲轮廊的信号模拟算法,采用X
拟合优度检验法验证生成的信号是否服从泊松分
布。以某一时间段内的X射线光子数a=10,1,2
cag)性=1,2,3...作为样本,记样本中等于a的
个数为n:并设a共有5个不同的取值,由式(18)
|可求得a=ai=i-1的概率p;,样本总数为n=
>nm,则皮尔逊x统计量为
对给定的显著性水平a,检验规则为:
| Bx =x a (k= DERMAL ZI]
从。下面将用两种方法对模拟算法进行检验,第一
种为整段统计,即直接统计整个观测时段的光子数
目;第二种是分段统计,将N个周期的光子折叠到
一个周期,再将一个周期均分为若干段,在每一段
上统计光子数目。取A,=1Sph/s,Ay=5ph/s。脉
冲周期7=0.04s,显著性水平aBLO.05。
2.2“整段统计
生成25个周期,即1s的观测数据,即;=0,
s=1。然后统计ls内观测到的光子数目。皮尔
逊X统计量的计算为:
可得
c)1,则“=50,;的最大值为30,记
nRso为大于光子数,大于等于49的样本数。
根据式(17)即可计算出X“.。
由信号模拟算法生成5000个样本数据,m;的
分布如图2所示,由图可见,在光子数集中在期望
值附近,而大于或小于期望达到某一值后,样本数
量变为0。将i代人式(17)求得X“=242638,又
早 -a(49) =66.338 6 故 灰 <xi_.(49) , 说 明 在 一 整
段时间内产生的光子到达时刻服从泊松分布。
生成250个周期,即10s的观测数据,然后进
行历元折叠后,将一个周期均分为8个部分,对每
部分的光子数进行“拟合优度检验,皮尔逊X
统计量计算方法与2.1节相同。各段的光子个数
期望E(W)值计算如表1所示。考虑到p:过小
表 1 分段统计各段的参数及计算结果
Tab. 1 Parameters and results of each section
for the section-divided method
注 : = 坤 s ( - 1)
可能会导致极大的计算误差,因此将p,<10的
光子数目按区间统计,a的取值集合为([0,au],
ao,“..,Qi-l,[axs,ooc]),实验数据及结果如表1所
示。由表中数据可知每一段的统计量X“均小于
Xoos(k=1),说明在每一段上产生的光子数目也
服从泊松分布。
2.4借号模拟算法比较
前面介绍了两种信号模拟算法,并提出了一
种基于分段线性函数拟合脉冲轮廓函数的模拟算
法,将基于光子数分布率的信号模拟算法记为方
法一,将采用式(15)由反函数推导的信号模拟算
法记为方法二,基于分段线性函数拟合脉冲轮廖
函数的模拟算法也利用反函数导出,与方法二的
区别在于计算过程不采用近似,将其记为方法三。
下面分别比较三种算法生成的光子数期望和由模
拟信号构建的观测脉冲轮廓。
2.5光子数目比较
根据X射线脉冲星的光子流量分布规律,取
三组不同的A,和A,
1)A, =15ph/s, A, =5ph/s
2)A, =150ph/s, A, =50ph/s
3)A, =1500ph/s, A, =500ph/s
1000s的光子到达时刻通过历元折叠后得到的累
积脉冲轮廓,可发现当时间越长时,脉冲轮廓越接
近标准脉冲轮廓函数。进一步证明了方法三可以
重构的脉冲星信号。
3“结论
本文提出一种基于精确光子流量函数的纯数
值重构X射线脉冲星信号的模拟算法,该算法依
表 2 光子数目比较
Tab.2 Comparison of photon counts
组理论值“方法一“方法二“方法三
1 2000 2000.7 968.8870 2001.4
2 2 x10* 19 970 11 669 19 981
3 2 x 105 199910 189730 200 000
观测时间取100s,统计1000次实验的光子
数均值,结果如表2所示,由表可见方法二的光
子数目与理论值相差较大,特别是当光子流量
较小时尤为明显,而方法一和方法三则趋近于
理论值。
2.6“观测脉冲轮廓比较
由于当光子流量较小时,方法二不能有效
模拟脉冲信号。故取A,=15300ph/s,A,=
500ph/s,观测时间取100s,历元折叠时间仓取
128,构建观测脉冲轮廓。进行1000次实验,统
计观测脉冲轮廓每个离散点取值的均方差,并
与理论值比较,结果如图3所示。方法二模拟
的脉冲信号其轮廓误差最大,其次为方法一,而
本文提出的方法三误差趋近于理论值,说明该
方法可以重构标准脉冲轮廓。
分布性质,用概率论的相关方法模拟光子到达的
随机事件,并采用分段线性函数拟合脉冲轮廓解
决了轮廓函数积分及其反函数不易求得的问题。
该方法不需要借助其他硬件设备即可生成模拟的
X射线脉祈星信号,成本低、灵活性高,可以作为
X射线脉冲星导航实验的信号源。通过拟合优度
检验验证,本算法重构的脉冲星信号服从泊松分
布,符合脉冲星信号特征。
