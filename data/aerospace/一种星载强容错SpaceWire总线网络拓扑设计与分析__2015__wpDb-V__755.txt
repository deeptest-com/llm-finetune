一种星载强容错SpaceWire总线网络拓扑设计与分析
目前SpaceWire总线应用主要基于单个路由器上连接数个节点设备,构成小型星状网络结构,而对复杂航天器多节点情况下的SpaceWire网络系统应用研究较少。针对航天器高可靠要求,提出一种总线型网络拓扑容错设计方案,对网络工作方式、多层次冗余容错机制、系统可靠度和网络传输性能进行了分析推导,结果表明提出的网络拓扑满足星载应用要求。最后根据分析结果提出了SpaceWire网络系统中数据包长、链路速率和节点布局的设计指导原则。

航天器 路由 容错 SPACEWIRE 网络拓扑  

0引言
SpaceWire 总 线 是 由 欧 洲 空 间 局 (Eurmpean Space Agency,
ESA}. 2 国 宇 航 局 《 National Aeranautitcs and Space
Administration,NASA}等多个宇航机构以及学术组织共同制
定,畔名航天器应用的新型高速串行总线标准,采用了虫孔路
由躁机制来灵活构建网络,实现星载设备和分系统之间的互
联通信,相比其他高速总线标准具有运行管理简单可挂的优
点,目前已在ESANASA等国际宇航机构的火星快车、韦伯
望远镜等多个航天任务中得到应用和推广,并成为空间高速
总线领域的研究热点。文献[!-3-分别介绍了SpaceWine在
系统级、设备级和芯片绶的典型应用:近年SpaceWire研究组
连绫通过国际大会发布最新研究进展“*““。国内中国科学院
安间中心最早进行了SpaceWire总线跟踪研究““,目前我国
航天器在SpaceWire总线应用上处于跟踪研究和初步应用阶
殷,主要借鉴NASA和ESA的经验“。
SpaceWire总线目前应用的主要方式是点对点连接或采
用单级路由器的小型星状网络““““,而对于节点较多的度
用,则需要椿用宏级路由来扩展网络结构。由于航天器的不
可维惨特性,要求星载SpaceWire网络系统具有强容错能
力“。本文提出一种总线型延伸的SpaceWire网络容错拓
扑,从传输方式、分层协议和硬件可靠度方面对网络的容锦性
re; network topology
能进行了定性和定埕分析,同时给出丁容错型拓扑下
SpaceWire网络传输性能的分析结果.
1SpaceWire网络容错拓扑设计
SpaceWire总线网络由链路、节点别路由咤组成,网络中
的信恳流以离散数据包的形式在节点设备(或路由器)之间
伯递,传输路往根据包央中的地址信息确定。SpaceWire路由
器支持目动组适应功能,即两个路由器之间的多个链路可构
成组适应链路,同一组内的所有链路在功能上完全对等,可相
互替代或者同时传输不同的数据包.。
SpaceWire标准没有明确网络拓扑的形式,需要根据工程
应用的需求灵活设计,在进行网络扩展时须采用多级路由器
级联,路由瞿沿同一方合级联形成的网络拓扑具有一般代表
性,这种网络拓扑与目前航天器上应用较多的1553B\控制嗣
局域网络(CootrollerAreaNetwork,CAN)等总线型网络相似
基于以上分析些考虑星载网络元余容错的要求,提出总线型
SpaceWire网络拓扑结构如图1所示。SpaceWire网络中木用
的两类基本功能模块包指路由器和节点接口模块。典型的路
82ihESA支持设计的8端口SpW40X“,节点设备端的
SpaceWire接口提供设备内部主控模块对SpaceWire网络的
访问;ES&A设计的典型节点揣口芯片SMCS332SpWW提供三个
SpaceWire通道,同时支持三个链路接口间_兰_>，量{罡甚`由二_勇[二{i_辜…`_，′[_…:]_〔1鄙[],
图 1 的网络设计以上述两种功能模块为物理原型,其中
Router为路由命,其余为节点设备,SMU代表卫星算理单元,
Memory/Formater心表数据安傅与格式仅设&,Scientific
Instrument代表载荷设备,_N代袍主份,_R代表备份。
注:数宇表示SpaceWire谚口号==表示SpaceWire锋路
图 1 SpaceWire总线型网络拓扑结构
图 1 网络抓扑中,由一组主份路由器和双元余的
SpaceWire链路构或了主总线,另一组备价路由器和双元余的
SpaceWire链路构成了备总线,同时主、备总线之间通过交叉
连接消除了路由跋的单点失效模式,整个网络形成丁完全对
称的分绵结构,便于扩展。图中4台接入网络的节点设备用
于进行辅助说明.
SpaceWire网络数据链路层传输的数据包格式如图2所
示,数据包头的目标地址用于确定数据包通过每级路由器时
的输出端口号,数据包尾的结束标识为流控制特征字符,表征
数据包的结束。在数据包的装载数据区可以装入各种网络传
输层协议定义的复杂数据结构,如远程存惠访问华说t4Remote
MemoryAccessProtocol,RMAP)和国际空间数据系统咨评委
员 会 tConsultative Committee for Space Data Systems,CCSDS 包
传输协议等“,也可以是用户自定义的状态\指令等数据块,
这样实现了对SpaceWire网络数据传输协议的扩展,从而支
持多种航天助数据应用业务在同一网络上的绪合处理。不同
传输协议由数据包内部的协议标识号进行区别,对数据包的
解析处理依据协议标识号完成。
2.1“件输方式容错
每个SpaceWire路由嚣包含8个物理端口,端口地址取
值范围1~8,此地址用于数据包的路径寻址;同时每个逊入
网络的节点设备的每个接口都会分配一个逻辑地址,取值范
围32~255,用于进行逻辑寻址和判断接收数据包的正确性。
两种寻址方式在网络中结合使用,数据包的传输方式设计有
如下三种,在实际应用中由网络管理设备负责设定当前传输
方步。
传输方式1“此方式为总线网络的优先和主要传输方
式,所有节床设备和路由命的主份(或备份)工作,每两个路
由器之间的组适度链路由两条独立链路共同构成,所有数据
包传输林用逻辑寻址,由路由器根据路由表目动确定传输路
往。从卫星管理单元主(SMU_N)问存储复接单元主tMemaryy
FormaterN)发送数据包格式为:<86><敷据内容>
<EOP>,相应返回数据包格式为:<509><数据内容>
<EOP>.各主份路由躁中酒置了与逞辑寻址相关的路由地址
途,格式与传输方式1中相同,各备份路由器中要配
置与逻辑寻址相关的路由地址表.。
表 1 主传路由器路由地址表
Routerl N Router? N Routerd N Routerd N
逻辑MEEE路往“逻辑路径“遇辑BE
地址“地址“地址“地址“地址地址“地址“地址
86 1 86 1 86 1 86 1
86 2 86 2 86 2
86 3 86 3
30 4 50 4 50 4 50 id
30 5 50 3 50 3
伯输方式3当网络中栋路申器的路由配置表发生错误
时,网络札用路径寻址方式传输数据包,由于网络中链路级实
现了多重冗余,因此两个节点设备间具有多个路彼可选,通过
静态分配的方式,可以有敷避免路径上发生堵塔。如从图1
中卫星曾理单元主传{SMU_N)向存储复接单元主份
(Memory/Formater_N)发送数据包的路径寻址格式可设定为:
<I> <3><3><1> <FENE> 一 卫 口 卫 乙 。
2.2“协议容错机制
SpaceWire总线网络设计通过札取多层欣的容错措施保
证门络通信服务质量,如图3所示,协议容错机制包括:丨链
路兀余:SpaceWire总线网络的所有主t备)路由命之间采用
双链路构成组适应链路,组适应链路与1553B总线的双冗余
工作机制相同,为完全的热备份模式。通过预先配置路由嗣
的路由地址表.当一条链路失效时,另一链路将目动替代。
仁路由元余:网络中的路由嚣分为主\备两组,按热元余方式
工作。8节床冗余:SpaceWire节点设备按照主备机元余方式
设计,分别通过主份和备份路由器接入网络。当发生链路或
者单机失效时,可由备传通道或者备机替代工作。伟协议容
错:SpaeeWire网络协说分为多个层次,每层设有容错措施,物
理层和信号层梁用屏葛的低电压差分借号(Low-Voltage
Differential Signaling, LVDS) 传 输 、 DS ( Data-Strobe) 编 码 等 措
施,保证信号具有很强的抗干拥性能;在数据字符层设置奇倡
校验位检错;数据流的传输设置4个控制宇实时反馈数据包
传输状态,在链路出错后可目动初始化恢复;网络层路由器具
有仲裁、看门狗等功能;传输层数据包内容札用循环元余校验
(Cyclic Redundancy Check, CRC) + RS ( Reed-Soloman) 纠 错 码
保护:应用层采取锦误检测处理,应答,重试等手段保证通信
的可靠性。@网络管理:在网络系统中设置网络管理设备负
责网络的健康状态维护。网络管理层采用路往寻址的方法周
期性对网络中的所有链路和路由器进行扫描*对于发现的故
障进行馆复、隔离,或对网络结构重新配置,从而保证系统连
续安全可靠运行。
2.3 WEE
可靠度代表总线网络能够成功进行数据包传输的概率。为
悌于建立可絮性模型,图!的SpareWire总线网络简化为图3形
式,路由嘴标记为4,路由嗣之间的组适应链路标记为B,克叉
链路标记为C.,所有同类埚的模块具有相同的可靠度,每一级路
由帝和其右侧的链路共同构成网络的1级。根据图4建立整个
总线网络的可靠性框图如图5所示,所有SpaceWire逊接的失效
率可认为相同; 可以看作两条C,并联,电子部件可靠度服伊
指数模型=o(为失效率,f为时间),所以有Rs=2R,-
R=,则其中1级网络的可靠度如下:
整个n约总线网络的可靠度为.:
注必两条链路构戒织造必链路,日动元仁和分担念输任务。
必每弯跷甾咤形成主备热冗俊,可实时晃代,
恩支持节点以双机识备或热备的模式接入网络。
出数据链路七传输协设分尼宏锡:
*物理层和信号层采用屏蔽出LwDS传输DSHTREK;
*急个传输孙符设置1比特奇偶校验位;
s枣用ESC、FCT、EOP等控制孕符实旭怀按数搬流传输状态;
*陶山嘴仲烨与眉门狗超旷监督;
*装载数据采用CRC校验、RS刹锦码保扩1
*节点检查接口状忘、包顺序等。
心市高史靠的春务计算机周期性对门络各设备健康状态检查,
叙旷恢复段重斧配置。
图 3 SpaceWire网络协议分昊宰锦机制
根据美国国家军用标准MIL-HDBK217F手册提供的失效
率模型:采用应力分析法得到路由嚣(4)和SpaceWire链路
(C)的失效率分别为0.231(失效数/119h)和0.001092(失效
数7110“b),从而计算出规模为r=4,6,11的网络系统可弯度
曲线如图6所示。可见通过元余设计,多重路由的总线埃
SpaceWire网络在较大规模(n=11)和长寿命(15a)条件下
能够达到0.99以上,达到大部分航天器设计要求。
SpaeeWire网绘的主要目标是实现高速数据传输「目前
SpaceWire荆片可述到的典型速率为2909Mb/ys,容错型网络拓
扑可以实现更高的网络启吐。图1的总线型网络拓扑采用主
份(或备份}路由善间的组适应链路以及主备路由命间的英
叉链路实现链路级三元余,因此总线带宽最高可以达到
600Mbys,但考虑到数据包在传输过程中需要增加包装信息,
有效速率会有所降低。相跆n级路由命的两个节点间传递数
据包最多需要增加nB的地址信息和0.5B的包明俏恺:以
RMAP数捕包头最长20B计算,许在总线上传输的整个数据
包长为B,总线速率按煦200Mb/s计算,则有敬传输带宜可
表 示 为:
根据式(3)得到节点距离n=5,10,20的情况下包长和
有效带密的关系曲线如图7所示。可以看到在包长较短时即
使总线传输速率很商,但实际利用的有敌惟宽却较低,当包长
达到209B以上时,有敬带宽可以迅速提高到接近总线传输
速率,使总线网络口速率的优势得以发挥,因此在SpaceWire
总线的应用中应避免传输大量的短数据包.。
率节点接入同一网络运行,速度过低的节炉在网络中传输数
据包时会较长时间占用链路,有可能导致堵塞使得其他节点
发送的数据包不能及时通过而产生延时。以下分析典型情
况,设定:数据包长“,(单位为B),链路途率F(单位义
Mb/s),路由器延时D..(单位为ps),在无阻塞情况下,相跑
n纪的两个节点间传递数据包耗时为:
若数据包传输过程中在每一绶路由咤都遇到堵塞情况,
需要等待前一数据包传输完成后才能继续,则得到整个数据
包最坏情况下传输耗时为.:
D, = (n+ )T,/V + nD, (5)
路由器延时D.,为固定值;约0.5ps.图8为不同包长情
况下相证n=5.10.20的两个节点间的网络传输耗时计算结
果,D为无阻塞情况,D,为阻塞情况,链路速率=
200Mb/s.可以看出网络无阻塞情况数据包长对传输延时影
啄桃小,而发生阻塞时长数据包造成的传输延时随网络级数
增加返速增长。图9给出不同链路速并情况下,包长2分别
取50和1024B时的网络传输耗时结果,可以看出在速率低
于50Mb/s时,无阻塞情况下数据包传输延时受包长影响仁
较小;而阻塞情况下的延时随包长增加星现指数增长,会对实
际应用造成严重影响;而当速率在100Mb/s以上时,网络延
时基本可稳定在较小的茎围内。
数据包种类,尽量李用长包传输以提高网络带宽利用率,同时
兼顾路由器堵塔带来的延时,需根据系统允许的廷时确定包
长范围;为提高网络的整体效率所有链路接口可设置较高的
发送速睿。根据分析结果较优的参数为数据包长取209B以
上,链路接口速定取100Mb/s以上。
本文提出的容错型网络中通过冗余链路降低了路由器堡
塔的概率,可以更好地控制网络延时。同时通过设置数据包
优先级,配置路由器按优先级进行仲裁,可保证具有实时性要
求的数据包忧先传输。另外对于相互之间有太块数据传输的
节点布置在网络中的相近位置,可以谴免发生鞍长路往的堂
塞,降低廷时,如图1网络中的载荷仪躁tInstmument)和存慑
5%5JC(Memory/Formater)连接在网络同一级上,载荷仪嘴
产生的大量业务数据可直接快速进入存储器。
4“结许
本文针对SpaceWire总线网络在复杂卫星多节点度用环
境下的扩展问题,提出单向延伴总线型网络拓扑,可将航天器
上大量计算机设备和子系统纳入统一高速网络,实现并发涓
息传输和信息实时交互。通过网络结构的对称元余设计提高
了网络工作方式的灵活性和系统长期可靠度.在网络系统各
层协说梁取的容锦处理机制保证了传输服务质量,滢足星载
应用要求。对网络特性分析结果表明,根据数据业务特点对
网络数据包长度、链路接口速牵和节点设备在网络中的位置
布局进行优化设计,才能较好地发挥网络性能。后缉可进一
步完成网络仿真和验证工作。
