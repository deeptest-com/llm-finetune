NUMERICAL  SIMULATION  OF  A  HIGH-SPEED  PROPELLER  FLOWFIELD  BASED  ON  EULER  EQUATIONS
Ｔｈｅｐｒｅｄｉｃｔｉｏｎｏｆｆｌｏｗｆｅａｔｕｒｅｓｏｖｅｒｈｉｇｈ－ｓｐｅｅｄｐｒｏｐｅｌｅｒｉｓａｖｅｒｙｉｎｔｅｒｅｓｔｉｎｇａｎｄｉｍｐｏｒ－ｔａｎｔｐｒｏｂｌｅｍ，ｗｈｉｃｈｈａｓｃｏｎｓｔａｎｔｌｙｃｈａｌｅｎｇｅｄｍａｎｙａｅｒｏｄｙ...

TRANSONIC PROPELLER finite volume method EULER EQUATIONS MULTIGRID technique  

扩展卡尔曼滤波(extendedKalmanfilter)技
术“常被用于航天器实时姿态确定,根据姿态
参数的选取不同和观测量的不同形式,常见的实
现方式有乘性扩展卡尔曼滤波“(Multiplicative
Extended Kalman Filter, MEKF) 和 加 性 扩 展 卡 尔
曼 滤 波 ““““】 ( Additive Extended Kalman Filter,
AEKF)两种方式。AEKF和MEKF的本质区别在
于四元数误差修正过程中是否遵循了单位范数约
束条件,而不在于修正形式是加法还是四元数乘
法,Shuster指出,如果对AEKF加以适当的约束,
那么它可等价于MEKF,但是计算量大“1。因
此,MEKF被广泛应用于各种航天器姿态确定任
务并且发展最为成熟。
MEKF的基本思想是估计无约束的三分量姿
态误差参数并利用四元数乘法为航天器提供全局
非奇异姿态描述。目前,针对不同的任务背景和
姿态敏感器配置方案,众多学者推导了大量基于
MEKF的姿态确定算法。从任务背景来看,既有
惯性定姿““,也有轨道定姿“““;从姿态角速度
的传播形式上看,既有有陀螺姿态确定系
统““-“1,也有无陀螺姿态确定系统““1;从姣态
敏感器配置来看,既有基于单一敏感器,如磁强
计“,也有基于组合敏感器,如陀螺+星敏感
器“,陀螺+太阳敏感器+磁强计“,磁强计
+红外地平仪““,多敏感器信息融合““““等不
同组合形式。综上所述,其姿态确定算法并不具
有一般形式,往往需要随研究背景的改变而对系
统进行重新建模。
1姿态描述与运动学方程
目前,最常用的姿态参数是姿态四元数[,
其优点主要在于用其表示的姿态运动学方程为线
性形式,计算量小,旦不存在奇异性。四元数是一
个四维矢量,定义为g=[8“1",其中8=
[91 b: gs] =esin(d/2) ,q, =cos(d/2) , 这 里 ,e 为
单位欧拉旋转轴,4为旋转角,日四元数满足正交
性约束条件lg|=1。姿态矩阵可用四元数探
述为“
| =(q; - QI") L,,; +2 887 -2￠,[ 8 x]
Hp1,23x3的单位阵,日有
四元数的另外一个优点就是连续的姿态旋转
可用四元数乘法进行描述,即4(9“)4(4)=A(4「
?q).其中,符号“@“表示四元数乘法,具有双线
性特性,满足
￠'?q=[￥(q) q'l￠=15(q) 419「(4)
不失一般性,本文选取的参考坐标系相对于
地心惯性系的旋转角速度为w,,该坐标系既可以
是地心惯性系,也可以是轼道坐标系或者是其它
已知参考坐标系,则对应的航天器姿态分别为惯
性姿态和对地姿态。定义从参考坐标系到体系的
四元数为g,。,则四元数运动学方程为
其中,my,为航天器体系相对于参考坐标系的角
速度在航天器体系中的分量,若无特别说明,本文
涉及的航天器的角速度均是在体系中定义的。因
此,wy:可进一步表示成
式中,为航天器的惯性姿态角速度,可由陀螺
测量或姿态动力学方程传播得到。将式(1)和式
(6)代人式(5),可得
式中,对于三分量的角速度矢量w,有
可以看出,由四元数构成的姿态运动学方程
为线性方程,且方程(7)适用于航天器相对于任
意参考坐标系的姿态传播。对于特殊情况,当地
心惯性系选为参考坐标系时,此时有,=0,,,.
2MEKF滤波器设计
2.1“状态和方差传播
2.1.1“姿态误差矢量的动力学模型
MEKF通常以四元数乘积形式对真实姜态进
行描述000,即}
其中,4为估计四元数,54(Ab)为真实四元数4
与估计四元数4之间的误差四元数,可用三分量
KEAp描述。事实上,Ab为航天器体坐标系下
定义的姿态误差矢量,它可用多种参数进行描述,
如无穷小旋转矢量“““,两倍的四元数矢部“1,两
倍的罗德里格(Rodrigues)参数或吉布斯(Gibbs)
向量““,四倍的修正罗德里格参数“等。根据小
角近似条件可以得到|
以及姿态误差矩阵|
4(58) 一 s - [Ad x ] (11)
线性化Bortz方程可得到威态误差矢量的动
力学模型0'
将式(6)代人式(12)可得
Ap = (a, - 口 ) ~ (A(0)5(d, 0),
-4h(@_s)@) - [(@ -A(q_s)@,) x ]Aq
(13)
代人式(13),苜利用反对称阵的线性齐次性整理
可得
这里,假设参考坐标系的角速度已知,则有Aw,=
0,,u,则可得到姿态误差矢量的线性化动力学模
型为
仔细观察方程(15)可以发现,虽然这里Ad
定义的是相对于6的姿态误差矢量,但由方程
可看出A也可看成是相对于4而定义的
姿态误差矢量,这主要是因为假设了已知准确的
@@,,从而可以根据姿态传播得到准确的四元数
qr.,其中,为从惯性系到体系的四元数,L_,
为惯性系到参考坐标系的四元数。这也就解释了
为什么方程(15)的形式与在惯性系下解算姿态
的姿态误差矢量的动力学模型一致。
2.1.2“系统状态方程及其线性化
航天器的姿态角速度可以通过速率积分陀螺
测量得到,也可以利用姿态动力学传播得到。因
此,下面就这两种情况分别建立系统状态方程,对
,应为有陀螺姿态确定系统和无陀螺姿态确定
系统。
(1)有陀螺姿态确定系统
一般来说,陀螺测量的是航天器的惯性姿态
角速度在体系中的分量,通常采用如下模型
其中,是陀螺的测量输出,8是漂移量,9“,和
7,是独立的零均值高斯白噬声过程,满足
其中,6(t―7)为Dirac8函数,更为一般地考虑了
刻度因子和失准角误差的陀螺模型可参见文献
[23] 。
根据方程(17)可得角速度的估计模型为
结合式(17)和式(19)可得Aw,=-(AB+
n,),其中AB=<B-。于是方程(15)可写成
得有陀螺姿态确定系统的误差状态方程
其中
过程噪声wou的谱密度矩阵为
(2)无陀螺姿态确定系统
在没有陀螺提供角速度信息的情况下,根据
航天器的姿态动力学方程可得
w, =f(w,) =J [ +Ts +w,
式中,J为航天器的惯量张量矩阵,4为动量轮的
角动量,7.为推力器提供的控制力矩,7s为重力
梯度力矩,ws。为其它环境干扰力矩,如气动力矩、
太阳辐射力矩、地磁干扰力矩等。一般来说,环境
千扰力矩与控制力矩相比很小,可近似作为模型
噪声处理。当没有控制力矩作用时,此时航天命
所受的合外力矩主要考虑重力梯度力矩TTR
(26)中的重力梯度力矩可描述成“|
7, =H AG )r xd (Algn] (27)
其中,为引力常数,r为航天器在惯性系中的位
置矢量,由航天器的轨道运动学提供。
Bik, hrf (16) (27) AFH f(w,) 与 姿
态误差矢量Ad有关,则方程(26)可进一步改
HH
wy =f(w,, Ap) =J '[T,+T,- h
- x (Joo, +R) ] +T7'w, (28)
取方程(28)的全微分可得线性化方程|
式中|
- [J4(GLa)7x ]1[4(GLu)F x ] (30)
=I" {[ (Ja, +h) x ] - [@s x 1J} (31)
于是,选取误差状态变量Aru-n=[A
Aw,]「,利用式(15)和式(29)可得无陀螺姿态
确定系统的误差状态方程
Ax, = gyro = F.. - g}′l'()〈'溅】10!l - gyro + G,,. - gyro W non - gyro
式中
l攫′【I(】【I一g}′】`丨)=}t′'i(35)
过程噪声w-em的谱密度矩阵为Q=xa。
至此,分别推导了有陀螺姿态确定系统和无
陀螺姿态确定系统的误差状态方程,鉴于形式的
相似性,可统一描述成如下形式
Ax =FAx + GW (36)
2.1.3“状态和方差传播
状态参数6一可通过式(7)积分得到,对于
有陀螺姿态确定系统,心由式(19)得到,而对于
无陀螺姿态确定系统,@,由式(26)的积分畸到。
方差传播的离散形式可以表示成
“又,=(p′c′:'′重_J′l(p霆`_+'(2′′(37)-
式中,@为状态转移阵,为过程噪声方差阵。
Loan给出了这些矩阵的数值解“,首先取时间
间隔At,构造矩阵
式(38)中的矩阵F,G,Q@均已定义,然后,计算方
程(38)的矩阵指数
于是可得
&=B; (40)
0 =@B, (41)
不过,上述方法需要计算矩阵指数,在Matlab
环境下较容易实现,但在C语言环境中仍需要编
写矩阵指数函数。文献[25]中运用矩阵论中二
次型原理推导了连续系统离散化的一般公式,指
出离散过程噪声协方差阵具有形式
FN (5) G(1,)Q, (5) G (8) (F'(1,)) 7 A
(42)
可根据精度要求选取适当的N,一般选取N
=3 ~4.
2.2观测方程及其线性化
目前,工程上应用的姿态敏感器种类很多,如
三轴磁强计、太阳敏感器、地平仪以及星敏感器
等,常用的观测模型则包括矢量观测模型,四元数
观测模型和欧拉角观测模型。
2.2.1“矢量观测模型
BE, ETRE A LEE HUSS 0 21H
h(os)是关于体系中观测矢量,的m分量函数,
因此测量方程可写成
2 = 见 (yp)+E (43)
测量灵敏度矩阵为
式中,?,为参考坐标系中估计的观测矢量,事实
上,很多观测矢量都是基于惯性系中定义的,如星
敏感器,太阳敏感器等,此时方程(45)在实际运
用当中可以展开为
v, =A(q.,(-))v, (46)
由此可以看出,只要知道准确的坐标旋转矩
阵,观测矢量可基于任意坐标系中定义。因此,为
了不失一般性,将Vs统一写成方程(45)的形式,
观测量的预估值可写成z=h(75).
注 意 到 4(58) =1,,; - [A9 x ] , 则 方 程 (44 )
可改写为
写成
其中,w=4,_uys=u,u,“山]为敏感器坐标
系中描述的观测矢量,4,表示从航天器体系到
敏感器坐标系的姿态旋转矩阵。根据式(47)
可得
式(49)的计算中利用了正常正交矩阵的正交变
换性质公式[Cux]=C[xx]C7。
对于三轴磁强计而言,其敏感的是磁场矢量
在磁强计中的分量,观测量是矢量本身,满足
h(v,) =u (50)
测量灵敏度矩阵为
事实上,许多祈线敏感器测量值都可以被重
构为单位矢量形式,但要注意重构后观测噪声方
差阵的传播。通常,对于小视场敏感器,采用
QUEST观测模型,其优势在于观测方差阵在EKF
公式可以等效地用非奇异阵0°,RE,i
针对大视场数感器情形,Cheng利用一阶泰勒展
开近似扩展了QUEST测量模型““。
因为观测量不显示依赖于陀螺漂移和航天器
姿态角速度,因此,不论对于有陀螺姿态确定系统
还是无陀螺姿态确定系统,总测量灵敏度矩阵可
写成|
2.2.2“四元数观测模型
目前,不少现代姿态敏感器能够根据观测矢
量直接给出四元数观测值,四元数输出模型为
式中,e:_,表示从体系到敏感器坐标系的姿态四
元数,g,:由星数感器的测量噪声引起,定义为
8q(w,)o。同样,这里假设观测到的四元数为从参
考坐标系到敏感器体系,若观测到的四元数是从
惯性系到敏感器体系,只需要利用4进行四元
数转换即可得到,并不影响本文的结论。
当处理敏感器输出四元数观测值时,一般进
行预处理构造新的观测量
经过推导可得新构造的观测量与姿态误差矢
量的关系式为
i=A, Ad +D, (55)
由式(55)可得测量灵敏矩阵为
由于每次滤波更新后,滤波器重置,则有
Ad(-)=0,所以观测量预估值为z=0,,,.同样,
不论对于有陀螺姿态确定系统还是无陀螺姿态确
定系统,总测量灵敏度矩阵可写成
2.2.3“欧拉角观测模型
当定义了欧拉角转序后,桅些姿态敏感器可
输出欧拉角观测值,观测模型可描述成
类似地,这里假设给出的欧拉角为航天器相对于
参考坐标系的姿态角,若不是,可进行坐标转换得
到。因此,欧拉角的预估值可由当前所估计的姿
态四元数4转换得到。
下面重点介绍如何计算其关于威态误差矢量
的测量灵敏度矩阵,根据欧拉角运动学方程可得
HH,￠,3,0为依次旋转的欧拉角,M(d,4,y)是
KF&,3,9的函数矩阵,其形式由欧拉角转序决
定。从变化率的角度出发,根据方程(59)THE
态误差矢量与欧拉角误差的关系式
进一步可得
式中,欧拉角误差测量值(即欧拉角测量残差)可
由欧拉角的观测值减去欧拉角的预估值得到,即
值得注意的是,文献[11-12]认为方程(62)
中构造的欧拉角测量残差与乘性误差四元数矢部
的关系是一个两倍关系,即将欧拉角误差等同于
姿态误差矢量。从方程(61)可以看出,这个观点
是不正确的,具体的证明详见文献[28]。
因此,根据方程(61)可得测量灵敏度矩阵为
Hy,=胆一(申,宁,办)(63)
其中,4,,%为欧拉角当前的估计值。
同样,不论对于有陀螺姿态确定系统还是无
陀螺姿态确定系统,总测量灵徽度矩阵均可写成
另外,若定义欧拉角列向量为9=[6w]“,
则根据式(61)可得欧拉角误差的方差阵为
分析可知,Pys是相对独立的,而Po大小则依
赖于函数矩阵M,因此非常大的PydfARE
怪误差很大,对于某些特定的欧拉角来说,阵
甚至可能是奇异的,此时Pv为无穷大,而姿态误
差有可能很小。因此,在观测模型的选取上,并不
提倡使用欧拉角观测模型,建议利用四元数和欧
拉角的转化关系将其转换为四元数观测模型。仅
能观测两个姿态角的观测模型均为上述观测模型
的特例。
2.3“源波更新
无论是对于有陀螺姿态确定系统还是无陀螺
姿态确定系统,观测模型不论是矢量观测模型,四
元数观测模型,还是欧拉角观测模型,均可直接给
出如下统一形式的滤波更新方程““
其中,四元数采用如下形式进行更新
对于有陀螺姿态确定系统,陀螺漂移更新方
程为
B( + ) =B( - ) + AB( + ) (70)
对于无陀螺姿态确定系统,姿态角速度更新
方程为
当滤波器采用误差状态量作为滤波变量时,
每次滤波更新后,滢波器都必须重置,即令A&(+)
=()6)(l'
3“方差转换
上述Kalman滤波得到的姿态方差阵是基于
姿态误差矢量Ad定义的,即
另一方面,根据对四元数运动学方程(5)积
分可得
利用等式A=268可得误差四元数方差阵
与其矢部方差阵的关系
欧拉角误差的方差阵与姿态方差阵的转换关
系见式(65),利用该式在进行滤波时可实时计算
欧拉角误差的3边界。
因此,可利用Kalman滤波中得到的姿态方差
阵P分别转化为四元数方差阵P,,欧拉角误差
方差阵P进行源波性能综合评估。
4“绪论
本文推导了具有一般形式的MEKF姿态确
定算法,适用于航天器相对于任意已知参考坐标
系的姿态求解,设计了有陀螺和无陀螺两种姻态
确定方案,并系统研究了姿态敏感器常用的矢量
观测模型,四元数观测模型以及欧拉角观测模型。
主要结论如下:
(1)航天器相对于任意参考坐标系定义的四
元数运动学方程为线性方程,可以统一描述成方
程(7)的形式,万该方程适用于交会对接和编队
飞行中航天器间的相对姿态确定。
(2)当已知准确的参考坐标系旋转角速度
时,姿态误差矢量的线性化动力学模型具有一舱
形式,均可等价于在惯性系下姿态误差矢量的动
力学模型。另外,可利用方程(14)进一步研究参
考坐标系角速度未知的姿态估计问题。
(3)指出了国内不少文献中的基于欧拉角观
测模型的测量灵敏度矩阵的求解是不合理的。
(4)虽然有陀螺和无陀螺姿态确定方案中选
取的误差状态变量不一致,但本文从形式上推导
得到了基于MEKF的姿态确定算法的一般性公
式。因此,基于本文的研究成果,可针对不同的任
务背景和姿态敏感器配置方案快速应用MEKF
姿态确定算法,如基于多敏感器的联邝源波器设
计,无陀螺姿态确定系统的轨道姿态一体化确
定等。
参 考 文 献 ( References)
[1] Farrell J L. Attitude determination by kalman filter [ J].
Automatic,1970,6(5 ) :419 ― 430.
[2] Murrell J] W. Precision attitude determination for multimission
spacecraft [ C ]//Proceedings of AIAA Guidance and Control
Conference, Palo Alto, CA, Aug. 1978, AIAA - 78 ~ 1248.
[3] Schmidt S F. Kalman filter: Its recognition and development
for aerospace 叩pHcad0n〔l〕 . Journal of Guidance, Control,
and Dynamics,1981,4(1) :4 -7.
[4] [Lefferts E J, Markley F L,Shuster M D. Kalman filtering for
spacecraft attitude estimation [ J]. Joumal of Guidance,
Control, and Dynamics, 1982,5(5) :417 - 429.
[5] Markley F L. Attitude error representations for kalman filtering
[J]. Journal of Guidance, Control, and Dynamics, 2003, 26
(2):311 -317.
(6] Bar-lizhack I Y,Oshman Y. Attitude determination from vector
observations: quaternion estimation[ J]. IEEE Transactions on
Aerospace and Electronic Systems, 1985 ,21(1) ;128 - 136.
[7] Bar-lizhack I Y, Deutschmann J, Markley F L. Quaternion
normalization in additive EKF for spacecraft attitude
