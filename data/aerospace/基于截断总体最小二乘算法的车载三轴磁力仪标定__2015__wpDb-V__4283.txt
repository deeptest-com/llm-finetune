基于截断总体最小二乘算法的车载三轴磁力仪标定
以陆用车载磁导航为应用背景,提出一种正则化三轴磁力仪标定算法.由于车辆的机动受到限制,用于标定三轴磁力仪的观测方程是严重病态的.传统的三轴磁力仪标定方法缺乏对病态问题的处理,难以获得准确的标定参数.文中采用截断总体最小二乘（TTLS）技术对病态的磁力仪标定问题进行求解.该方法能够有效地抑制观测方程两端的误差,并且适合处理强病态问题.通过车载实验对该方法的有效性进行研究,结果表明文中提出的方法能够有效地减缓磁力仪标定中的病态影响,获得更为稳定的数值解,补偿后的平均航向角估计精度为1.5°,满足车载磁导航的精度要求.

控制科学与技术 截断总体最小二乘 标定 车辆导航  

0“引肉
三轴磁力仪是一种低成本的导航定向传感
器“。它通常与其他传感器组合以获得捷联载体
的航向估计“““。以陆用车辆导航为例,捷联三轲
磁力仪通过测量地磁场矢量在体坐标系的投影,然
后借助其他姻态传感器如惯性测量单元(IMU)提供
的倾角信息将之转换到当地水平坐标系下,计算出
车体与磁北方向的夹角,最后利用当地磁偏角对其
进行修正以得到车辆与地理北的夹角,即航向角。
但是,磁力仪的输出经常受到干扰磁场的影响。这
些碟场会严重降低航向估计的精度。因此,在使用
磁力仪之前,需要对其进行标定。
目前,已经有许多方法相继被提出用于解决井
轻磁力仪的标定问题。文献[4-5]提出两步法并
给出了闭合解。该方法通过定义中间变量,将磁力
仪的非线性观测方程转换为线性方程形式AX=8,
其中系统矩阵4和数据矩阵?都由磁力仪测量数
据构成,而X是未知的中间变量。方程的解可以采
用标准的线性最小二乘方法进行估计。文献[3,
6-8]采用椭球拟合的思愚对磁力仪进行标定,其
算法核心是采用最小二乘或自适应最小二乘方法。
文献[9]针对磁力仪的观测方程等式两边同时含有
噪声的情况,提出了基于总体最小二乘(TLS)算法
的碟为仪标定方法。
注意到现有的磁力仪标定方法要求传感器能够
在不同方向上进行旋转以获得尽可能多的方向的测
量值。但是在车载磁导航应用中,车体受到路面的
约束而不能实现空间全方向的转动,与之固连的磁
力仪将难以获取全方向的磁场信息。因此,上述用
于标定磁力仪标定的线性观测方程将面临病态问
题。如果没有对应的方法对病态问题进行适当地处
理,那么传统的标定方法将产生不可靠的解,甚至无
解。为了获得鲁棒的解,通常需要引人正则化方法。
传统的正则化方法如Tikhonov正则化“假设线性
观测方程的右边部分受到噪声干扰,而左边部分则
是精确的。但是在磁力仪标定问题中,系统矩阵4
和数据矢量?都同时被测量噪声所干扰。因此,在
选择正则化方法时,选择一种能够同时处理等式两
边误差的方法更为合适。本文采用截断总体最小二
乘(TTLS)方法对车载磁力仪进行标定。TTLS方法
适合处理强病态情况下的线性最小二乘求解问
题“。车载磁导航实验结果表明,TTLS方法能够
昨 XX ] 任 [ 网 8& J X AE "TT BI 7 ses 1 RS ONT PA) HI
标定效果。
1“磁导航原理
车载磁导航系统主要由三轴磁力仪和IMU组
成。由于车体并不总是在水平面上行驶,使得磁力
仪很难保持水平状态,为此在解算航向角时需要进
行倾角补偿。倾角信息主要由IMU经过惯性解算
实时提供。由于磁力仪与车体捷联,其输出值为地
磁场在体坐标系下的投影。为了确定航向角,这些
投影值需要转换到当地水平坐标系下,其转换公
式“为
式中:B5?.B,和友是地磁场在体坐标系下的投影分
BB,和B“是地磁场在当地水平坐标系下的水平
投影分量;4和9是车体的滚动角和俯仰角。车体
与磁北方向的夹角Vs可根据(2)式“计算得出。
对4进行当地磁偏角5的修正,即可得到车
体与地理北之闻的夹角,此即为航向角。6值可通
过查询全球磁场模型得到“。
2“传感器误差模型
地磁场的测量误差来源于传感器自身的误差
(非正交误差、刻度因子误差和零偏误差)和载体碟
场干扰(硬磁误差和软磁误差)。在数学上,这两类
误差统一建模为总非正交误差、总刻度因子误差和
总零偏误差“““.e“-4。磁力仪的输人输出过程“
可描述为
KB是地磁场矢量在传感器坐标系下的投影;
B?是地磁场矢量在体坐标系下的投影;p,0,0,是
总非正交误差角;ki、ko、ks是总刻度因子误差;o、
0,.0;是总零偏误差。
如文献[4]所示,总非正交误差角来源于磁力
仪的制造工艺误差磁力仪安装误差以及软磁误差;
总刻度因子误差则来源于传感器刻度因子误差和软
磁误差;总零偏误差由传感器零偏误差和硬磁误差
组成。三轴磁力仪的标定模型可对(3)式进行逆向
映射得到,即
式中:B“是标定后地磁B?场测量值在体坐标系下
的投影;参数化矩阵P=K“,同样是下三角矩阵。
假设捷联三轴磁力仪在一个固定磁场的区域旋
转,那么磁力仪标定后的输出将约束分布在以当地
地碑场幅值为半径的圆球表面上,即有|
式中:R是当地地磁参考场的帽值。将(4)式和
t5)式展开可得
式中:B:、ByMB,是8“的3个分量值;a:,i=1,2,
…,10是由标定参数P和0定义的中间变量。假设
存在g个地磁场测量值,由这些测量值组成的观测
方程可联立组合成矩阵形式的线性方程:
式中:A=
注意到数据矢量)的构成可以从观测方程中任
意选取。地磁场测量个数4远大于观测方程中的未
知量个数,因此(7)式是一个超定线性方程组。一
旦方程组求解出未知量X,即可从中解算出标定参
数的估计值P和O.
3“总体最小二乘标定方法
在磁力仪标定中,系统矩阵4和数据矩阵b都
受到测量噻声的干扰,导致(7)式可能是不相容的。
在此情况下,线性最小二乘解不再是最优的。文献[9]
采用TLS算法来处理系统矩阵A和数据矩阵b都
存在误差的情况。TLS通过最小化以下指标得到问
题的解:
式中:‖*||y是Frobenius模;和日分别是包含误
差量的4和52(〈8)式的求解可以参老文献[15]。
首先,对扩展矩阵(4,8)进行奇异值分解,得
式中:n是丁的维数;ri是第;个奇异值,并且有
u么z乐火之C,,iiti是矩阵L的第5列矢量,[e
R??UU=1,;v,是矩阵7的第;列矢量,口e
R (+1) x(n+1) , vv 二 ′′z′_.l ;芝 二 (iiag(o'l 明 (]-′'___】 ) o
如果矩阵A是满列秩的,那么(8)式可得到闭合
解1为
式中:r,,是扩展矩阵(4,5)的最小奇异值。从统
计的角度看,+,,T,。是误差协方差的估计矩阵。
与最小二乘方法相比,TLS方法从协方差矩阵4“4
中移去测量误差使之能够获得更高精度的解,其付
出的代价是TLS的解过程,是降正则化的。
4“截断总体最小二乘标定方法
在车载磁力仪标定中,车体的机动受到限制。
车体一般绕天向绅进行顺时针或逆时针的旋转获得
用于标定磁力仪的地碟测量数据。当车体在水平面
内时,由于垂直方向上的地磁测量误差无法被充分
激励,这些测量数据只能满足二维磁力仪(两个正
交敏感轻固定在水平面内)的标定,无法满足三维
轴碟力仪的标定““。由这些测量数据组成的磁观
测方程,将会导致系统矩阵4的条件数很大,即观
测方程是病态的。如果不针对该问题进行适当地处
理,那么车载磁力仪标定问题将可能得到不可靠的
解,甚至是无解。为了求得稳定的解,需要引人正则
化方法。
在选择正则化方法的时候,所选算法应具备处
理等式两边的误差能力。TTLS方法是基于TLS方
法发展而来的,它适用于严重病态的、方程等式两边
都存在误差的线性求解问题。该方法的基本思想是
通过截断小的奇异值对应的解的部分,使得解更为
稳定,其算法流程总结“如下
1)H&E(Ab)的奇异值分解;
2)选择适当的正则化参数5(f与n);
3)对矩阵进行分坡,
4)TTLS的解可通过下式得到:
式中:V5=Va/』Vay|:是V的伪逆。(11)式中
V,的元素不能全为0,而实际上总是能够将正则化
参数〖凑小到足够程度,使得V拥有足够大的范
数。
文献[11,17]给出了s的模以及残荣rons19
模的表达式为
式中:(4,,5:)是(4,85)的秩最佳逼近;G+.u到
on(ALD)的对应的奇异值;||Xsns。代表对解
的平滢度约束;|rons‖r代表对数据的拟合度。随
着参数k的增加,‖Xen‖相继增加,‖ros‖e相
继减小。为此5的取值应该是上述两个模值平衡的
结果。近些年,许多选择正则化参数的方法相继被
提出,但是每一种方法都不能够适用于所有的病态
问题,因为正则化参数的最佳选择是依据所解决的
问题而定的。
本文选择L曲线法““作为正则化参数确定的
方法。L曲线准则是以‖rms‖e为横坐标,以
‖丞s为纵坐标,可得到许多点,这些点通过拟
合得到一条形状如字母“L“的曲线。曲线的掌点能
够较好地平衡上述两方面的信息并且同时保持它们
的取值较小。因此,拐点所对应的正则化参数即为
L曲线法的最优值。
5“实验与结果
为验证TTLS标定方法的有效性,将车载磁导
航系统安装在面包车体内进行测试。为准确估计磁
导航的精度,车体内部独立安装了惯性导航系统/全
球定位系统(INS/CPS)组合导航系统,可提供最大
精度误差为0.1“的航向角作为参考。
选择一块地磁场恒定的区域作为标定区,测得
转过程中尽量地改变俯仰角。车载三轴磁力仪测得
旋转过程中的地磁场数据,用于对磁力仪的标定。
通过计算可知系统矩阵4的条件数为1.36x107,
表 明 以线任觉诚力租春广里罡怀的““。LID坂乐
方法由文献[9]提出,其标定效果要好于枕球拟合
法,因此本文木用TLS法与TTLS法进行对比。利
用TLS和TTLS标定算法处理测量数据,可得到碟
力仪的标定参数如表1所示。
表 1 参数估计结果
Tab. 1 Parameter estimates
算法九0
图 1 是TLS和TTLS标定结果对比。图中实线
为车载三软磁力仪测得的实时数据,由于仪器以及
载体干扰磁场的影响,未标定的地磁曲线偏离真实
磁场值(46100aT)较大,其峰峰值差异约20000nT.点
线为TLS法的标定结果,因为系统病态,由TLS标
定后的测量曲线已经远远偏离了真实值,并没有
起到标定的效果,这表明TIS法无法应用于病态
情况下的三轴磁力仪标定。虚线为TTLS方法标
定结果,其标定后的测量值则接近地磁场值。后r
表 示 标定后的地磁场测量值,ro表示真实磁场值,
那么标定后的相对均方根误差rmse可由下式计算
得到:
式中:NW表示地磁场测量个数。经计算可知由TTLS
标定后的磁场值均方根误差小于1%.实验结果表
明TTLS标定方法能够准确地估计磁场误差并进行
有效地补偿,表明正则化技术是标定方法在病态问
题中获得鲁棒解的关键性因素。
由于TLS方法无法应用于病态条件下的三轻
磁力仪校正,也无法进行航向角的估计,因此在航向
角比较实验中,本文采用椭圆拟合法“与TTLS标
定法来比较结果。图2是磁力仪经过标定后的车载
磁航行实验。图中的航向角参考曲线由车载INS/
CPS组合导航系统提供。从图中可以看出:当车辆
在水平行驶时,两种标定方法标定磁力仪并解算的
航向角曲线都能够接近航向参考曲线;当车辆在转
弯爬坡时,楼圆拟合法航向角误差远比TTLS标定
法航向角误差大。这是因为椭圆拟合法仅对水平面
的二维磁力仪进行了标定,并没有考虑天向轴传感
器的测量误差。由于车辆在转弛爬坡时导致天向轻
磁力仪在水平投影中所占的比例增大,使得椭圆拟
合法航向角解算误差增大。TTLS标定法考虑了磁
力仪天向轴分量数据的影响,并有效地抑制了病态
性问题,从而提高了磁航向估计精度。
中,实线为TTLS校正法航向误差曲线,其平均航向
角误差约为1.5「,可满足车载磁导航的精度需
RUSH。虚线为椭圆校正法航向误差曲线,其平
均航向误差约为4.3“.通过对比可看出TTLS校正
法的优越性。
6“结论
磁力仪的标定是影响车载磁导航精度的关键技
术。由于车辆机动能力受限,三轻磁力仪标定问题
中的观测方程将严重病态,早先提出的三轴磁力仪
标定方法如TLS标定法有可能不再适用,因此正则
态情况下的磁力仪标定问题,能够有效地披制病态
问题带来的影响,获得准确的参数估计。车载磁导
航实验结果表明该方法提高了航向角估计精度和鲁
棒性。
参 考 文 献 ( References)
【11 Caruso M J. Applications of magnetic sensors for low cost compass
systems[ C ] // IEEE 2000 Position Location and Navigation Sympo-
sium. San Diego, CA:IEEE, 2000:177 - 184.
[2] Siddharth S, Ali A S,El-Sheimy N, et al. A game-theoretic ap-
proach for calibration of low-cost magnetometers under noise uncer-
tainty[ J]. Measurement Science and Technology, 2012, ,23(2 ) ;
025003.
[3] FangJC, Sun H 罚 , Cao J J,et al. A novel calibration method of
magnetic compass based on ellipsoid fitting [ J]. IEEE Transac-
tions on Instrumentation and Measurement, 2011, 60(6) :2053 -
2061.
[4] Foster C C, Elkaim G H. Extension of a non-linear, two-step cali-
bration methodology to include non-orthogonal sensor axes [ 了 ] .
IEEE Transactions on Aerospace Electronic Systems, 2008,
44(3 ) :1070 - 1087.
[5] Gebre-Egziabher D, Elkaim G H, Powell J D,et al. A non-line-
ar,two-step estimation algorithm for calibrating solid-state strap
down magnetometers[ C ] 人 8th International Conference on Naviga-
tion Systems. St. Petersburg, Russia;IEEE/AIAA, 2001:290 ~
297.
[6]“徐玉,任沁源,孙文达,等.微小型无人直升机地磅导航算法
研 究 [ 门 . 兵 工 学 报 , 2011 , 32(3 ) : 337 -342.
XU Yu, REN Qin-yuan, SUN Wen-da, et al. A geomagnetic nav-
igation algorithm for miniature unmanned helicopter[ J]. Acta Ar-
mamentarii, 2011, 32 (3 ) :337 - 342.(in Chinese)
[7]黄学功,王员.地磁信号检测系统误差分析与补偿方法研究
[J1. 兵 工 学 报 , 2011, 32(1) : 33 - 36.
