基于 PHOW 特征描述子和支持向量机的航空侦察图像分类方法
在深入研究 PHOW 特征描述子的基础上，提出了基于 PHOW 特征描述子和支持向量机的航空侦察图像分类方法。针对构建的5类航空侦察图像分类实验结果表明，与基于 Gist 特征描述子的图像分类方法相比，新方法可以实现快速准确的图像分类，平均分类精度为84．6％，特征提取和分类的平均耗时为37 ms。

航空侦察图像 图像分类 塔式关键词直方图 支持向量机  

0引肉
随着各种先进成像侦察设备的成功研制和大量应
用,航空侦察系统已经可以轻易获取全面的战在图像。
但是要在较短的时间内对图像信息进行综合分析和解
译,判定目标属性,形成有价值的战场实时情报,仍是
一项巨大的挑战。本文主要研究航空侦察图像处理中
的图像分类技术。战场图像的自动分类技术可以在大
型图像集合中挖掘有价值的信息,避免非必要的目标
检测以及节省存储空间和传输带宽,从而提高图像情
报的精确性和时效性。
目前,关于图像分类的研究主要集中在以下两个
方面:1)图像特征的提取和表示;2)分类器的设计。
图 像 特征是指图像的原始特性或属性。每一幅图像
都有其自身的特征,其中有些是视觉直接感受到的自
然特征,如亮度、边绍、轮廓、纹理或色彩等,有些是需
要通过变换才能得到的人为特征,如谱.直方囹等。图
像特征的提取和表示是图像分类的基础,特征选择
错误,分类就不能分得准确,甚至无法分类。在准确提
取图像特征的基础上,如何有效地实现图像分类,关
键在于分类器的设计。典型的分类器主要包括有监督
分类和无监督分类两种,比较常用的无监督分类器包
括 ISODATA ( Iterative Self-Organizing Data Analysis) 和
K坞值;有监督分类器包括最小距离,马氏距离、最大
似然.神经网络和支持向量机(SupportVectorMachine,
SVM)等。
依据图像特征的性质,通常将图像分类方法概括
为3类。1)基于图像低层特征的方法,主要通过提取
图 像 的低层全局或区域特征(如颜色.纹理,形状等),并
结合有监督分类器来对某些类别的图像场景(如户内/
户外,城市/乡村,日落/森林等)进行识别,代表性工作
主要有文献[1]提出的基于内容的软标注(Content-
BasedSoftAnnotation,CBSA)算法。2)基于图像语义特
征的方法,利用图像的中层语义建模来实现图像场景识
别,是当前研究的热点和主流,这类方法又可以归纳为
以 下 3 Fp: DH iE XR (semantic objects) ) , 通 过 检
测或识别出图像中的语义对象来描述整幅场景,代表
性工作见文献[2-3];@)建立图像的局部语义概念
(localsemanticconcepts),主要思想是自动检测图像中
的感兴趣点,并采用局部描述子描述这些点,然后建立
局部描述子到某种局部语义概念的映射,再利用局部
语义概念的分布来实现图像场景的识别,代表性工作
详见文献[4-5];G@)图像场景的全局语义性质,通常
是图像的全局统计特性,如自然度、开阅度和粗糙度
等,代表性工作为由文献[6]提出的场景中间层语义
描述方法。3)基于图像分割的方法,基本思愚是首先
把图像分割成若干区域,然后对这些区域进行识别,最
后综合所有区域的识别结果得到图像的类别,常见方
法有分层多尺度模型和语法解析模型等“。
本文深人研究了图像语义特征中的PHOW(Pyra-
midHistogramofWords)特征描述子,提出了基于PHOW
特征描述子和支持向量机的航空侦察图像分类方法,该
方法从分类正确率和计算耗时两个方面,都优于基于
Gist特征描述子和支持向量机的航空侦察图像分类方
法,基本满足航空侦察图像快速准确的图像分类需求。
1ETPHOW描述子的图像特征提取方法
词 包 ( Bag of Words, BOW ) 或 称 特 征 包 ( Bag of
Features,BOF)模型的基本思想是借鉴文本分类技术,
将 图 像 表 示 成 一 系 列 祈 觉 关 键 词 ( visual words) 的 统 计
直 方 图 。 所 谓 视 觉 关 键 词 就 是 由 训 练 图 像 局 部 区 域 特
征(如颜色,纹理.兴趣点)经过聚类形成的聚类中心,视
觉 关 键 词 的 集 合 形 成 所 谓 词 包 。 传 统 的 词 包 模 型 忽 略
了图像的空间位置特征,并旦采用稀疏采样方式,不利
于图像结构特征的提取。文献[8}提出了一种基于空
间 塔 式 直 方 图 的 词 包 技 术 (PHOW ) , 简 称 塔 式 关 键 词
直方图。主要包括4步:特征检测、特征描述、字典生
成 和 矢 量 量 化 描 述 符 并 计 算 金 字 塔 关 键 词 直 方 图 。
1)特征检测。
所谓特征检测就是按照柄种准则,抽取图像中若
干局部图像块或者区域。特征检测方法大致可以分为
以下3类:1)规则网格法;2)兴趣点检测法;3)随机
采样(randomsampling)等。PHOW方法采用的秦密采
样(densesample)方式属于规则网格法。采样间隔设
为8个像素,每个像素块大小为16x16。
2)特征描述。
PHOW方法采用SIFT特征描述子。基本原理为以
当前点为中心,划分一个16x16的窗口,将这个窗口切
成4x4的子窗口。在每个4x4的小块上计算8个方向
的梯度方向直方图,统计每个方向的累加值,即形成一
个种子点。一个中心点由4x4共16个种子点组成,每
个种子点包含8个方向的信息,这样,由种子点生成的
SIFT特征向量就有16x8=128维。
3)字典生成。
图 像 经过特征检测和揩述之后,得到一个描述符
的集合,记为。然后基于欧氏距离,利用K均值算法
把集合S职成7类,每个聚类中心相当于一个视觉关
键词,而由所有的聚类中心便构成了一个视觉字典,记
为。本文字典伟的大小7由人工设定为300。
4)矢量量化描述符并计算金字塔关键闭直方图。
对于YVd,eD,,,n=1,...,NW(D为所有训练图
像集合),经过特征检测和特征描述之后,得到图像,
的描述符集合,记为5,。然后根据最近邻规则,按照欧
氏距离把每个描述符矢量量化为字典K的某个关键
词 , 结 果 集 合 S, 的 每 个 描 述 符 便 可 以 用 其 对 应 关 键 词
在字典K的索引序号来表示。
为了引人位置信息,首先生成图像4,对应的空间
金 字 塔 P,, 然 后 计 算 P, 的 关 键 词 直 方 图 。 假 设 空 间 金
字塔P,的深度为D,即P,共有D层,每层又包含若干
单元格(cell)。P,的第1层(!=1)就是图像d,本身;在
第71>1)层,每个单元格分裂成4个互不重叠的单元
格。重复分裂过程直至!=D。这样,金字塔P,的第1层
共有(2“)*=2““个单元格;若深度为D,则P,共有
>22个单元格。
对于金字塔P,的第!层第e个单元格,计算其视觉
关 键 词 直 方 图 , 记 为 , , 其 中 ,[X,.]; 表 示 关 键 词 ; 在 当
前单元格中出现的次数,=1,...,D,c=1,...,220-0,
1=1,...,7,拼接金字塔图像P,中所有单元格的关键
词 直 方 图 便 形 成 了 图 像 d, 的 金 字 塔 关 键 词 直 方 图 , 即
级数为2,则最终形成的PHOW的维数为300+300x4=
1500 、
2“航空侦察图像分类步骤
在特征提取及描述的基础上,本文采用SYM进行
王人巴“尬
航空侦察图像分类,其体实现时利用VL_feat软件包中
Pegasos算法训练线性SVM。训练SVM时,日标明数为
FH ey (wx, -b)=1 - Loss(w,x,,y,) ,Loss 为 hinge
振失,N是训练样札个数,任务是求取目坤函数最小时
的w和5。输入参数主要有训练样本x及其类别y,正则
参数A、最大迭代次数和偏差b的系数。
测试时,将w和0代人式(3),对/的每-列求取最
大值,即可得到对应图像的类别,即
万=口生了a+。(3)
通过前卜对航空侦察图像特征提取方法和分类方
法的具体闹述,向以将航空侦察图像的分类步骤概指
在图1中,主要包扫两部分,分别是训练过程和测试过
程,这两个过程都要用到图像的特征提取及描述。在
训练过程中,对每一幅训练图像进行秦密采样得到
SIFT特征描述子,通过词包的思想形成每幅训练图像
的 关 键 词 真 方 图 , 并 与 金 字 塔 思 想 结 合 , 形 成 PHOW
描述子,其丨,每幅训练图像的类别标签都是乜知的,
支持向量机利用每幅训练图像的PHOW特征搅述子
和其相应的类别标签,得到一个学习模型。测试时,对
一幅测试图像进行秦密采样得到SIFT特征描述子,通
过 训 练 过 程 形 成 的 词 包 , 形 成 测 试 图 像 的 关 键 词 直 方
图 , 并一金字塔思想结合形成PHOW探述子。支持向
量机通过测试国像PHOW描述子和学习慰型,预测出
测试图像的类别标签。对比预测标签与已知标签,从
而得到航空依察图像的分类正确率。
3“仿真实验
在图像分类实验部分,首先介绍本文构建的航空
侦察图像分类(见图1)数据库。
然后做了两个实验:基于Cist描述子和SVM的图
像分类实验,以及基于PHOW描述子和SVM的图像分
类实验。坊每个实验里,首先对描述子的特征提取性
习“招“制第21卷
能进行分析,然后评估SVM的分类教果,主要采用正
确分类的图像数占总的图像数的比例来评估分类性
能,以及运行时间来评估算法的实时性。仿真实验时
软便件配置为台式兼容机,硬件性能为3.4GHzCPU,
4G内存;操作系统为WinXPSP332位,开发软件为
Matlab7. 6 和 vs2008 。
3.1“航空侦察图像分类数据库
航空侦察图像分类数据库包括5类图像:第--类
是Highwayandopencountry,即高速公路和乡村图像,
选择原囚是类似于海天背景,对图像分类算法有一定
干扰作用;第二类是Off-shoreship,即离岸边给还的深
海舰船图像,这类图像中舰船的背景怒全部海洋或者
海面,天空都有;第三类是Portship,即港口舰船,这类图
像中舰艇都处在港口之中;第四类是Waterfrontship,即
海滨舰船,这类图像中舰船靠近岸边,国像背景中有岸
边海面和天空等;第五类是Sea,即海洋,选择原因也是
对分类算法起干扰作用,图像背景中没有舰船,有海面、
岸边.天空.岛屿等。上述5类图像的部分示例见图2。
数据库中所有图像的规格说明:1)灰度图像,大小256x
256;2) Highway and open country 图 像 600 光 , Off-shore
ship 图 像 491 张 ,Port ship 图 像 112 张 ,Waterfront ship 图
像522张,Sea图像305张。
在实验之前,简单介绍一下基于Cist描述子和SVM
的图像分类方法。基于Cist特征描述子进行图像分类
有两种思路:1)全局能量光谱和局部能量光谱定义了每
幅图像的全局表示,直接基于这个表示可以进行图像分
类;2)从全局能量光谱和局部能量光谱表示来估计穹间
包络模型中的各个特性,然后利用这些特性的差别区分
不同场景“。本文采用第--种思路来表示图像的仪局
特征,具体模型为:1)对输人囹像进行预处理;2)将预处
理后的图像划分为4x4相等的日相互不重叠的小区
域;3)对各个小区域实施Gabor变换,得到全局特征向
量;4)利用加权平均的方法进行特征降维,每幅图像形
成一个512维的特征向最。
在特征提取和描述的基础上,基于Gist特征描述子
的图像分类方法只密将航空侦察图像分类步骤中全局
特征部分更换为Gist特征描述子即可。
1)Gist描述子特征提取参数分析。
Gist描述子涉及的参数主要有3个:图像划分块
数,预滤波参数,每几度方向数。预滤波参数默认为4,
每尺度方向数为[8,8,8,8],对描述子生成有明显影响
的是图像划分块数,改变参量numberBlocks,令其等于
4和10,观察实验结果的不同,见图3。可以看出,num:-
berBlocks越大,模拟图片中分割点数就越多,就与原图
像越相似,分类就越准确,但是计算消耗的时间就越多,
为了平衡分类准确度和尽量减小计算时间,number-
Blocks取4较为合适。
2)图像分类实验。
每类训练图像样本数为100,其余全为测试图像。
SVM训练分类器的输人参数主要有训练样本x及其类
别y,正则参数A\最大迭代次数和偏其5的系数。实
验经验值为:A=10,(L为训练集图像的数
量 ) , MaxIter 为 50/A; BiasMultiplier 为 1。 分 类 结 果 见
Fl.横、纵坐标代表的怠5类场景的名字,以第一行
为例,表内的数字代表所有测试图像(Highwayand
opencountry)分到5类地景的肉分比,很明显,这个场
景与Sea场景非常相似,高达10.8%误分为Sea场景。
深海舰船图像(Off-shoreship)的分类准确率最高,原
因在于它与其他几类场景的区分度相对较高。港口图
像(Portship)明显不海洋和深海舰船图像不同,所以
误分率为0。海洋图像(Sea)与高速公路和乡村图像
较相似,所以高达13.66%误分为高速公路和乡村囹
像。海滨图像(Waterfrontship)与深海舰船图像和港
口图像都有较多相似之处,所以误分率较高。总之,平
均分类正确率达到81.44%,基本满足航空侦察图像
的分类需求。然而,测试计算耗时发现,Cist特征提取
部分耗时约877s,训练和测试部分耗时约179s,每幅
图 像 分类的平均耗时约520ms,耗时主要集中在特征
提取部分,因此需要研究更加合适的特征提取方法。
表 1 Gist描述子图像分类准确率
Table 1 The correct ratio of image classification
using Gist descriptor
3.3基于PHOW描述子和SVM的图像分类实验
3.3.1PHOW描述子特征提取参数分析
PHOW描述子涉及的参数包括:1)网格大小bins-
ize,移动步长髓ep，实验日寸binsize为7,step为5;2)网
格数量binnumber,梯度方向数gradsnumber,实验时,
binnumber 为 16,gradsnumber 为 8;3 ) 字 典 大 小 , 实 验
时,取300;4)金字塔层数,每层元胞个数4,实验
时,!取2,4取21。
在上述参数中,需要调整的参数有:binsizestep,
V,1。调整一个参数,保持其他参数不变,观察对生成
的PHOW描述子有仕影响。所有参数不变时,港口图
像生成的PHOW描述孔见图4b,binsize调整为3BY,
PHOW描述子见图4c,step调整为7时,PHOW描述子
WH 4d, V = 200 时 ,PHOW 描 述 子 见 图 4e,1 = 3 时 ,
PHOW描述子见图4f(。很明显,参数的变化对PHOW
描述子的形状影响不大,要么更精细、计算量更大,要
么稍粗糙.计算量小,但对后续的目标识别影响很小。
因此,可以说,基于PHOW描述子的特征提取方法对
参数的变化不敏感,利用默认的实验参数,可以对不同
图 像 具有较大的适应忱。
a 输 入 图 像 b 关 键 词 索 引 号
c 关 键 词 索 引 号 d 关 键 词 索 引 号
e 关 键 词 索 引 号 f 关 键 词 索 张 号
图 4 不同参数时港口图像生成的PHOW描述子
Fig.4 The PHOW descriptors of port image using
different parameters
3.3.2“图像分类实验'
令训练样本、测试样本以及SVM训练分类器的输
人参数与Gist描述子分类实验时相同,分类结果见表
2。很明显,港口图像明显与海洋和深海舰船图像不
同,所以误分率为0。与Gist描述子相比,对Waterfront
ship的误分率也为0,这说明PHOW特征描述子更能
表 示 港口图像的本质特征。与Gist描述子类似,由于
Highwayandopencountry场景与Sea场景非常相似,
PHOW描述子的误分率也比较高,高达12.2%。深海
舰船图像的分类准确率最高,原因在于它与其他几类
地景的区分度相对较高。海洋图像与高速公路和乡村
图 像 较相似,所以高达14.63%误分为高速公路和乡
村图像。海滨图像与深海舰船图像和港口图像都有较
多相似之处,所以误分率较高。总之,平均分类正确率
达到84.62%,明显高于基于Gist描述子的图像分类
方法。
表 2 PHOW描述子图像分类准确率
Table 2 The correct ratio of image classification
using PHOW descriptor
测试计算耗时发现,字典生成部分耗时约46.45s,
直方图特征提取耗时约75.17s,SVM分类器训练时间
约27.13s,测试时间约0.0469s。则每幅图像PHOW
特征提取和训练的平均时间为91ms,每幅图像PHOW
特征提取和分类的平均耗时约37ms,因此,基于
PHOW特征描述子和SVM的航空侦察图像分类方法
可以实现快速准确的图像分类。
基于上述实验分析,可以得出如下结论:
1)无论是Gist描述子,还是PHOW描述子,需要
修改的参数对特征描述子的生成影啡不大,这意昧着
通常情况下这些参数可以保持黯认值,也说明这两个
描述子的图像适应性比较强;
2)Gist搀述子的特征提取时间偏长,而PHOW描
述子的特征提取时间较短,且能更好地提取航空侦察
图 像 的全局特征;
3)利用线性SVM分类器即可满足分类需求,若
有更复杂的分类情况,再考虑非线性SVM分类器;
4)提出的基于PHOW揪述子和线性SVM分类器
的航空侦察图像分类方法无论从分类精度,还是计算
耗时,基本可以满足航空侦察图像快速准确的图像分
类需求。
4“结束语
本文在图像分类现状研究的基础上,首先重点分
析了基于PHOW描述子的图像特征提取方法。获取
PHOW特征的基本思路为:1)采用稠密采样方式提取
特征;2)运用SIFT特征描述子描述局部区域;3)利用
K 均 值 聚 类 生 成 视 觉 关 键 词 ;4 ) 矢 量 量 化 描 述 符 并 计
算 金 字 塔 关 键 词 直 方 图 。 结 合 SVM 分 类 器 , 通 过 训 练
和测试两个阶段,实现航空侦察图像分类。仿真实验
表 明 ,提出的基于PHOW特征描述子和SVM的航空侩
察图像分类方法的平均分类精度为84.6%,特征提取
和分类的平均耗时为37ms,具有较高的分类精度和较
低的计算耗时,基本可以满足航空侦察囹像快速准确
的图像分类需求。
