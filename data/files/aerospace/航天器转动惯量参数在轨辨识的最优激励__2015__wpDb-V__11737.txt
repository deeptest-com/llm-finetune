航天器转动惯量参数在轨辨识的最优激励
根据矩阵分析理论研究了转动惯量参数的可辨识性问题，从姿态动力学方程导出关于未知参数的线性回归模型，将回归矩阵的条件数作为参数可辨识度的定量指标，以可辨识度最大为目标函数建立最优控制模型；应用解最优控制问题的伪谱法，计算控制力矩陀螺的指令轨线，使得惯量参数的辨识精度和收敛速度显著提高；在仿真中采用双无迹卡尔曼滤波算法进行参数辨识，结果验证了所提出的最优激励设计方法可以改善参数辨识性能，同时该方法对先验信息误差具有鲁棒性。

在轨辨识 转动惯量 可辨识度 回归模型 最优控制伪谱法 双无迹卡尔曼滤波  

转动惯量参数在航天髓姿态控制中扮演着十
分重要的角色,包含转动惯量参数的控制律具有
较高的控制精度和较小的需用控制量,而不准确
的转动惯量参数会导致控制性能下降甚至失稳。
因此,航天器在发射前要进行地面测量试验标定
质量特性参数,保证控制算法有效。在辐运行一
段时间后,由于工质消耗等原因,航天器的质量特
性参数与发射时相比具有较大差异,一些特殊的
空间任务,如载荷释放、在轨装配、空间捕获、空间
对接等也会使系统构型发生巨大改变。此时,要
继续保持姿态控制稳定,就需要进行在轨辨识,以
获得控制算法需要的惯量参数。
Bergmann最早提出了在轨辨识的概念,之后
众多学者围绕该问题进行了深人的研究“,形
成了几种成熟的辨识方案:参数渣波方案““““、最
小二乘方案“-以及非线性规划方案““。一些具
体的辨识算法还得到了在轨实测数据的检
验“““1。国内学者也在该领域开展了部分研究,
并取得了一些成果:文献[8]将参数估计问题转|
化为非线性全局优化问题并采用粒子群优化
( Particle Swarm Optimization ,PS0) 方 法 求 解 , 同 时
辨识出质量、质心位置和转动惯量;文献[9]提出
了一种两步辨识方法,先估计出转动惯量比参数,
再辨识滚动轴转动惯量值,基于转动惯量比参数
和滚动轴转动惯量参数计算出转动惯量矩阵参
数;文献[10]对非线性动态方程进行泰勒展开,
忽略高阶项后建立线性回归模型,采用迭代最小
二乘法计算质量特性参数,并利用条件数和奇异
值分解理论对回归矩阵进行分析,研究了待估质
量参数的可辨识性和可辨识度。
通过大量的仿真计算发现,无论采用何种勘
识方案,算法收敛速度和辨识精度都严重依赖于
系统输入的激励,对同一种算法,不同的激励输入
会导致不同的收敛速度和辨识精度。本文针对控
制力矩陀螺(ControlMomentGyro,CMG)作用下
的大型组合体航天器,提出了一种优化执行机构
控制指令的方法,使得在优化控制指令的激励下,
辨识算法的收敛速度和估计精度显著提高。仿真
采用双无迹卡尔曼滤波(DualUnscentedKalman
Filter,DUKF)算法进行参数估计,对比正弦信号
和优化信号激励下辨识性能差异,并验证了所采
用的最优激励设计方法对未知参数先验信息具有
鲁棒性。
1姿态运动模型
由多个刚体组成的组合体系统中,主刚体质
量为mo,相对自身质心的惯量矩阵为,各个子
刚体相对自身质心的惯量矩阵为;,质量为m,整
j=1
心的位置矢量,为系统总质量,为3阶矩阵,所
有的张量J;和矢量r均描述在同一个坐标系下,
通常选择主刚体固连体坐标系为计算坐标系。
若各子刚体之间没有相对线位移,则组合体
平台可视为陀螺体,系统动力学方程为
式中,为航天器的角速度;T.为干扰力矩;T7u为
控制力矩,假设执行机构为控制力矩陀螺,则7为
71壑`(藿t一一′′C丨/[(;一X′霍(二噩/丨(垦(3)
Hophowe为控制力矩陀螺的角动量。参考文献
[11]的设计,考虑控制力矩陀螺有4个转子,每
个转子的角动量幅值均为h,4个转子的框架角
(gimbalangle)分别为65,、6,和5,,框架角转动
轴与x-y平面的夹角为8,可以写出本体坐标系
Thee Hh cue 435A
其中,c=cos(A),s=sin(A)。在中心刚体本体坐
标系下,CMG的配置如图1所示。
免出现奇异,采用四元数描述组合体平台姿态,运
动学方程为
其中,e为四元数,g,为四元数的矢量部分,q,为
四元数的标量部分,矩阵函数42(4)为
2g) = [-g, 9 - 87]
由于四元数是一种冗余的姿态参数,独立变量个
数为3,因此采用四元数描述的姿态运动模型是
一个微分-代数方程组(Differential-Algebraic
Equations, DAE) 。
2“基于UKF滤波算法的状态-参数估
计器
无迹卡尔曼滤波的特点是采用UT变换计算随
机变量的统计信息,可以将非线性系统的统计信息
保留到2阶。当需要进行参数估计时,可以将待估参
数作为扩展状态量,把描述参数变化的动态方程扩
充到原状态方程组中.但状态维数的增加不仅使滤
波过程中的矩阵求逆运算变得困难,还可能造成状
态协方差矩阵负定。一种解决方法是构造状态-参
数 双 滤 波 器 (state - parameter dual filter) 021 。
2. 1 “ 状 态 估 计 器 (state estimator)
采用四元数作为滤波状态量,在UT变换时,
会造成四元数的Sigma采样点不满足归一化条件
的矛盾。为此定义误差四元数54
式中,符号@表示四元数乘法。
以误差四元数的矢量部分8g,和角速度w作
为滤波状态量x=[Sg,。w],设误差四元数矢量
部分5g,的Sigma点为595,则根据四元数的归一
化条件,误差四元数59的Sigma点为
再根据定义式(5),利用54?和前一时刻的四
元数均值6,计算姿态四元数的Sigma点g「,此时
4可以保证归一化条件,将q“代人到动态方程
(4)中进行状态递推,以完成UT变化计算。
状态估计器的状态方程组可写为
Hf,oy,J,T..,At)为式(2)数值积分后得
到的非线性函数,为时刻角速度;At为时间
Fw,为干扰力矩和离散化误差等未建模项组
成的分量,假设为零均值高斯白噪声,
w,~ N(0,0,) ,8(w,,8q, ,,At) 为 式 (4) ~(6) 组
成的非线性函数,5g9,,为时刻误差四元数矢量
部分;w,为零均值过程噪声,w,~N(0,4)。
设组合体航天器上安装有星敏感器或地磁敏
感器,在惯性系中的两个矢量v和“可以被敏感
器测量到,测量方程为
式中,R(wy,58x)为矩阵函数,表示惯性系与组
合体本体坐标系间方向余弦矩阵。
2.2 “ 惯 量 参 数 估 计 器 (inertia parameter estimator)
惯量矩阵作为待估计参数,定义参数估计器
的状态矢量为
9 = [ 厂 J, J. I, J. JI
考虑机动过程中组合体构型无变化,则参数估计
器的状态方程可以写为
式中,b,为时刻的待估参数矢量;w,为零均值高
斯白噪声,w。~N(0,07),
选择状态估计器输出的角速度估计值作为参
数估计器的观测量,观测方程为
式中,人)的定义与式(7)相同。从式(7)~
(10)可见,双滤波算法中,状态估计器和参数估
计器之间有数据交互,如图2所示。
3“基于伪谱法的最优激励设计
3.1“惯量参数的可辨识度
姿态动力学方程式(2)可以改写为关于惯量
参数的回归模型的形式
图 2 “双滤波算法计算框图′
Fig.2 Schematic of dual UKF
式中,矩阵p称为回归矩阵(regressionmatrix),
矩阵各元素为.
￠ =[N:I (12)
其中,和仪如式(13)和(14)所示,0,flo,
表 示 本体角速度各分量的导数。
如果可以测量角速度、角加速度和激励力
矩信号,并进行两次以上的测量采样,就可以构
建一个超定的线性方程组(overdeterminedlinear
equations)
式中,
一=[林林一林17卫=[匹.顺]
p:和7表示第i个测量时刻的回归矩阵和激励
力短。
惯量参数可以用最小二乘公式进行估计
0 = (Pd DY (16)
根据矩阵分析理论,最小二乘解0对回归矩阵的
摄动Ad的敏感度,可以用任意范数表示的条件
$cond(@)进行定量描述。条件数越大,解对摄
动越敏感,即使是微小的摄动也会导致巨大的误
差;条件数越接近于1,解对摄动越不敏感。由此
可见,确定测量采样频率后,参数估计的精度与测
量过程中运动状态的变化轨迹密切相关。
根据以上分析可见,回归矩阵@的条件数提
供了一种度量待估参数可辨识性的指标,据此定
义转动惯量参数的可辨识度为
K = 1/cond( 界 ) (17)
二范数表示的条件数可以根据奇异值分解(SVD)
计算
其中,是最大奇异值,是最小奇异值,一矩阵
的奇异值分解为
为对角阵,元素依次为@矩阵奇异值的递增排列
oo么Go之.乐CG,>0。
3.2“最优激励计算模型
针对所研究的CMC驱动下的组合体航天器
平台,引人参数可辨识度概念后,在轨辨识最优激
励问题可以被描述为:设计激励函数x(it)=
[5,口5,(蚤」t〕T，在′′〈痿)作用下产生状态轨迹
[o(t)(],使系统的可勘识度k<(志,@,t,
sty)最大。这是一个最优控制问题,其数学描述
为
6,分别为CMG控制量的下限和上限;和6,表示
CMG框架角限制。
求解上述最优控制问题,需要先给出待估参
数J的一个粗略估值,通过CAD技术和公式(1)
可以粗略估算组合体的惯量矩阵J“「“,先验值J
与真实值J间可能存在很大的误差。采用先验值
J综合出的最优激励u(t)是否对先验误差具有
鲁棒性,将在第4部分进行讨论。
3.3“伪谱法求解最优激励
复杂的非线性最优控制问题需要采用数值方
法求解,将问题转化为参数优化问题。具体的方法
分为两类:间接转换法和直接转换法.间接转换法
基于Pontryagin极大值原理将最优控制问题转化
为 Hamilton 边 值 问 题 ( Hamilton Boundary Value
Problem,HBVP),求出控制量的表达式,该表达
式一般为关于伴随变量和状态的函数,通过参数
化求解HBVP问题获得最优状态和最优控制量。
本文所要解决的最优控制问题的目标函数并
不是状态变量的显示表达,因而不能采用间接转
换法求解。伪谱法是一种近儿年发展成熟的直接
转换法0“1,该方法的特点是用全局正交多项式离
散化特定时间节点(node)的状态量和控制量,无
须数值积分,因而提高了计算效率,作为一种基于
有限元思想的配置点法,由于采用了正交配
置“,可以以较少的离散时间节点得到较高的拟
合精度。根据离散点类型的不同,又分为Legendre
伪 谱 法 (LPM) 、Causs 伪 谱 法 (CPM) .Chebyschev
伪谱法(CPM)\Radau伪谱法(RPM)等。本文在
求解最优激励时借助了基于Matlab软件的第3方
工具箱CPOPSL05!,CPOPS采用了RPM方法06-0]
求解最优控制问题。
4“仿真算例
4.1“最优激励信号仿真计算
仿真计算中,所采用的转动惯量真值J和先
BAGS"ag1所列。
表 1 “航天器转动惯量参数
Tab. 1 Elements of spacecraft moment of inertial
惯量元素真值(kg「山)“先验值(kg-m)
厂 2756 1837
小 , 12177 8118
一 10677 7118 .
一 , 240 160
Ju 750 500
厂 375 250
设机动持续时间为100s,测量周期0.1s。根
据第3部分所述方法,利用待估参数的先验值“
计算出CMC控制量5;(t)的最优轨迹如图3所
示,根据优化得到的目标函数值计算回归矩阵条
件数为
cond(?) = 1/x = 3. 860 4
正弦激励
积分,数值运算时转动惯量取真值J,得到角速度
变化轨迹如图4所示,此时根据数值积分结果计
算得回归矩阵条件数为
cond(?) = au/ar, = 3.442 8
为进行对比,同样对一组正弦控制信号作用
下的动力学模型进行了仿真和分析,正弦控制信
号轨迹及激发的角速度变化轨迹也在图3和4中,
根据数值积分结果计算得到的回归矩阵条件数为
cond(?) = ri/yry, = 6.880 1 x 10°
4.2“参数估计性能对比
采用第二部分所述的DUKF算法,分别对正
弦激励和最优激励作用下的组合体转动惯量进行
估计,图5给出了转动惯量参数总的估计误差变
化时间历程。总估计误差(TotalError,TE)定
义为
敛向真值,相同时间内,采用最优激励获得的估计
值更准确;虽然本文提出的最优激励设计方法需
要待估参数的先验值,但该方法具有较强的抗先
验误差的鲁棒性,在先验值与真实值相比具有
50%误差的情况下,参数可辨识度指标并未受到
影响,滤波结果也表明,所得到的最优激励轨迹仍
适用于真实对象。
5“结论
通过本文的研究,可以获得如下结论:1)采
用回归矩阵的条件数度量待估计参数的可辨识
性,这个定义不仅在最小二乘估计的意义下有效,
也在贝叶斯最优估计的意义下有效,正确反映了
未知参数的可辨识性与运动状态变化轨迹密切相
「关的特性。2)最优激励设计方法将参数估计的
最优激励问题转化为最优控制问题,应用伪谱法
进行求解,所得到的最优激励轨迹对待估参数先
验值误差具有很强的鲁棒性,说明该方法具有一
定的工程适用性。3)采用最优激励进行参数估
计具有收敛速度快,估计精度高的优点,可以提高
现有辨识算法的计算效率和可靠性。
采用GPOPS工具箱求解本文的最优控制辐
迹耗时较长,在PC机上综合一组转迹需要约
60min,可见要实现该方法的工程应用,需要进一
步研究提高伪谱法的计算效率。
参 考 文 献 ( References)
[1] Tanygin S, Williams T. Mass property estimation using coasting
maneuvers| J]. Journal of Guidance, Control, and Dynamics,
1997, 20(4 ) :625 ― 632.
[2] Palimaka J, Burlton B V. Estimation of spacecraft mass
properties using angular rate gyre data[ C]. American Institute
of Aeronautics and Astronautics, ,1992 ;21 -26.
[3] Bergmann E, Dzielski J. Spacecraft mass property
identification with torque-generating control [ J]. Journal of
Guidance, Control, and Dynamics, 1990, 13(1) ;99 -103.
[4] Bergmann E V, Walker B K, Levy D R. Mass property
estimation for control of asymmetrical satellites[ J]. Journal of
Guidance, Control, and Dynamics, 1987, 10(5) ;483 ―491.
[5] Psiaki M L. Estimation of a spacecraft’ s attitude dynamics
parameters by using flight data [ J]. Journal of Guidance,
Control, and Dynamics, 2005, 28(4) :594 ~ 603.
[6] Feldman A. In - flight estimation of cassini spacecraft inertia
tensor and thruster magnitude [ J]. Advances in the
Astronautical Sciences,2006 , 124:35 - 54.
{7] Wilson E, Sutter D W. Spacecraft on-board mass and thruster
property identification with spheres flight experiments [ C ].
Information Technology at Aerospace: Advancing Contemporary
Aerospace Technologies and Their Integration, Arlington VA,
United States,2005.
(下转第130页)
