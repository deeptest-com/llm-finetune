基于强跟踪的平方根 UKF 的卫星姿态确定算法
针对受不确定性干扰的影响卫星姿态确定系统,SRUKF 存在跟踪能力弱、估计精度低和鲁棒性差等问题,本文根据强跟踪滤波（STF）原理,提出了一种改进的强跟踪平方根 UKF 算法。该方法中,采用基于等价变化的方法来计算自适应渐消因子,避免了 Jacobian 矩阵的计算；引入两个多重自适应渐消因子矩阵,保证了协方差矩阵的对称性；利用改进的平方根分解方法,改善了滤波器的稳定性。实验仿真结果表明,相对于 SRUKF 和 STF,本文提出的强跟踪平方根 UKF 具有更好的稳定性、鲁棒性和对突变状态的跟踪能力。

四元数 QR分解 卫星姿态确定系统  

0 51 言
卫星姿态确定系统是卫星姿态控制系统的重要
组成部分,其精度直接影响姿态控制系统的精度,通
常采用滤波的方法从概率统计角度最优的估计出卫
星姿态。由于卫星姿态确定系统的非线性,因此采
用非线性渣波技术来估计卫星姿态的方法在工程上
的到了广泛的应用。扩展卡尔曼滤波器(EKF)具有
方法简单,容易实现等优点,在处理非线性估计问题
中被广泛应用;但是EKF是将非线性方程通过Tay-
lor展开做一阶近似处理,忽略其余高阶项,从而将
非线性问题转化为线性。当系统非线性较强时,
EKF违背局部线性假设,被忽略的高阶项会带来大
的误差,导致EKF算法精度下降,甚至造成EKF算
法的不稳定。另外EKF在线性化处理时需要计算
雅克比(Jacobian)矩阵,其繁琐的计算过程导致该
方法有时候难以实现“1。
为了解决上述问题,Julier等提出了一种新的非
线性滤波器一UKF。相对于EKF,UKF采用UT
变换对非线性概率密度分布进行近似,具有不需要
求导、实现简单、估计精度高等优点,被广泛应用姿
态估计问题“-。然而,UKF在数值计算中往往会
存在舍人误差,可能会破坏系统估计误差协方差矩
阵的非负定性和对称性,导致算法的收敛速度慢,甚
至造成算法的不稳定。文献[6]针对该问题提出了
一种平方根UKF(SRUKF)源波算法,该方法借鉴
kalman滤波中平方根分解滤波思愚,在滤波的过程
中采用矩阵的QR分解和Cholesky分解结果直接传
播并更新协方差矩阵的平方根,解决了UKF算法中
由计算误差可能引起的误差协方差负定问题,提高
了滤波算法的计算效率和数值稳定性,文献[7]将
该算法成功的应用到卫星姿态和角速度估计当中。
以上这些滤波方法都是针对精确模型进行应
用,在模型不准确或发生突变的情况下,EKF、UKF
和SRUKF都不具备较好估计精度、鲁棒性和跟踪能
力。针对这些问题,周东华等提出了强跟踪滤波器
(STF),STF具有较好关于模型不确定性的鲁棒性
和较强的关于突变状态的跟踪能力“1。文献[9]将
STF理论思想与UKF相结合,并成功的应用到天文
自主导航中,改善了系统的可靠性。然而,这两种方
法都与EKF类似,都存在对非线性系统的一阶近似
处理,仍然存在计算非线性函数的Jacobian矩阵等
缺点,这限制了该方法的应用。而且,UKF在数值
计算的过程中,由于舍人误差可能破坏误差协方差
矩阵的非负定性,影响UKF的收敛速度和稳定性。
为此,本文以卫星姿态确定系统为背景,提出了
一种基于改进的强跟踪平方根UKF的滤波算法。
在该方法中,推导了基于等价描述的强跟踪源波器
框架,采用UT变化方法计算自适应渐消因子,避免
Jacobian矩阵的计算。引人两个多重自适应渐消因
子矩阵,保证了误差协方差矩阵的对称性,并从理论
上证明其仍然满足正交原理。另外,为了避免数值
计算的过程中,随着迭代计算的累加,积累的舍人误
差可能会破坏系统估计误差协方差矩阵的非负定性
和对称性,从而导致算法的收敛速度慢,甚至造成算
法的不稳定的缺陷,采用协方差矩阵的平方根形式
进行递推滤波,通过分析标准平方根UKF存在的缺
陷,设计一种改进的平方根分解步骤,改善了滤波器
的稳定性。实验仿真结果表明,相对于STUKF和
SRUKF,本文提出的强跟踪平方根UKF具有更好的
稳定性.鲁棒性和对突变状态的跟踪能力。
1卫星姿态确定系统
1.1“系统状态方程
卫星姿态四元数被定义为“0
式 中 :0, =hsin(6/2) ;go = cos( 8/2) ; 和 0 分 别 为
单位旋转向量和旋转角。
四元数满足如下约柬:
多+如十多十一=1。(2)
用四元数表示的卫星运动学方程为
式中
在无陀螺测量角速度的情况下,为了估计卫星
的角速度,引人卫星姿态动力学方程
式中:w=[w:w,]为坐标系中卫星的三轴角
速度;J为系统的惯量矩阵;N(t)为外部控制力矩。
选 取 x = [ 9! 82 9s s o, w:] 「 为 系
统状态变量,则有非线性状态方程
(刃为过程瞿声。
1.2双向量法测量方程
双向量法是指利用安装在卫星中的加速度计得
到的重力向量和磁强计得到的地磁场向量在载体坐
标系中通过投影(映射)来计算卫星的姿态。文献
[12]给出了双向量法测量模型下的欧拉角计算:
式中:g为当地重力加速度;8,=[g8:8,2)为加
速度计测得的重力向量;H,=(H.,H,H.]3
磁强计测得的磁场强度向量。
选取欧拉角z=[p6]“作为测量输出,根
据欧拉角与四元数之间的关系,则得测量方程的映
射为:
式中:4=[g。a@9]是经过归一化得到的;u
为高斯测量噪生。
2“基于卫星姿态确定系统的STSRUKF
算法
2.1 UKF 算 法
将式(5)和式(7)组成的卫星姿态确定系统用
4阶龙格库塔法离散,得到如下非线性离散系统:
式中，-】(:/【=〔(′0,/c Qi Dp ap Our Wy w,.]"
为系统状态矢量,vu,为控制输人向量,z=
[er0:]「为测量矢量,wyMv,分别为状态系
统高斯白噪声和测量系统高斯白噪声,它们的协方
差分别为Q,和尸。
针对上述卫星姿态确定系统的UKF算法如
下0,在整个计算的过程中,四元数要按照式(9)
进行归一化计算。
1)初始化
x, =E[x,], (10)
2)计算Sigma点
咤 = [ 竖 竖 + /(n+A)(P); %-
3)时间更新
Evin = 兰 口 , ) , (13)
4)测量更新
雍/l二_l-l_′c4|′】='雍′:+__′鏖'4′′((z′霍`_〉】__乏/髻*】_′重)’(21)
'P′蘑`壤、l=′'′(耆懵-_】′霍_x′薰"'【′)z，′曹′′-】霾王+】。(22)
在上述计算过程中用到的权值和参数如下:
式中:A=az(n+k)-n为复合刻度参数;a是一个
比例因子,调节粒子的分布距离,一般取值0.001~
1;6是一个调节参数,一般取值为8=2;k是一个尺
度参数,一般取k=3-no。
2.2“强路踪UKF算法
在模型精确的情况下,UKF可以得到很高精度
的结果,但是卫星运行的实际空间环境是复杂多变
的,导致卫星模型的不确定性,同时,空间环境的噱
声统计特性也时常发生变化““1。这使得UKF的估
计精度下降,鲁棒性和跟踪能力变差。而强路踪
UKF在系统受到不确定干扰的情况下,仍具有较好
估计精度、鲁棒性和跟踪能力。
强跟踪UKF和UKF之间的区别在于将自适应
渐消因子人u引人到误差协方差矩阵,具体为:
自适应淀消因子的计算方法如下;
式中,!1是一个调节因子,p是一个遗忘因子,u.l=
diag(Ax+l,““.,Anzx1)〗是一个多重因子,文献[15]
表 明 引人多重自适应淅消因子的效果要优于单个自
造应渐消因子。
上述计算自适应渐消因子的过程中存在计算
Jacobian矩阵,而求解Jacobian矩阵有时候是非常复
杂和困难的。因此本文通过研究STF的等价描述,
给出了一种无需计算Jacobian矩阵的自适应渐消因
子的计算方法。
假设在未引人自适应渐消因子之前,误差的状
态预测协方差矩阵,互协方差预测矩阵和输出预测
协方差矩阵分别为;
Pi. =E[ (X44 =X au) (Xn -Zaw)"] =
′P′I`-】_′曹′,′誓_′麝′'「′髻+薹_′'+Q′髻'|′l，(34)
′`′萱【灞'′=+l =E[ (%441 =X) (Zia ~Zpn) =
E[ (X44 Epo) (H,,,(x;,, =
'董'′鑫蛐'l|′着〉〉1`二___'}三_二〈'蕙′'+l_，邃'′'+l|′′)_′夏.′′】二】二
′，麦=+l|′【′薹′′…"】+E[(x4.―Epi)Vier],(35)
′)乏"′I"′l=二!…′|二(z/曹`_-]_乏′麝`，'薹_′髻〉(z′重`警】-'乏′霍'}′l丨】喜)′I`二_二
″′惨(、】′,乡髻"'_′【矗`′′(:'羲、l'}_R′嬴'丨'】'二】(36)
BR(x,-立x)》和“正交,因此,式(35)
变为:
^′,三矗"′=+l=′】董【`~】丨′c矗′z`峰】o(37)
将式(34)变形,得:
矗`′鏖`′′__′髻′，′【_/髻′聂"′麝-'′】_′朦=矗，奏l;"′】_′髻__2/鑫-"l。(38)
假设Q.,,为正定阵,那么Pt.u和P的逆矩
阵一定存在,因此将式(36)变形得:
′,′′鏖^丨′】=′，萱丨:雾,′重('′]，I.(P袁髻`丨′__′鏖′薹`)-】("】(39)
将式(39)代人式(29)得:
Nia =Via -(P) Par Ge (Pi) “Pier Ry
(40)
将式(38)和式(39)代人式(30)得:
^′′曹气l__=.|二P乡霍-|′l_′c_堕′丨耆-'′】二_(′,妻【+l_′誓,丨`)BEPTE|ATR
(41)
从上述描述中可以看出,自适应渐消因子计算
按式(27)、(28),(40)、(41)和式(31)来进行计算,
有效的避免了Jacobian矩阵的计算。计算出自适应
谛董′字肖因二J′',`′后，耆安式(26)`董′_丨_算二′,′蘑'|'__′髻，并…睿彗PR
式(35)和(36)当中的P:,,,,得到P,,u.1和.4.。
2.3“强跟踪平方根UKF算法
在滤波的过程中,由于数值计算当中存在舍人
误差,随着计算过程当中舍人误差的累积,有可能破
坏滤波器的稳定性。因而,为了避免滤波器的发散,
一般采用平方根分解的形式进行滤波。标准的平方
根UKF其与UKF不同之处主要在于迭代计算的过
程中采用误差协方差矩阵的平方根进行迭代计算,
其分解形式如下1:
一步状态预测协方差矩阵的平方根分解:
Siri = cholupdate (SS, , Eo kvl ―X Wo) 。
(43)
输出协方差矩阵的平方根分解:
_sz'′c"I=(…}l(】l【】薹)(i】翼_二e(^S夏′′′`、_2X0,k+11kZak聆)。
(45)
状态协方差矩阵分解:
式中:6:为系统状态的Sigma采样点经过非线性函
数。)离散传播后的点集,之.为状态一步预测
Ex为乡经过非线性函数R(.)离散传播后的
BZ HH TRE
平方根UKF相对于UKF具有更好的鲁棒性、
稳定性及估计精度。在平方根UKF的分解过程中,
矩 阵 1S + OUU7} 的 Cholesky 分 解 是 用 cholupdate
{S,U,x0}1表示,它要求矩阵P+/OUU"UHR
半正定的。但是在标准的平方根UKF中,按式(43)
和式(45)更新抚方差矩阵,实际如下:
′s'/I+丨I/熹^s'霆+】|′r=′s'′′_+】_′′^誓/妻_`~′】`【|′=+
's′'′'+l^S工′="】=_s毫′′}】^s′亡′二_"$】十
sgn( Wp) A | Ws (Xo,b+118 -Z) “
园(′Y(),′′`!_】_′′_乏′【′卜】_′r〉′l`'.′'R′髻鳙-l()(49)
在高阶系统中,当系统噪声为高斯白噪声的时
候,为了狙得较好的估计精度,一般取n+A=3,因
此A是远小于零的。根据式(23)和(24)可知Wo2
负的,且|吴1冬含,这使得按式(43)和(45)更新的
矩阵很可能是负定的“1。
另外,在平方根UKF中,按照式(47)更新状态
误差协方差矩阵,实际如式(50)所示:
′，′【4′丨_疃~s′萝-丨-】_s′′壹"_'薹=′s′l"′丨_′矗′s趸"〉】_′髻一
K′'誓`丨-【_蜇z',/誓-丨′【(〖/灞-'-l_'Sz'′警-'′l)′】.，(50)
它要求等式右边必须是正定的,但是在数值计
算过程中,等式右边很容易因为舍人误差的累积而
破坏协方差矩阵的正定性。
针对上述问题,为了改善平方根UKF的稳定
性,吟时又能够保持平方根UKF的估计精度和鲁棒
性,对平方根UKF作如下改进。
1)采用改进的状态误差一步预测协方差矩阵
计算方法,文献[3]给出了一种改进的状态误差一
步预测协方差矩阵的计算方法,如下:
根据式(25)可知,所有的史都是正的,因此按
式(51)和式(52)计算的协方差矩阵P,,u和P.,u.u
至少是半正定的,针对式(51)和式(52)THERA
QR分解即可得到状态误差一步预测协方差矩阵和
输出协方差矩阵的平方根S:.u4和S..:,,如式(53)
和式(54)所述,从而避免因为呻而造成矩阵负
定的。
2)P,i的实际形式如式(55)所示:
′,′髻_.'l=薹,′髻`麝'】_′着_′)/霄鳙'】_′髻′′更-1>l(′:z'′矗'|′】′:′′置`丨′】_′【′鹭}重"1'】十
文献[17]给出了式(48)的平方根分解方法,具
体如下:〉
Siar =Siie = SiG. Sie (Seran +
式中:K,.,按式(39)计算,采用式(56)更新状态误
差协方差矩阵,避免了数值计算过程中因误差昼积
而破坏P:.,正定性的问题。
根据上述描述,改进的强路踪平方根分解UKF
追代计算迈程与改进的强路踪UKF的区别在于协
方差矩阵的更新计算过程中,是以协方差矩阵的平
方根进行迭代更新的。其具体步骤总结如下,在选
代的过程中四元数按照式(9)进行归一化:
1)初始化状态吊,状态误差协方差矩阵平方根
S, =chol(P,) ;
2)计算Sigma点采样;
3)按下式计算心,和St+;
白 x = 爪 血 , ) , (59)
4)利用立,和S:.i,x重新进行Sigma采样;
5)按下式计算x和Pon,FAH(S00
(^s牙=攫'l_′妻),!`)′f_婕替PZ'|'l_′矗，誓安下式_i"丨′`算′:H,,,[
Sie =h (X41), (63)
i = 区 4.((S5ux(Sfux)0) ) 。 (66)
6)下式计算自适应渐消因子矩阵;
Nir =Vi = IR, = (Sta) 8 “Prosar ,
M = ((Siau(Sia)?) =Q) (Sh) "Staw) 7 -
7)计算引人自适应渐消因子的华方差矩阵平
FRSion,并利用.和S;.进行Sigma点
采样;
8)按下式计算P,,:.ux和S..:.1;
Mer = 亢 (CYx+ ) (75)
2n+1
Pia=pW:(Viars一'邃′′【+】|′雇)('′′′I+l，童一Zin)
i=0
(76)
NFS. 401 (Sun) ) 代 替 P.,u,u,, 按 下 式 计
Bi, KH Sisto
竟′嬴+】=竟′霍`藿′__′噱__′K′【`丨'_(z′癫-、】_′_乏′蘑粤'l)，(78)
Sia =Sin - 8.146. Sie (S. ian +
采用改进的强跟踪平方根分解UKE可以增强
了UKF的鲁棒性和对突变状态的路踪能力,同时迦
改善了滤波器在数值计算过程中的稳定性。另外,
采用平方根分解可以提高数值计算过程中滤波器的
估计精度,缩减计算量。
3“仿真结果及分析
为了验证本文提出的算法的有效性,本文将
SRUKF,STF和STSRUKF算法对卫星姿态确定系统
(11)进行姿态和角速度估计,仿真环境为Matlab
R2010a软件平台。仿真参数设置为:
初始状态估计值吊=[10000.03
0.04 0.03]7;
初始误差方差矩
九 =20diag([10 以 103 10° 107°
107° 107° 107°]);
过程噪声方差矩阵
@ =20diag([10??* 10-3 10-8 “10 “8
1073 10% 10°%]);
初始测量噪声R=20diag([10“10-
10一])。
采样时间T,=1s;仿真时长!=500s。
为了比较三种算法和的鲁棒性和对窝变状态跟
踪性能,在仿真的过程中在200s的时候引人突变
状 态 量 Ar = [0 0 0 0 0.01 0.01 0.01]7,
在300~400s的时候引人模型不确定性。模型不确
定性为
Af(x,,u,) =0.005f(x,,u,), (82)
实验仿真结果如图1~图6所示,图1~图6分
别是x轴角方向的速度估计绝对误差、y轴方向的
角速度估计绝对误差、z轴方向的角速度估计绝对
误差、滚转角的估计绝对误差、俯仰角的估计绝对误
差和偏航角的估计绝对误差。
和外界干扰的时候,SRUKF、STF和ISTSRUKF的估
计精度差不多。当系统发生状态突变的时候,
SRUKF的估计结果很容易被影响,其估计精度是最
差的,而且收敛速度最慢。STF算法估计的姿态误
差和角速度误差精度在系统刚受到干扰的时候也会
变差,但没有SRUKF算法改变的那么大,而且相对
于SRUKF,STF能够很快的收敛,说明STF具有较
好的对突变状态的跟踪能力。而本文提出的
ISTSRUKF算法估计的角速度误差精度则几乎不受
状态突变量的影响,说明其对突变状态的跟踪能力
是最好的。另外,从图1~图6还可以看出,在模型
具有不确定性的时候,估计结果最差的是SRUKF,
其估计精度大大降低,滤波器不稳定,不具有匹配模
型不确定性的鲁棒性,其次是STF的估计结果,相
对于SRUKF来说,STF的估计结果变化较小,其估
计精度也较好,具有一定的能够匹配模型不确定性
的鲁棒性。而估计结果最好的是本文提出的
ISTSRUKF,其估计结果几乎把发生改变,说明具有
很好的能够克服模型不确定性的鲁棒性。
针对无陀螺卫星姿态和角速度估计问题,本文
提出了一种ISTSRUKF算法。该方法中,采用基于
等价变化的方法来计算自适应淅消因子,避免了Ja-
cobian矩阵的计算;引人两个多重自适应渐消因子
矩阵,保证了协方差矩阵的对称性;利用改进的平方
根分解方法,改善了滤波器的稳定性。数值仿真结
果表明,相对于SRUKF算法和STF算法,在卫星系
统模型具有不确定性和受到干扰的时候,ISTSRUKF
算法具有更好的鲁棒性、稳定性和对突变状态的路
陡能力。
