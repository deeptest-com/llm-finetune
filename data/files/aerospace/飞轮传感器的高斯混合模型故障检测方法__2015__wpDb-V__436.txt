飞轮传感器的高斯混合模型故障检测方法
针对闭环控制的飞轮系统，本文采用一种基于高斯混合模型（GMM）的故障诊断方法检测飞轮的传感器故障。姿态机动的反作用飞轮是一个多工况系统。通过飞轮的历史观测数据建立飞轮的GMM模型，它用有限个高斯函数的加权组合来有效地拟合多工况的观测数据，利用基于贝叶斯推理的后验概率（BIP）指标计算新样本偏离GMM模型的程度，该指标能避免由于数据分类不确定而引起的误检测问题。仿真结果表明BIP指标不需要复杂的数学建模就能准确检测飞轮传感器故障。

飞轮系统 高斯混合模型 故障检测 闭环控制  

0“引EB
对于小卫星平台,飞轮可以作为姿态大角度调
整的执行部件,实现对地和对日的指向模式切
换11。此外,侦察卫星的大角度机动一般是采用消
耗工质的推力器和反作用飞轮、地磁力矩和反作用
飞轮联合控制的方案“。姿态机动的反作用飞轮
是一个多工况的闭环控制系统,转速闭环控制的飞
轮系统能够提高任务的可靠性,但同时增加故障诊
断的难度“。航天器的早期故障或者未知故障检
Fault detection; Close-loop control
测由于经验知识缺乏,只能从系统的高维观测数据
中提取故障特征,观测数据向量由系统状态的物理
变量或者相应的演生变量构成,变量之间的关联关
系能够反映系统参数之间的相互作用。基于数据驱
动“的故障检测方法利用观测样本拟合状态变量
的函数关系或估计样本点集的概率分布,从而定义
系统行为。
对于卫星的飞轮系统,文献[8]是通过设计UIO
双观测器对存在未知输人的飞轮系统进行故障隔离,
文献[9]是采用非线性扩张的状态观测器对卫星飞转
进行故障检测和恢复。文献[10]将飞轮模型的参数
离散化并将模型参数当作状态空间的状态量,利用扩
展卡尔曼溏波器对飞轮的时变参数进行跟踪,实现系
统故障的定量估计。文献[111]采用综合观测器解决
了飞轮在执行器输出量不可得的限制条件下的故障
检测问题与执行器的真实输出估计问题。以上的故
障诊断方法需要精确的物理模型,模型参数的维数
低。对于高维度、强非线性的航天器系统,基于模型
故障诊断方法“的建模误差大或物理模型难以建
立。针对这类模型,基于数据驱动的故障诊断方法避
免物理建模,利用观测数据的统计指标或残差检测故
障,算法可移植性强,实时数据能反映性能退化过程。
主元模型““““利用样本的SPE值检测传感器
的故障,且系统的观测样本来自单一平稳的工况。而
多工况下的飞轮观测样本在高维空间中由多个密度
相对较大(峰值)的区域组成““1。主元模型对飞轮的
观测样本进行单高斯参数估计时偏差较大。因此,本
文采用一种高斯混合模型(CaussianMixedModel,
GMM)77对飞轮的观测样本进行高斯参数估计,按照
期望最大的EM算法估计每类峰值区域的高斯参数,
利用有限个(峰值个数)高斯函数的组合拟合飞轮的
观测样本,从而降低了高斯参数的估计误差,提高数
据拟合的精度,并结合BIP指标“检测飞轮传感器
的偏差故障。
1“动量轮模型
根据文献[19]给出的ITHACO-A型飞轮的数
学模型,建立基于Simulink的飞轮高精度开环系统
仿真模型,如图1所示。
相关参数介绍如下:V,为等效的直流电动机驱
动控制力矩,主要是电压控制;6,为电机驱动增益;
ws为驱动带宽;I,为电机电流;K为电机转动系
数;K.为电机电动势反馈系数;I为母线电流;
P为母线电压;R为输人电阻;K,为电压反馈增
益;7,为滑动摩擦力矩;r。为静摩擦力矩,也叫库伦
摩擦力矩;r,为控制力矩;J为飞轮转动惯量;0,为
力矩噪声引起的角误差;w。为高通噪声源波器频
Ro,为转速限制阙值;K,为转速限制增益系数;
为飞轮的实时转速。
1.1“动量轮开环系统的数学模型
根据图!的仿真模块,建立飞轮开环系统的状
AF:￠,(1,0)、yo(@)、ys(血)分别描述了电动
势力矩限制.轴承摩擦力与力矩干扰电机转速限制
这三个非线性模块。飞轮仿真模型的参数设置如表
1所示。
表 1 飞转参数
Table 1 The parameters of flywheel
参数取值/单位
J 0.0477 /(N-M: 57%)
G, 19/(A-V?h)
K, 0.9/(N-M-A"H)
K, 0.029/ (V s rad")
K, 95 /(V-s-rad?)
, 690 /(rad - s-1)
Te 0.002 /(N . M)
N 36
?, 0.2 /(rad + s?")
R;, 27 Q
K, 0.5
1.2“传感器故障的数学模型
传感器的工作原理、工作环境的不同导致其故
障的表现形式多种多样,但传感器的故障满足一定
的基本规律“““。常见的传感器故障有卡潜、恒增
益、恒偏差和完全失效四种模式,其数学模型为:
式中:u是常量,y是增益系数,8是偏移量。1和
都是表示采样时刻。x,<R*表示系统在第j时刻的
采样样本,g为传感器完全失效的采样时刻。4为数
据向量的维度。yMy,表示传感器的输出与输入。
本文针对飞轮传感器的恒偏差故障。
2“飞轮系统的数据建模与状态评估
与开环系统相比,闭环控制系统故障难以检测
主要有两个原因“1:1)闭环控制的引人使得飞轮系
统对于外部扰动具有鲁棒性,加性故障所引起的参
数扰动幅值比鲁棒控制引起的参数扰动幅值小。
2)闭环控制使得乘性故障在系统内部传播,导致多
处观测值发生异常,使得参数相互影响更强,系统参
数整体偏离正常(理想)工况。总之,飞轮故障改变
参数的关联关系,并改变样本的分布规律。因此,飞
轮的数据建模是租用系统参数之间的关联关系定义
飞轮系统行为。
多工况下的飞轮观测样本在高维空间中会形成
不同的族类(点集合)。而高斯混合模型对飞轮参
数进行参数拟合,适当增加CMM模型的族类个数
能够降低高斯参数的估计误差,提高GMM模型对
飞轮观测样本的拟合精度。飞轮系统的数据建模是
利用观测样本的统计量(均值、方差)估计观测样本
的分布函数;状态评估是利用统计指标定义新样本
与已知分布函数之间的距离,统计指标的阎值区分
健康样本与故障样本。
2.1“高斯混合模型与状态评估BIP指标
实际问题中的数据分布通常用高斯分布函数描
述,高斯混合模型GMMI21是一种能用有限的高斯
概率密度函数通过加权组合的方法遢近任意连续分
布的函数。飞轮观测样本点是一个4维度的数据向
量。xeRY是飞轮模型中的数据向量(某一时刻的
观测样本),它在高斯混合模型中的概率函数如下,
式中:K是高斯模GMM的族类的个数,8,=i,
El是第;个族类集合Ci的高斯参数,其中,i和
B分别表示第个族类的均值与协方差。丝
g(x|9)是第;个高斯概率密度函数,P(x|0)表示
每个点x在高斯参数9条件下的条件概率。w:表示
第;个族类的权重,可以理解为样本点来自第;个族
类(高斯分量)C的先验概率,且满足:
族类的高斯参数估计是建立GMM模型的关键
步骤,在给定训练样本与初始值的前提下,期望最大
算法(EM)通过不断重复E-step和M-step两个步
骤,直到对数似然函数不再变化才能完成高斯模型
的参数估计。
以上步骤是实现高斯混合模型的数据建模,通
过飞转的观测数据训练GMM模型,观测样本的分
布规律通过GMM模型表达;而新样本与GMM模型
的关系需要利用统计指标评价,即飞轮状态评估的
过程。为了计算新样本偏离混合高斯模型的程度,
本文需要引入一个BIP指标,将所有高斯聚类的局
部概率指标结合起来,由于每个观测样本无法被明
确地划分到某一个高斯族类,这种全局性指标能够
避免由于错误分类引起的误检测:
式中:x,RAF]个采样时刻的数据向量,
P(C:|x;,)表示x,属于第i个族类的条件概率,
Pu(x,)表示第;个族类的x;出现的概率。飞轮健康
状态下的观测样本到族类中心马氏距离D的平方
服从七方分布。
在给定置信水平(1-a)100%下,来自飞轮健
康状态下的数据向量x,满足如下关系式:
式中:BIP指标反映了数据向量与高斯混合模型之
间的距离,且第}个样本的BIP超出阎值为故障样
本。否则,它属于健康样本。
2.2主元模型的数据建模与状态评伦
主元模型对飞轮系统的观测样本进行矩阵分
解,利用样本协方差矩阵特征值的大小顺序可以将
样本矩阵分解为主元部分与残差部分。
式中:丁是标准化后的观测样本矩阵,7是得分矩
阵,P是投影矩阵,X,是主元矩阵,Xn是残差矩阵,
1是主元个数。主元个数选择依据累积方差的比例,
如式18所示:
式中:CPV为黜计方差贡献率,|为主元个数,i,j为
序列号,A为观测样本矩阵X的特征值。以上步骤
完成主元模型的数据建模,残差空间的点可以看作
噪声,服从高斯分布,《轮系统的状态评估是计算样
本的SPE值,它能反映样本残差向量偏离单高斯模
型的程度,利用数据向量SPE指标的阎值判断样本
残差向量是否仍服从高斯分布。
3“数值实例
姿态机动的反作用飞轮是一个多工况系统,针
对如图2所示系统,将飞轮的转速设置为一个正弦
信号与两个目标转速5rad/s与15rad/s的叠加信
号,模拟小卫星进行两次大角度指向调整的过程,并
抵抗空间干扰力矩的作用,同时设置了飞轮电机电
流传感器与飞轮转速传感器的恒偏差故障。
飞轮系统为一个速度反馈系统。主要包括飞轮
开环模型,PID控制器和数据采集系统三部分。
飞转转速控制器的PID参数设置:比例系数
0.1积分系数0.01,微分系数0.01。系统仿真过程
中,电机电流、飞轮转速的初始值取0,其它对应的
物理参数选取无故障时相应的取值。仿真系统的步
长0.1s,仿真时间为200s。系统仿真过程中,一共
转转速w电机输出力矩r.。这四个变量都与飞轮
转速有关。两类故障参数帷度为正常值的50%,
故障发生时间为健康运行100s后,即飞轮发生第
二次转速调整时。前者加信噪比为0.001的高斯白
噪声,后者加人信噪比为0.01的高斯白噪声。
3.1“高斯混合模型的族类个数选择
SPE指标的检测结果如图4与图8所示,阅值
置信度为95。噪声使得正常数据超出阙值的比
例为误检测率Pv;故障数据超出阎值的比例故障
检测率P。。误检测率越低,表明噪声对检测结果
的影响越小;而故障检测率越高,表明统计指标的故
障检测能力越强。
KN,为健康样本总数,Su为健康样本超出阎值
的个数。Ne为故障样本总数,Sr为故障样本超出
阎值的个数。BIP指标的阎值置信度为959%。增加
高斯混合模型的族类个数能够提高高斯混合模型对
飞轮数据拟合的精度,有利于提高BIP指标的故障
检测能力;然而BIP指标的故障检测能力由故障可
检测幅值决定,因此,BIP指标的故障检测率相对不
变时可以停止增加族类个数。
根据图3,当族类个数达到52时,电机电流的
BIP故障检测率取最大值87.5%。根据图4,当族
类个数达到52时,飞转转速的BIP故障检测率取最
大值91.23%。随着族类个数增加,两类故障检测
率的取值不断增加,当族类个数超过52时,故随检
测率又变小,BIP指标的故障检测率达到饱和,此时
BIP指标的故障检测率应为一常数。由于初始值的
随机性使得GMM模型的参数估计存在偏差,从而
使得BIP指标的故障检测率围绕常数波动。因此,
高斯混合模型的族类个数K=52。
故障检测能力由故障可检测幅值决定,而本文
为了对比BIP指标与SPF指标的故障检测能力。
只针对同一幅值的故障,利用误检测率与故障检测
率两个指标来定量评价两个模型的故障检测能力。
表 2 SPE与BIP的检测结果
Table 2 The detection result of SPE and BIP
故阮检测指标SPEBIP
电机电流传感命的误检率/%2.21.2
电机电流传感器的故障检测率/%69.986.1
飞转转速传感磐的误检率/%1.41.2
飞轮转速传感器的故障检测率/%19.688.4
根据表2,对比分析两类传感器偏差故障的误
检测率,SPE指标的误检测率要高于BIP指标的误
检测率,表明BIP指标对噪声的鲁棍性更好;而SPE
指标的故障检测率低于BIP指标的故障检测率,表
明BIP指标能够更加准确地检测飞轮多工况下的传
憨器偷差故障。因此,多工况中的高斯混合模型的
故障检测能力比主元模型的故障检测能力强。
采样数据总数为2000个点。图5显示飞轮电
机电流传感器的健康数据与故障数据的变化情况;
图 6 显示了飞轮转速传感器的健康数据与故障数据
的变化情况。其中,在100s到150s之间的剧烈波
动是由飞轮闭环控制所引起,这种正常状态的扰动
使得主元模型的统计挡标的阎值变大,导致主元模
型无法检测扰动幅值给小的故障。从图7与图8的
主元模型故障检测结果可以看出,由于飞轮转速的
鲁棒性扰动比飞轮电机电流的鲁棒性扰动大。因而
飞轮转速传感器的偏差故障检测率19.6%LKR
电机电流传感器的偏差故障检测率69.9%低很多。
图 9 与图10的BIP检测结果,电机电流传感器的偏
差故障与飞轮转速传感器的偏差故障在120s都未
超出阎值控制线。主要由于电机电流与转速在120s
的故障幅值都小于其健康幅值的扰动。而在160s
以后,电流、转速的鲁棒性扰动变小,故障状态下的
BIP值与健康状态下的BIP值的可区分性更好。
针对闭环控制的飞轮系统传感器偏差故障,本
文采用高斯混合模型对飞轮的观测数据进行数据建
模,并结合BIP指标检测两类传感器偏差故障。对
比两类统计指标SPE与BIP的幅值变化过程,鲁森
性扰动能够降低主元模型与高斯混合模型的故障检
针对多工况的飞轮系统,对比分析BIP指标与
SPE指标的误检测率与故障检测率,BIP指标的故
障检测能力比SPE指标的故障检测能力强。此外,
适当增加族类个数能够提高高斯混合模型的数据拟
合精度,净小高斯参数的估计偏差,使得BIP指标能
够更加准确地检测飞轮传感器偏差故障。故障检测
过程简单,快速。算法可移植性强,保证诊断的实时
性与通用性。文中给出的仿真实例说明了该方法的
有效性。
