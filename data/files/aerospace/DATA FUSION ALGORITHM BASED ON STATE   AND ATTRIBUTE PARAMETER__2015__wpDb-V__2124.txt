DATA FUSION ALGORITHM BASED ON STATE   AND ATTRIBUTE PARAMETER
Ａｑｕｅｓｔｉｏｎｔｈａｔｈａｓｂｅｅｎｃｏｎｃｅｒｎｅｄｆｏｒｍａｎｙｙｅａｒｓｉｎｔｈｅｍｕｌｔｉｔａｒｇｅｔｔｒａｃｋｉｎｇｆｉｅｌｄｉｓｈｏｗｔｏｒｅｄｕｃｅｔｈｅｃｏｍｐｕｔａｔｉｏｎａｌｃｏｍｐｌｅｘｉｔｙｏｆｄａｔａａｓｓｏｃｉａｔｉｏ...

DATA association D S EVIDENCE INFERENCE theory DATA FUSION  

科学可视化的目标是把由实验或数值计算
获得的大量数据转变成人的视觉可以感受到的
计算机图像[“1。通过可视化技术,将探测或计算
得到的火箭发动机喷流辐射场数据进行处理,得
到等值线,云图和等值面等计算机图像,可以对
火箭发动机喷流辑射场有直观、形象和全面的理
解。这对于导弹目标探测、识别研究和突防技术
研究等具有十分重要的意义。
可视化技术虽然发展时间较短,但是随着计
算机技术的迅速发展,可视化技术也发展迅速,
目前已经广泛应用于医学、地理、气象、航天、
军事等领域。等值线和云图是流场可视化的重要
方法,目前常用的等值线的绘制算法有网格追踪
法,网格序列法等,云图的填充算法有四叉树算
法,局部填充法等。
网格跟踪法是通过给定等值线的一个起始
点,计算求出该点相邻的下一个等值点,重复计
算直至等值线完成口。网格序列法是对网格进行
自上而下自左向右逐一提取,并寻找和处理该网
格内对应的等值点和线段,在处理完所有的网格
单元后,就自然生成了数据场的等值线分布吊。
但是网格追踪法算法复杂,通用性差,不易编程。
网格序列法存在等值线拓扑连接的二义性。
四叉树算法基本思想是基于网格无限细分,根
|据矩形网格顶点值以矩形颜色块来填充[4.
但是该算法要想获得光滑的云图边界,计算量太
大。局部多边形填充法的基本思想是(:在每个
小矩形中按照填充颜色的级别将网格矩形单元
分割为多个多边形,然后用相应的颜色进行填
充,在进行网格范围内的循环完成整个区域的填
充。但是该方法需要讨论多达12种情况,太过
繁琐,而且划分的多边形也不是最简多边形。
本文采用将网格的矩形单元划分为4个三角
形的方法,对网格序列法和局部多边形填充法进
行了改进,结合OpenGL实现了火箭发动机喷流
辐射场的等值线和云图的绘制,同时导入3DS
格式的火箭发动机三维模型,利用OpenGL的三
维显示技术与辐射云图结合进行3D显示。
1网格数据预处理
无论是等值线,云图还是等值面的绘制,首
先要对数据文件进行读取并对数据进行网格化
处理。例如栋火箭发动机40km高度的喷流辐射
场数据是由程序计算,并按照Tecplot软件的数
据格式进行输出得到,其具体文件格式如下:
TITLE-= 标 题
VARIABLES = "xX", “y?"Z", "ww"
ZONE F=POINT I=mx J=my K=mz
Xl Y1 Z1 VI
X2 YI Z1 V2
前3行为文件头,包含文件标题,数据变量
名称和儿DZ坐标的个数。第4行开始为数据
部分,第一列为土坐标,第二列为7坐标,第三
列为Z坐标,第四列为坐标点的数据值(如温度,
辐射亮度等)。
针对上述DAT格式的文件,首先设置结构
体读取文件头信息:
Typedef struct
CString TitleName;
Int m_x;
Int my;
Intm_z;
}FileTitle;
FlleTitle中包含了文件数据名称
(TitleName》和网格数据的行列层数
《CIm_X,tm_ ym 2) ;
读取了文件头后,就需要定义结构体对文件
数据进行存储和网格化:
typedef struct
float x;
float y;
float z;
float v;
}FileData;
结构体FileData中包含了网格点的坐标值(
切和辐射亮度(0)。
2“等值线绘制和云图的填充
21等值点的查找
对流场数据进行网格化后,整个流场数据就
是由一系列的矩形网格单元组成。如图1所示,
连接4个顶点和中心点,就可以将矩形网格划分
为4个三角形网格。
定 义 FileData a[m_x*m_y*m_z] 存 储 网 格 数
据,并保存数据中的最大值和最小值,通过等值
线的数目N来计算需要显示的等值线值序列,存
储于数组[N]中。定义FileDataMa存储矩形网
格单元中心点的数据。
4,网格中心点的坐标值及数值可以通过式(1)
插值求得:
0=(Afpltfy2+fy3+f4)/4 (1)
对于划分后的三角形,首先要进行等值点的
查找,通过式(2)可以由两个顶点值(.“1,/2)和等
值点的值户判断该边上是否有等值点:
(Al-f*Uy2-f<0 (2)
满足式(2)表示该边有等值点。假设等值点坐
标为(p.x,p.yp.z),两个顶点坐标分别为(p1.x,
pl.y, p1.Z2)、(p2.x, p2.y, p2.Z2), 则 利 用 式 (3)-(5) 进
行线性插值,得到等值点坐标,并保存。
在插值计算时,为了避免等值线从网格顶点
经过,即等值点与网格顶点重合的情况发生,可
以在插值计算前对网格顶点值与等值线值进行
比较,如果两者相等,则对网格顶点值进行微量
偏移。
2.2“颜色线性表
要实现填充云图,首先建立一张基于线性变
化的颜色查找表,建立颜色与物理量(标量)之
间线性的一一对应关系。
颜色的选定,影响到渭染效果,为了使系统
能够将数据的变化有层次的显示出来,所以颜色
表 定 义范围要足够大。人们的视觉感官上将颜
,色分为3个色调:冷色、中性色、暖色。其中冷
色包括蓝、青;中性色包括绿、紫;暖色包括红、
橱、黄『在RGB模式下,我们可以通过调节、
G.B分量的比重,来构成这些颜色[]。为了满
足层次鲜明的需要,颜色线性表包含3个色调,
颜色表从冷色到暖色线性分布。
颜色线性表的颜色各个分量(R,GB),AE
分布如图2所示。
其中,红色线条表示红色分量R的变化规
律,绿色线条表示绿色分量G的分布规律,蓝
色线条表示蓝色分量B的分布规律。R,G,B
的值都随对应物理量的变化而变化(从0到1D,
最大值到最小值线性划分为12个值域,对应从
红到蓝12种颜色。在进行云图填充时就可以按
照物理量所在的值域,从颜色线性表选取对应的
颜色进行填充。
EA E -
图 3 物理量一一颜色线性映射方法
2.3等值线的绘制
遍历整个网格,将矩形单元格逐一划分为4
个三角形,对三角形的三条边进行插值。等值线
从网格单元内经过,有一个进口就肯定有一个出
口,所以等值点的数只可能是偶数日,而且对于
三角形来说,一条等值线与其交点的个数只能为
0或2。所以插值得到三角形三条边上的等值点
坐标,将这两个等值点坐标连接起来就形成了三
角形内的一条等值线。按照f[N]中等值线值的
存储顺序,逐一插值就可以得到三角形内全部等
值线。具体算法如下:
13首先提取一个矩形单元格,将其分割为
4个三角形网格。
2)提取一个三角形网格,由式(2)判断3
条边上是否有等值线。如果没有,直接提取下一
个三角形。否则进行下一步。
3)从等值线值数值f[N]中提取一个值,
根据式(3)计算三角形三条边上的等值点坐标,然
后将其直接连接,并根据等值线的值从颜色线性
表 中 选取对应的颜色赋给该等值线。
4)从A[M]中提取下一个值重复步骤3,直
至所有的等值线都绘制完毕。
根据以上步骤可以绘制完成一个三角形内
的等值线,处理完4个三角形后就可以得到矩形
单元格内的等值线,遍历整个流场的所有网格后
就可以完成整个流场的等值线绘制。
2.4云图填充
对于每个三角形,按照其顶点标量值的大小
将顶点排序,最大值顶点为4,最小值顶点为CG
中间值顶点为8。如果有等值线经过,三角形内部
等值线的分布情况可分为3种情况,如图4所示。
(a) (D) ?
.图4三角网格内等值线分布情况
分别沿着4B8C和4C两条路径计算等值点坐
标,记录每条边上的等值点个数,假设48上有
ml个等值点,BC上有m2个等值点,因为每条
等值线在三角形内有一个进口,就有一个出口臣,
所以AC上等值点个数n就等于ml+m2.记ABC
路径上的等值点为PusPostsPyAC路径上
的等值点为Pzl,Poo..,Pzr。然后将三角形顺
点与等值点所构成的多边形按照顺序依次进行
填充,就可以得到三角形内的云图。具体算法步
骤如下:
1)首先提取一个矩形单元格,将其分割为
四个三角形网格。
2)提取一个三角形网格,对其3个顶点按
标量值的大小进行排序,由大到小为4,B,C。
3)根据顶点值进行判断三角形内是否有等
值线经过(即根据式(2)判断4C上是否存在等值
点),如果没有等值线经过,则根据顶点值的大
小,从颜色线性表中选取对应的颜色填充整个三
角形。否则进行下一步。
4)分别沿着48C和4C两条路径计算等值
点坐标,记录每条边上的等值点个数,假设48
上等值点数为w1,BC上等值点数为w2,4C上
等值点个数r-mw1l+m2。记ABC路径上的等值点
= |]
为了增强可视化软件的显示效果,需要将火
箭发动机的3D模型与其喷流辐射场的云图结合
显示,但是直接用OpenGL的图元绘制命令进行
APusPiesPyAC路径上的等值点为P
Py, , Pon。
5)根据1,m2的值判断等值线的分布情
况。如果2=0,即图4中(a)所示的情况,则依
茗夕_?义土真责E`^^多边芳邃二′多APPy;PyPyPP?tt
P,P,CB;如果m1=0,即图4中(b)所示的情况,
则依次填充多边形48PllPzl,PllPzlPa2Pla,“..,
PPC;如果ml,m2都不为零,即图4中(c)所
示的情况,则先依次填充多边形4PllPol,
PllPolPo2Pll,5PlPoC,然后填充三角形
B/′_)】′′!】z二,_′′′/]苛_l。
根据以上步骤处理完4个三角形网格后即得
到三角形内的云图,重复步骤2到步骤5即可完
成矩形单元格内的云图填充,然后遍历所有的单
元格就可以得到整个流场的云图。
2.5算法实现实例
在VC++6.0环境下,结合OpenGL,利用上
述将矩形网格三角化的方法编制的可视化软件,
实现的火箭发动机喷流辐射场的辐射亮度等值
线图和云图,如图5一图7所示。
RBmasoor i 一
图 5 辐射亮度等值线图
软件SolidWorks进行建模,然后利用软件Deep
Exploration将模型转化为3DS格式的文件,在
VC++6.0环境下编写程序读取3DS文件数据,再
利用OpenGL对模型进行绘制交互控制。
3.13DS文件的导入
3DS文件有许多块组成,至今为止,没有任
何一个官方文件完全说明3DS的文件格式,但是
我们可以忽略掉那些不管兴趣或未知的块,只在
程序中读入我们需要的块口,表1中列举了3DS
文件中一些主要的块。
表 1 3DS模型文件中几个主要的块ID及信息
块ID包含信息
OxAFFF“材质信息开始_OxA000材质名称
OxA300材质的纹理名称
Ox4110“对象中顶点信息
Ox4130“三角面材质信息
一般情况下,3DS文件中对象块、颜色块和
材质信息是最重要的,对三维模型的绘制起着决
定性的作用,我们在可视化程序中定义一个类
CLoad3DS来读入3DS文件,在这个类中,主要
有两个函数处理3DS文件::Load3DSO(THF
3DS文件,并根据块ID选择需要的块进行读取),
ObjCalcNormals0〈计算面和点的法向量)。
CLoad3DS类主要用来读取3DS文件中的数据信
息并计算面和点的法向量,将这些数据存储在自
己定义的数据结构中。这些数据可以直接用
OpenGL进行重绘。
CLoad3DS类中定义的数据模型源码如下;
/定义3D数据点:
struct verteX_type
float x,y,z;
] |
/定义面结构体(三角形)
struct polygon_type
int a,b,c;
IH
/定义纹理结构体
struct mapcoord type
float u,v;
/W定义模型信息结构体;
typedef struct
char name[20];/ 模 型 名 称
intvertices_qty;/模型中点的数量
intpolygonsqty;/模型中面的数目
vertex_type *vertex; / 模 型 中 的 顶 点
vertex_type *normal; / 顶 点 的 法 向 量
polygon_type *polygon; / 模 型 中 的 面
mapcoord_type *mapcoord; / 纹 理 坐 标
HID包含信息
Ox4000“模型中的对象
Ox4120“对象中的三角面
Ox4140纹理坐标
int id_texture; // 纹 理 数
matrix_4x4_type matrix;// 模 型 矩 阵
} obj type, *obj_type ptr;
32模型的重绘
读取了模型数据后,可以用OpenGL编写程
序对模型进行重绘。
首先利用OpenGL绘制基本图元的函数对模
型进行绘制,3DS模型是由一系列的三角面组成
的,根据模型结构体存储的顶点信息和对应的法
向量与纹理信息,利用GLTRIANGLES(三角
形图元模式》就可以将一系列的三角面绘制出
来,添加材质纹理,就可以绘制出3DS模型。模
城重绘的源码如下:
glBegin(GL_TRIANGLES);
for(j=0;j<object[i].polygons_gty;j++)
gINormal3f0; / 法 向 量
glTexCoord2f ( ); / 纹 理
glVertex3f ( 2; / 顶 点 坐 标
glEnd();
绘制完模型后,还要进行光照的设置,在
CView类的初始化函数中加入代码:
glEnable(GL LIGHTING);
glEnable(GL_LIGHTO)
来开启光照,在绘制模型的时候,OpenGLHH
以根据模型的材质纹理和表面各点法向量对模
型进行渲染,可以使模型具有3D的显示效果。
4“程序结果
在VC++6.0环境下,利用本文所述的算法,
结合OpenGL编写的可视化软件,绘制云图并导
A3DS模城,实现了火箭发动机模型与喷流辐射
场云图的结合显示,如图8所示。
门“心】
oom |
图 8 喷管模城与辐射场云图结合3D显示效果
为了更好的显示三维流场的辐射云图,在可
视化软件中添加绘制了一个可控制移动的圆形
径向截面云图和圆柱形的流场表面透视图,结合
3D火箭发动机喷管模型达到3D显示效果。
5&论
1,用将矩形网格分成4个三角形的方法,
对网格序列法和局部多边形填充法进行了改
进,基于三角网格进行等值线的绘制和填充,
实现了火箭发动机喷流辐射场的等值线和云图
的绘制。
2)针对3DS文件的格式,编写程序导入了
3DS格式的三维模型数据,利用OpenGL对模型
进行重绘,完成了火箭发动机喷管3D模型的导
No
3)液体火箭发动机喷流形成的激波处温度
较高,辐射亮度值也相应较大。如图5和图7所
示,云图能够清晰的显示出辐射场的激波,说明
利用本文所述算法得到的辐射场云图能够很好
的喷流辐射家度的分布规律。
