基于穿越点的多目标交会轨道设计方法
首先，针对空间非共面、多目标交会问题，提出了穿越点的概念及其计算方法；然后，利用曲线拟合的方法，提出了基于穿越点的多目标交会轨道设计方法，并建立了交会轨道优化设计数学模型；最后，以低轨道目标为例，进行了仿真分析，验证了该方法的有效性。

交会轨道 轨道设计 多目标交会 穿越点  

己上层的应用提供运行与开发环境,帮助系统开发者
灵活、高效地开发和集成应用软件“。
本文通过分析与研究网络驱动接口规范中间层驱
动程序框架结构,利用其在通信模型中的位置“,设计
了适用于AFDX网络的实时流量中间件接人模型,并
提出了相应的时间确定性保障算法。将该中间件安装
在普通以太网端,普通以太网端上的航空电子应用即
能在保证时间确定性的条件下与AFDX网络正常通
信。这为航空电子应用通信过程无差别地在AFDX网
络运行提供了解欧方案。
1“实时流量中间件接入模型
1.1网络驱动接口规范筒介
中间驱动程序是网络驱动接口规范(Network
Driver Interface Specification, NDIS) 所 支 持 的 3 种 网 络
驱动类型之一,它处于协议驱动程序与网卡驱动程序
之间,其在通信系统中的特殊位置使得从上层向网络
发送的数据包和从外界接收的数据包都须经过它之后
再继续传递,因而利用中间驱动程序可实现对网络数
据包过渡和协议转换,这也为AFDX网络实时流量中
间件的实现提供了可能。
1.2AFDX实时流量中间件接入模型
AFDX中间件接人模型包括配置文件解析模块、协
议转换模块与流量整形模块。配置文件解析模块通迈
对用户配置文件的解析,为中间件其他模块提供参数。
协议转换模块用于对数据恭实施AFDX皇议与
TCP/IP协议帧格式的相互转换。流量整形模块的功
能是对普通以太网下无序的数据流进行时间调度,在
单条链路上实现BAG整形,并在此基础上实施抖动最
小的多链路复合算法,保证进入到AFDX网络数据流
的时间确定性。AFDX中间件接人模型系统结构以及
2“协议帧格式转换
为实现基于TCP/IP协议的航电应用与AFDX网
络的透明通信,中间件模型需要对数据帧进行帧格式
转换。AFDX网络的控制机制使其寻址方式与TCP/IP
协议不同,同时其帧格式在数据域之后还存在顺序号
(SequenceNumber,SN)域。因此,协议转换模块须实
现数据帧报头字段的重组和SN插人。AFDX华议帧
寻址方式如图2所示。
21~1500字节,在AFDX中由于存在SN,总长度域(不
将SN考虑在内)的范围是21~1499字节。SN按数据
帧次序由0至255以步长1循环递增。同时,AFDX网
络为保护数据流,采用冗余的A/B网络来进行数据传
递,这意昧着一个数据帧及其备份会分别进人到A/B
网络,而它们拥有相同的SN。因此,在进行SN插入
时,应区分进人不同网络的数据帧对SN分开计数,以
记录数据帧的正确次序。
当数据帧在协议转换模块人口被截获后,中间件模
型将数据帧展开,将用户配置的检测信息与数据帧内容
进行匹配,对检测到需要处理的数据帧,实施由MAC头
至UDP头的重新填充,使其满足协议格式规范要求。
在中间驱动程序中传递的数据包以NDIS_PACK-
ET类型的结构体存在。NDIS_PACKET为包描述符,
一个数据包的包描述符指示了一系列以链表形式连接
的缓存描述符NDIS_BUFFER。每片缓存的虚拟地址
空间分别对庞数据包各昊实际占用的物理内存。
依照NDIS中数据包的存储方式,采取新建NDIS_
BUFFER连接在原包描述符未尾的方法实现SNFHA
实施SN插入的核心算法如下。
NewStatus NdisAllocateMemory(&butferVA) A 分 配 内 存
If NewStatus 一 NDIS_STATUS_SUCCESS
then
NewStatusB NdisAllocateBufferPool ( &NewStatusB , &PoolHandle)
if NewStatusB == NDIS_STATUS_SUCCESS
then
NewStatusC NdisAllocateBuffer( &NewStatusC ,&pAddButfer,&PoolH
-andle,&bufferVA)A分配缓存描述符,并与分配的内存映射
if NewStatusC == NDIS_STATUS_SUCCESS
then NdisChainBufferAtBack ( pAddButfer)
&将新增缓存揩述符连接至缓存描述符链表未尾
SNDomain
MmCetSysteraAddressForMdQISafe( Packet> Private. Tail)
If Partion_ID =0b000 then % ( SNDomain) ( SN_A ++)
else then * ( SNDomain) ( SN_B ++)
4检验A/B网络,分别进行顺序号循环计数
3“时间确定性调度分析
流量整形是AFDX网络确定性机制实施的根本保
障技术之一。通过对同一逻辑链路承载的前后相邻数
据帧之间的时间间隔进行限制和约束,降低和平滑了
VL上数据帧的窝发流量,保证了VL逻辑带宽预分配
机制,并增强了网络通信确定性。流量整形以单条VL
为基本单元,在每个BAG间隔中发送帧的数目不会多
于一个。对于多条VL上的数据流,在数据进人到接
收端前,需对它们进行有效调度,以保证对于给定的
VL数据帧能够在最大允许抖动内到达。
3.1“单条链路的BAG整形
在AFDX网络中,对于单条VL,数据帧没有抖动
时BAG反映了两个相邻帧的起始二进制位之间的最
小时间间隔。基于TCP/IP协议的航电应用通信所产
生的数据流,帧间间隔并不受约束。因此当航电应用
向AFDX网络发送数据时,数据流很可能无法满足
AFDX网络对帧间间隔的要求。BAG整形即是完成数
据流帧间间隔的调整。数据帧在经过中间件协议转换
处理后包含了链路号信息。根据链路号,可将单条数
据流上的数据帧划分至多条VL,然后对各VL实施
BAG调整。数据流实际的帧间间隔T与用户配置
的BAG值Tesa的大小关系是判别是否进行流量整形
的条件。由AFDX协议规范可知,只有Trussce<Taacu
的数据帧需要被处理。BAC整形核心算法通过内核
延迟实现数据帧延迟发送,使数据帧的帧间间隔增大
至Tasc,同时为保证流量整形的精确度,还对实际帧
间间隔实时监控,动态调整延时长度。
3.2多链路复合时间调度算法
经过BAG整形的各VL在进人到AFDX端系统之
前,需要复合成为单条多路复用流。由于各VL数据
抵达的时间不确定,因此在复合时,会出现对物理链路
的争抢,导致复合后的数据流规整度降低,进人到
AFDX网络的时间不确定性加大。为避免此种情况,
设计了实时流量抖动最小的VL复合时间调度算法
(Timing-Send,T-Send),中间件通过该算法来限定不同
VL数据流抵达物理链路的时间,分时利用物理链路,
从而实现VL的无冲突复合。
AFDX协议规范中规定T7ac=2.(单位为ms),i=
1~7。定义一组虚拟链路集合7ro~Lo,每个虚拟
链路集合VZa中包含J,条BAG相等的VL,不同虚拟
链路集合BAC不等。假定将虚拟链路集合按BAG大
小进行排列,将7的BAGHICHTp,=2。参数定
义:设物理带宽为C;集合VLu中最大数据恭长为Lo.u;
所有链路上的最大帧长,=max{Tous},=0,...,73
仪 J =maxiJ , =0,...,7; VLa-, 属 于 集 合 VTo , 丁 该
链路上首个消息的抵达时刻为VL,EFAVL的首个
消息抵达时刻中排在s位的时刻。m为最小BAG间隔
设定集合VLa上经过BAG整形的消息中,链路PLo_
首个数据包的振达时刻t=(2-1)T=AVL,
上首个数据包捡达时刻口=f+axoe22,00,
则这2,J,%&VL复合后的数据流依然能保证其各自帧
间间隔进行传递。
a上被规整后的消息中,首批数据包(一批数据包指
属于同一链路集合,但不同VL的一组数据包)抵达时
批数据包抵达的时间为
t 1 二 加 y 0 妮 5 一 7 Hi#j (2)
将式(1)代人式(2)可得
@…一l)锷骥+2…*U一‖刮2j一l)钨酗*U」U(3)
假设<i,令九=1!-1-27x(1-1)。则上式可
化简为
上式有
7为整数,故式(5)无解,因此通过上述调度能够
使BAG不等的VL复合后的数据流之间无冲突。
在集合7L。的一个BAG中,链路仪-,上首个数
据包抵达时刻t=1,+s*“因而该链路上的第A
个数据包到达的时间为
…=殉+s*垄罘+尤*『胍(6)
间样可得到链路VLa-,上的第5个数据包到达的
时间ts.v。假设存在数据冲突,则有
将式(6)代人式(7)可得
令%=s-s,队=尻-f,化简得
Tanc,与式(9)矛盾,所有式(9)无解,即对于BAG相等
的VL,复合后的数据流之间也无冲突,因此对任意虚
拟链路有T=0。
述分时抵达的方法对各VL进行调度。同时为了更充
分利用物理链路资源,可在最小的BAG内安排多于两
组虚拟链路集合。此时,各VL抵达物理链路的时刻
计算复杂度加大。
综上所述,如果限定不同VL上消息从中间件输出
的时刻点,那么这>,T条VL就能有效地利用物理链
路资源,实现无冲突复合,且复合后的消息流能按照各
自帧间间隔进行传输。
标凌的AFDX虚拟链路调度器以FIFO(FirstInput
FirstOutput)方式将数据包发送到物理链路上。利用
网络演算的方法可以计算在多条VL复合时利用FIFO
方式调度所产生的抖动延迟““)。对于一个有n条VL
的端系统,如果第;条虚拟链路的BAGHTyp,BK
数据帧长为7,,:,那么由其调度算法引起的该条VL上
的最大抖动为=五友Low。而本文提出的时间调
度模型,采取限定数据流抵达物理链路时刻的方式实
现了各条VL无冲突复合,使得在理论上有厂=0,从而
保证了进人到AFDX的网络流量比采用传统的FIFO
调度方式具有更高的时间确定性。
4“实验和结果分析
为评价AFDX中间件接人模型的性能,验证其协议
转换以及时间确定性保障功能,将AFDX中间件模型安
装在普通以太网卡终端进行了实验。实验系统由一台
普通以太网卡终端与一台航空电子交换式全双工以太
网卡终端组成,两个网络通迈网线互联进行消息发送。
为验证AFDX通信中间件协议转换功胎的正确
性,在配置文档中设定待处理源端口号为5,并填写其
他配置参数,例如,设定用户自定义标识为0xFF32、分
区标识为0b001等。在普通以太网卡终端分别以源端
口137以及5向AFDX网卡终端发送数据包,在AFDX
网卡终端抓包显示结果见图3。
Fig.3 Frame-parsing comparison between the
sender and receiver
由抓包结果来看,来自于用户配置源端口(端口5)
的UDP数据包被中间件处理,数据帧报头字段进行了
重填,并且含有正确的SN,帧格式符合AFDX协议规范。
对数据恭进行协议解析可知,经协议转换后,数据帧地
址格式中所含参数与用户配置参数一致。由此可见中
间件能够正确解析配置文件解析并进行协议转换。
为验证AFDX中间件的流量整形功能,设置参数
Teac.=128ms,普通以太网卡终端数据包发送工具选
择自动发送UDP包,时间间隔Tsoucw分别设置为50ms
与150ms。在收发两端同时进行抓包,对两种Topica
下选取4000ms内收发两端抓获的数据包时间间隔进
行统计,统计结果如图4所示。
知,当Tsuucw=50ms时,发送端数据流的帧间间隔在
50ms左右波动较大,接收端数据流规整有序,帧间间
隔 基 本 保 持 为 128 ms, JEM TF Tog, = 50 ms <
Tone.=128ms,中间件模型对数据流进行了流量整形。
当Teoscn=150ms时,发送端的数据流帝间间隔均处
于128ms以上,但在150ms左右波动较大。波动是由
于发送端通信源的时间不确实性造成的。由于帧间间
隔已符合BAG的要求,中间件模型识别出该数据流不
需BAG处理,所以在接收端,接收到的数据流帧间间
隔情况与发送端数据流基本无异。由此可知,中间件
模型不会增加数据流的不稳定性。在时间轴上观察统
计结果不难发现,以50ms为间隔发送数据包时,发送
端较为密集的数据流经过中间件的整形后变得缓和。
针对FIFO算法和T-Send算法引起各链路上的抖
动延时,采用Matlab进行了仿真实验。网络仿真共使用
了24条VL,总带宽设置为10Mb/s,并根据实际需要
将L:均设置为1518Bytes,包含的Tyo,FH1ms、2ms4
ms .8 ms. 16 ms 32 ms、64 ms.128 ms, LEGA Ty, (EXE
有3条虚拟链路。对于FIFO算法,无优先级。对于T-
Send算法,在计算由其引起的抖动延时时,将中间件模
型的处理时间考虑在内,中间件模型处理时间在100~
200us范围内波动。仿真结果统计如图5所示。
由图5可知,使用FIFO算法复合后,数据流的抖动
值比较大而且分布不均匀,均值为884ts,均方值为
357.1us,在同样条件下,使用T-Send算法复合后产生
的抖动的均值为162has,均方值为18.1hs。因此工
Send算法通过对各链路在时间上进行有效分配使数据
流复合引起的抖动时延远远小于FIFO算法,并下其抖
动值更加平稳。图中所显示的T-Send算法下抖动时延
为非0值,这是由于计算时包含了中间件模型处理数据
流的时间。综上所述,通过单链路上的BAC整形以及
多链路复合的T-Send算法,AFDX中间件接人模型能够
保证进入到AFDX网络数据包流的时间确定性。
图 5 多链路复司调度引起抖动时延结果图
Fig.5 Statistics of jitter caused by VL multiplex algorithm
5“结束语
本文在NDIS基础上,提出了适用于AFDX网络的
实时流量中间件接人模型,并针对多链路复合提出了
T-Send时间调度方法,成功实施了基于TCP/IP协议的
航空电子应用在AFDX网络上的确定性接人过程,已
有航空电子应用(第三方应用)不会感知在接人航空
电子全双工和普通以太网的不同,在网络的升级过程
中,最大化保护了已有开发资源,降低了网络接入难
度。而且,本文中提出的T-Send时间调度算法,结合
单条链路上的BAG整形,引起的抖动时延要远小于标
准的AFDX虚拟链路调度FIFO算法,使进人到AFDX
网络的数据流具有更好的时间确定性。
