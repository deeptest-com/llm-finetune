GNSS接收机在探月三期中的应用研究
探月工程对飞行器导航系统的性能提出了更高要求,因而有必要研究GNSS（Global Navigation Satellite System,全球导航卫星系统）接收机在探月任务中的应用。以探月工程三期为应用需求,开展地-月-地转移过程中的GNSS接收机可用性分析、GNSS信号特性分析;并针对低信噪比环境下的高灵敏度接收机系统应用进行设计,采用弱信号捕获算法和弱信号跟踪算法实现-175dBW的灵敏度;最终采用基于轨道动力学模型的卡尔曼滤波方法实现了GNSS自主定轨算法。仿真表明：GNSS接收机在60 000km以下的地-月转移和月-地转移弧段能够为探月飞行器提供100m以内位置精度的导航服务。

探月三期 全球导航卫星系统(GNSS) 高灵敏度接收机 自主定轨算法 卡尔曼滤波  

中图法分类号V249
Clearance of Flight Control Law
Based on Cultural Differential Evolution Algorithm
LI Ai-Jun', WANG Jing, LI Jia, WANG Chang-Qing!
"(School of Automation, Northwestern Polytechnical University, Xi'an 710072)
2( Shanghai Aircraft Design and Research Institute, COMAC, Shanghai 200235)
| ABSTRACT
Aiming at the slow converge rate in traditional cultural algorithm and lower use efficiency of
knowledge about evolutionary information in differential evolution algorithm ,a new cultural differential
evolution algorithm is proposed. The cultural algorithm is utilized as the framework of the proposed
algorithm, in which the evolution in population space consists of mutation, crossover and selection of the
differential evolution. In addition, the population space evolution is guided by the belief space
` knowledge. According to the flying quality specifications, a nonlinear criterion is presented. The
"proposed algorithm is then applied to evaluate angle of attack limit exceedance criterion, which is
current widely used in the aerospace industry. The full authority flight control law of the Aero-Data Model
in Research Environment ( ADMIRE) is evaluated with uncertainties by the proposed algorithm, which
overcomes the limitations of traditional grid-based ones. The simulation results validate that the reliability,
computational complexity and efficiency of the proposed algorithm outperform those of the modified
differential evolution algorithm, especially in searching for the worst uncertain parameter combinations for
the whole flight envelope. ,
Key Words Flight Control Law, Clearance, Cultural Algorithm, Differential Evolution, Angle of
Attack Limit
15言
现代飞机的性能和品质较大程度上取决于控制
律的设计.飞机本质上都具有较强的非线性特性而
控制器却经常是根据离散点线性化后的对象所设计
的.因此,要进行大量的分析与评估来验证所设计的
控制律满足飞行品质和安全性要求[1.传统控制律
评估方法主要分析随机参数变化对飞机操纵性与稳
定性的影响.该方法不能在飞行包线范围内进行评
估,主要通过划分网格的方式进行,但随着网格精度
的提高,评估时间呈指数上升“1.欧洲航空技术研
究组研究结果表明乙分析方法、V-gap分析方法、分
叉分析方法,基于多项式的分析和基于优化的方法
等控制律评估方法具有较好的应用前景.与其它方
法相比,基于优化的方法进行飞行控制律评估,对评
估准则没有任何限制,适用于任何可得到数学表达
的评估准则“1.
目前具有代表性的基于优化方法的飞行控制律
评估方法主要包括差分进化算法(Differential
Evolution, DE) 、 粒 子 群 算 法 (Particle Swarm Optimiz-
ation, PSO) 和 遗 传 算 法 (Cenetic Algorithm, GA)
等智能优化算法及其改进算法““.文献[1]对
DE、PSO、CA这3种基本型的算法进行性能比较,结
果表明,在飞行控制律评估过程中,从算法收敛和优
化效率来看,DE算法要好于PS0算法和GA算法.
但DE算法主要根据父代个体间的差分变异、交叉
和选择操作,不能有效利用进化过程中的知识,易出
现早熟收敛“1.为克服DE算法早熟的现象,需对基
本型DE算法进行改进.
本文对DE算法进行扩展,以文化算法(Cultural
Algorithm,CA)为框架,提出一种基于差分进化与模
式搜索的文化差分进化算法(CulturalDifferential
Evolution Algorithm, CDEA) , 使 用 DE 算 法 的 变 异 、
交叉、贪堆选拂算子来实现种群空间的进化操作,利
用CA算法信念空间的知识指导种群进化.然后以瑞
典 FOI 开 发 的 飞 机 模 型 ADMIREF( Aero Data Model In
ResearchEnvironment)为研究对象,选择迎角响应限
制准则,对ADMIRE进行飞行控制律评估.
2“基于差分进化和模式搜索的文
化差分进化算法
飞行控制律的评估问题可归结为一个带约束的
非线性优化问题,即
其中,八.)为由评估准则转换而来的适应度函数,
xl,so,“.%p为需要考虑的不确定性参数,xoms,xtmin
为第个参数变化的上下界.
2.1“文化差分进化算法
CA算法是一种新的进化模型,它提供一种明显|
的机制来提取、保存和整合种群进化过程中的知识
ZIT.CA算法采用种群空间和信念空间双层
进化结构来实现进化过程知识的有效提取,并利用
这些知识来引导种群空间进化.但CA算法种群进.
化过程中仅采用变异算子,导致进化后期收敛速度
较慢.CDEA算法借鉴CA算法的双层进化结构,将
DE算法揪人到文化算法的框架中,使用DE算法的
变异、交叉、贪基选择算子来实现种群空间的进化操
作,并利用信念空间中的形势知识.规范知识和历史
知识来指导种群进化.此外,为改善算法的局部搜索
能力还采用局部搜索性能较强的模式搜索对种群最
优解进行局部搜索,提高算法的寻优能力.
2.2“信念空间中知识的获取与更新
绅典文化算法将知识划分为形势知识规范知
识、约束知识和历史知识四类.本文信念空间主要使
用形势知识,规范知识和历史知识.
形势知识由每次迭代后从种群中选择出来的最
优个体组成,是其它个体进化的“榜样“.初始化形“
势知识时,取种群前个优秀个体.形势知识的数据
结 构 为 $ =4S1,S,,...,Sn) , 其 中 ,S;(i = 1,2,...,m) 结
Fah (x, 3X2 xp, f(%) 3X yt aXp)) , HH (S, Saye,
Sn)是根据仁,)的值从大到小排列.形势知识的更
新取决于每次迭代后新获取的最优个体xo,若f
小于当前列表中的最差个体S,的人.),则去掉S1,
并根据/值的大小将xu,fre插人到S中.
规范知识描述当前种群的搜索空间,引导个体
进人搜索区域,避免种群空间在最优解所在区域外
进行不必要的搜索,有利于提高算法的收敛速度.规
范知识搜索空间由最优个体集合S(即形势知识)来
决定,给出最优解最可能出现的范围.规范知识数据
结 构 为 VV(5) = (I, Ly, Uy) , 其 中 5 = 1,2,...,D, 变
量区|、百]/矗=〔Z/】，【」′′)二_二{x|1,XEU,x七R}J,3
示第0个参数变化的优胜区间,和x分别表示优
胜区间的下边界和上边界,,和D分别表示这两个
边界对应的适应度值.初始化时,和u设为参数变
化的边界值,对于最小化问题,L,和L设为+oo.在
进化过程中,这4个值会根据最优个体集合S所在
区间不断地变化.
本文选择种群每次迭代后获取的最优个体来重
新修正信念空间中的形势知识,然后根据最优个体
集合3更新规范知识.假设在第s次迭代时第i个个
体影响第个参数的下边界,第5个个体影响第8个
参数的上边界,则通过式(2)来曹新规范知识.
历史知识用以监控算法进化过程,判断是否进
行局部模式搜索及算法是否满足终止条件.如果在
进化过程中种群迭代一次后最优解未发生改变,则
令p=p+1.当p=3时,采用局部模式搜索提高算法
的寻优能力,模式搜索完后令p=0.模式搜索如果
搜索到更好的解,则令pt=0;如果最优解仍未发生
改变,则令pt=pt+1.当pt=5时,算法连续15次迭
代都未找到更优解,即认为已经找到全局最优解,则
终止迭代.
2.3“知识对种群空间的影响
文化算法如何利用信念空间中的知识来影响种
群空间的下一代生成较为重要.本文通过信念空间
的规范知识来影响种群空间差分进化变异算子,利
用历史知识判断是否进行局部搜索.xf为当前形
势知识里最优个体,对种群空间中的个体*f,在种群
中随机选择两个互不相同的个体x5af,(rg 1p 
5,并按式(3)产生变异个体xf的第)维分量:
为改善算法的局部搜索能力,通过历史知识判
定算法是否进行局部搜索.局部搜索以当前最优个
体为初始点通过探测移动和模式移动进行丨次局部
模式搜索““,若模式搜索过程中得到的个体优于原
先的最优个体,则对其进行取代,每次完成模式搜索
后缩短步长为原来的一半.7次模式搜索完毕后将
得到的最优个体和最优解u,f与随机选取当前
种群中的桅一个体及其解进行替换.
2.4“文化差分进化算法
step1“设置算法参数,如种群大小M,最大迭
代次数CGo,交叉概率Pc,缩放因子F,形势知识优
秀个体数,模式搜索次数7和模式搜索初始步长
St等.本文取
化 = 50,Pc = 0.9, = 0.2,m = 10, 了 = 10,
St =0.05 x (%,,, - i )-
在规定的不确定性参数空间内随机初始化种群.令
g=1,p=0,pt=0.
step2“根据适应度函数,对初始种群空间中
的个体进行评价.
step3“根据初始种群空间中的初始解和相关
参数的变化范围,初始化信念空间中的形势知识、规
范知识和历史知识.
step4“在信念空间规范知识的指导下,对种
群空间按式(3)进行差分变异操作.
step5“执行DE算法的交叉运算,新的试验个
体oxf的第b维分量生成规则如下:
Hr,rand为0与1之间的随机数,index为[1,D]内
的随机整数.|
step6“对每个子代个体进行适应度函数运
算,并按式(5)进行DE算法的贪婉选择;
step7“若p=3,则进行7次模式搜索,完成后
令p=0,并随机选择某一个体进行替换.
step8“更新信念空间的形势知识、规范知识
和历史知识.
step 9 “ 后 8 =g + 1, 若 8 一 Cos Hpt #5 则 跳
转至step4,否则结束运算,输出优化结果.
文献[10]中提出一种在DE算法中结合序列二
表 1 DE、HDE和CDEA算法对
Table 1 Optimization results of DE, HDE and CDEA algorithms for 3 standard test functions
测试函数TE标准差rr=标准差TRE标准差
Quadric 238.0333 66.0213
次规划法进行局部搜索的混合差分进化算法
(Hybrid Differential Evolution, HDE) , 该 政 进 DE
算法应用于飞行控制律评估效果要优于标准DF算
法.选取3个常用的标准测试函数对DE、HDE和
CDEA算法的优化性能进行测试比较.
1)Quadric 函 数 :
该函数的全局最优点是(0,0,...,0),最优值为0.
2) Rastrigrin 函 数 ;
。D
该函数的全局最优点是(0,0,...,0),最优值为0.
3 Griewank 函 数 :
该函数的全局最优点是(0,0,...,0),最优值为0.
在进行算法测试时,设定所有测试函数的维数
为D=20,最大迪代次数为Cox=300.
对于每个测试函数,分别使用DEHDE和
CDEA运行50次,得到的关于最优函数值和标准差
的平均结果如表1所示.图2比较3个算法关于各测
试函数的收敛曲线-
从表1可看出,CDEA算法的平均最优值和标准
差均优于其它两个算法,显示CDEA算法较强的搜
索能力和良好的鲁棒性.因此,可运用CDEA算法对
飞行控制律进行评估.
3个标准测试函数进行优化的结果
0.1119 0.1031 9.21e - 57 3.11e - 55
3.22e - 09 8.8le - 09 0 0
0 0 0 0
3“飞机模型与评估准则
3.1“飞机模型′
评估中采用基于瑞典Saab公司真实的JAS39
飞机发展而来的研究用空气动力数据模型
ADMIRE".ADMIRE是一种三角鸭翼布局的战斗
机模型,其全包线非线性标称仿真模型是六自由度
的Matlab/Simulink模型.ADMIRE中基于极点配置
方法设计飞行控制系统.在规定的界限范围内,可根
据要求设置该模型飞机及飞行控制系统的不确定性
参数,包含愧性不确定性参数、气动不确定性参数、
作动器和传感器引起的不确定性参数等.由于篇幅
有限,以飞机的纵向运动为例,只考虑飞机模型中纵
向不确定性参数变化,变化范围如表2所示,横航向
的研究类似.根据当前工业实践,考虑气动不确定性
参数的耦合,4CmsACm,的变化范围需要乘以一
个衰减系数K=0.62L01.,
%2ADMIRE不确定性参数0
Table 2 ADMIRE uncertainty parameters’ ?"’
HEmum说明
Amass [-0.1,0.1] 飞 机 质 量 误 差 (% )
Ax, [-0.075,0.075] 震 定 裂 林的
AL, [-0.1,0.1] Hy Yan
ACm, ~~ [-0.05,0.05] Cms 的 误 差 (1/radq)
ACm,  [-0.05,0.05] Cm, 的 误 差 (1/rad)
3.2“评估准则
根据飞行品质规范选取工程实践中具有代表性
的准则进行控制律评估.迎角响应限制准则““是一
种非线性时域分析准则,用于检验飞机响应是否超
出迎角限制边界.评估过程中采用的是ADMIRE非
线性模型,其中控制器部分也存在大量非线性环节,
闭环系统输人到输出的映射必然具有较强的非线
性.利用优化算法对迎角响应限制准则进行评估,具
体做法是在给定的飞行状态,考虑不确定参数在规
定的变化范围内摄动,给定操纵杆阶跃满杆指令输
人控制飞机,寻找迎角响应的最大值.因此定义适应
度函数为
如果最坏情况下最大迎角未超过限制值,则控
制律得以通过,否则,控制律需进一步优化设计.
4_飞行控制律全包线非线性评估
分析
4.1“全包线范围评估
当前工程上传统评估方法是建立线性分析模
型,在选定的包线网格点上,分析不确定性参数变化
对飞机稳定性和操纵性的影响,该方法不能在飞行
包线范围内进行连续评估.ADMIRE飞行包线如
图 3 所示,图中“*“表示29个控制器设计状态点,
其它各状态的控制律札用动压调参.由于控制律是
在特定的飞行状态点设计的,工程上品质评定时也
只是在选定的离散网格点上进行,不能保证整个飞
行包线都能具有满意的飞行品质,对整个飞行包线进
行连续评估是为了发现飞行包线内可能存在的危险
RE由于飞行包线跨度较大,直接考虑整个包线较
为困难,研究时可将飞行包线适当划分.本文取有代
表 性 的“子包线“进行评估,其它包线区域评估类似.
线范围内进行连续域评估.将高度、马赫数也作为不
确定性参数在选定的包线范围内摄动,其它各个参_
数在表2中规定的范围内摄动.通过搜索找到最坏
飞行状态,当最坏飞行状态满足准则时,评估通过.
但当最坏飞行状态不满足准则时,不能说明整个包
线都不满足准则,可对包线进一步组化,给出更具体
的评估结果.利用CDEA算法可在ADMIRE整个飞
行包线内进行控制律的非线性评估分析.
4.2“非线性评估分析
选取高度为1000m~4000m,马赫数为0.4~0.5
的飞行包线进行研究,将高度、马赫数与其它5个不
确定性参数同时摄动.根据迎角响应限制准则,《机
配平后给定80N的阶跋满杆操纵杆指令控制飞机,
仿真时间为10s,然后记录动态过程中迎角时域响
应达到的最大值.此飞行包线区域ADMIRE的迎角
限帘1`丨为_l()o′`′90(】〔]l],
由于评估过程中影响评估时间的主要因素是每
次计算适应度值时配平和Simulink仿真的时间,所
以以寻找到最坏飞行状态时计算适应度值的次数来
评价算法的效率.为了更直观深人地对CDEA算法
在评估过程的效率进行验证说明,将CDEA算法和
HDE算法非线性评估优化性能进行对比.同时,为
说明算法的可靠性,每种算法都独立进行12次评
估.最大迭代次数为Co,=50,CDEA算法12次评估
优化性能如图4所示,算法每次都能收敛到一个全
局最优解.评估结果数据统计如表3所示,搜索到最
坏飞行状态,迭代次数最少为22次,最多为41次,平
均为31.33次.CDEA算法在评估过程中经过全局搜
索和局部搜索找到最坏飞行状态计算适应度值平均
为1873次.文献[10]中提出的HDE算法独立进行
12次的评估优化性能如图5所示,算法每次在规定
的迭代次数内并没有完全收敛,搜索到的最大迎角
为74.12“.从图4、图5包线评估优化性能比较中可
看出,HDE算法收敛速度明显比CDEA算法慢,昆
可靠性也不如CDEA算法.因此,与HDE算法相比,
CDEA算法在全飞行包线范围内找出最坏的不确定
参数组合,具有更高的可靠性和效率.
分析表3数据可看到,最坏不确定性参数组合
中4Cmss,4Cmu的平均值并不是在边界位置.为进
一步分析,选择12次评估中迎角最大的一组最坏不
确定性参数组合,让参数组合中的某一个参数单独
在取化范围内逐步变化,分析每个参数单独变化对
迎角的影响.为方便观察,将表2中的不确定性参数
在x轴都进行归一化处理,时域响应中对应的最大
迎角如图6所示.-
表 3 CDEA评估结果数据统计
Table 3 Data statistics of CDEA clearance results
,参数最大值最小值平均值“标准差
马 赫 数 0.4522 0.4457 0.4482 0.0024
高 度 /m 3056.4 2904.8 2983.2 48. 5736
Amass 0.1 0.0982 0.0997 5.2013e - 4
Ax, 0.075 0.0596 0.0718 0. 0085
ACm, 0.019 - 0.0263 - 0. 0093 0.0148
ACm,, 0.0302 - 0.0088 0.0106 0.0143
Ama)” 74.2883 74.1411 74.2363 0.048
“ 迭 代 次 数 41 22 31.33 5.3485
仿 真 次 数 2327 1353 1873 279.89
(a)AmassAx,,、ACm。单独变化
(a) Separate variation of Amass Ax, ACm,
图 6 “不确定性参数单独变化对迎角的影响
Fig.6 Influence of plots with uncertain parameters for angle
of attack
从图6可看出,4Cm,在-0.0075~-0.016时
迎角最大,4Cm在变化过程中存在较多局部极值,
在0.015~0.03时,迎角最大.这样就可解释为什么
12次独立评估芥不是每次都收敛到吟一个最大迎
角值,而是收敛到一个较小的区间.
5“结束语
CDEA算法充分利用DE算法和CA算法的优
点,克服了DE算法早熟收敛问题,在收敛速度和精
度上相比DE算法和HDE算法有较大提高,同时又
具有良好的鲁棒性.基于CDEA算法进行飞行控制
律评估克服了当前工程只能研究离散状态点的不
足,其应用不依赖于准则的形式和要求,可广泛用于
各种时域和频域准则的评估,使用方便,日可实现连
续飞行包线的控制律评估,比当前工业界应用的网
格法更可靠.仿真结果表明,CDEFA算法在考虑参数
不确定性情况下对包线范围内的控制律进行评估,
相比HDE算法具有更高的可靠性和效率.
