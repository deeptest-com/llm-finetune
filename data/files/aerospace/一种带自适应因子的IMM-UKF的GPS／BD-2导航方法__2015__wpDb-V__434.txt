一种带自适应因子的IMM-UKF的GPS／BD-2导航方法
针对GPS／北斗-2（BD-2）卫星导航系统中机动载体运动模型和噪声统计特性不确定性导致滤波精度低的问题，为提高导航定位的精确性和稳定性，提出一种自适应的滤波方法。首先，提出了一种新的自适应UKF（AUKF）算法，该方法将残差序列的协方差矩阵视为过程噪声协方差矩阵的不确定量，基于此采用平滑滤波的方法设计自适应因子，并利用该自适应因子实时调整过程噪声协方差矩阵，减弱了噪声统计特性不确定性对滤波精度的影响；其次，采用交互式多模型（IMM）算法设置模型集M，并通过实时调整模型概率来实现各个模型间的软切换，解决了单一模型对载体运动状态描述不全面而导致滤波精度低的问题。仿真结果证明该算法能有效提高载体在复杂机动状态下的定位精度。

自适应 无迹卡尔曼滤波 交互式多模型 模型不确定 噪声统计特性不确定性 卫星导航系统  

0“引言
全球导航卫星系统(CNSS)是指美国的GPS系
统、中国的北斗系统、俄罗斯的GLONASS系统和欧
BHGALILEO系统。传统的单星座导航系统易受
所有者权限限制,可靠性不能得到保证;其次,可见
卫星的数量受环境影响较大,在恶劣环境下可见卫
星数量较少,导致定位精度较低,甚至定位失败。把
GNSS的两个或多个星座组合,可极大地增加可见
卫星的数量,提高卫星导航系统的可靠性,改善系统
定位精度1。
接收机定位算法是影响卫星导航系统定位
精度的关键因素之一。扩展卡尔曼源波(EKF)
和无迹卡尔曼滤波(UKF)是在卫星导航系统中
应用较多的两种滤波算法。其中UKF以其估计
精度较高,无须计算雅克比矩阵等优点得到了更
为广泛的应用“1。但EKF、UKF都需要建立精确
的系统模型,要求系统噪声的统计特性已知。对
于复杂的机动载体,这些条件都难以满足。针对
EKF、UKF在滤波性能方面的不足,学者们提出
了自适应滤波方法。目前主要的自适应算法有
噪声方差匹配法和模型匹配法。(1)噱声方差匹
配法一般采用实时调整噪声方差矩阵的方法来
提高估计精度,其典型代表为Sage-HusaBEM
滤波方法。Sage-Husa自适应算法原理简单,实
时性好,但对初值数感,易引起滤波发散““1;Halil
等提出一种Q阵自适应算法“!,当估计精确时Q
阵保持不变,当估计发生偏离时,肉测量残差重
新确定Q阵的值。该算法能提高系统的估计精
度,但需要计算雅克比矩阵。而且该算法完全依
靠测量残差确定噪声协方差矩阵,稳定性差。
(2)模型匹配法主要采用IMM算法来实现系统
运动状态与模型的匹配。文献[5-7]将IMM算
法应用于组合导航,有效地提高了定位精度。但
该算法只针对系统模型不确定性提出解决方法,
没有解决系统噪声统计特性不确定的问题;文献
[8]采用IMM算法融合Sage-Husa自适应源波器
别强跟踪滤波器的优点,提高了系统在模型不确
定条件下估计的精确性和稳定性,但该算法需要
计算雅克比矩阵。
针对GPS/BD-2卫星导航系统中复杂机动载体
运动模型和噪声统计特性不确定导致源波精度低的
问题,本文提出了一种新的自适应算法,从两个方面
改善了源波精度。首先,提出了一种新的实时调整
过程噪声协方差矩阵的自适应UKF算法,提高系统
在噪声统计特性不确定条件下的定位精度。其次,
采用IMM算法实现复杂机动载体系统模型与运动
状态的匹配,提高系统模型不确定条件下的定位
精度。
1_CPS/BD-2卫星导航系统滤波模型的建立
1.1“系统状态方程的建立
选取GPS/BD-2卫星导航系统的状态变量为
X=[x % % y y 5 z 7 5 8° 8 &
5]“,分别代表载体在WGS-84坐标下x,7z,Z1
坐标轴上的位置、速度、加速度、.GPS接收机钟差钟
差变化率、BD-2接收机钟差、钟差变化率。为提高
系统在模型不确定条件下的定位精度,建立模型集
X,包括描述载体运动状态的“当前“统计模型
(CS),常加速模型(CA)和常速率华同转弛模型
(CT),下面以载体在X轴上的运动状态为例,分别
建立载体的CS、CA、CT运动模型的状态方程。
cS模型““1
CA HERI,
CT HER",
将式(1)、(2)、(3)离散化可分别得到CS、CA、
CT模型的离散状态方程,为方便描述算法,统一表
示离散方程为;
式中:x:=[x;5“六]“。载体在7轴与Z轴上
的运动状态与X,轴上相同,即@,=D,=&,
GPS,BD-2接收机的钟差变化率均采用一阶马
尔科夫过程描述““!。建立GPS钟差的状态方程为:
离散化得
式中:8=[68诈]。BD-2接收机钟差模型与
GPS钟差模型相同,即@,,=雨,。
建立离散系统的状态方程为:
式中:卯=diag(D,,0,,0,,0,,P,,)为系统的状
态转移矩阵。Q:-,=Elw,wv,|为过程噪声华方
差矩阵(〕
1.2“系统观测方程
为充分利用不同星座的定位信息,本文采用
CPS/BD-2伪距组合的方式。卫星伪距定位方程
为:
式中:py表示时刻观测到的卫星的伪跋,xt,六,
表 示 卫星在WGS-84坂标系下的三维位置。x:,Yy,z
为f时刻待求接收机的三维位置,on为接收机钟
Foe,为*时刻卫星的观测误差。假设*时刻观测
到N颗CPS和BD-2卫星,则建立CPS/BD-2卫星
导航系统的观测方程为:
式中:-)′/[=[peso]”,石:=_二1多`′玉，"'，(e`多c、/二_1`，′〕冤=和
gri=1,2,...,N分别为观测到的第i颗卫星在〖
时刻的伪距和测量误差,R,=E1exve:}为观测噪声
协方差矩阵。
2“带自适应因子的IMM-AUKF算法
2.1“基于自适应因子东的AUKF算法
式(7)和式(9)给出了GPS/BD2组合卫星导
航的系统方程,然而在实际系统中通常无法准确获
取系统的过程噪声。为提高系统模型中过程噪声的
准确性,增加过程噪声的自适应因子东-,,将系统
方程调整为“:
式中:亟-:<R““是系统在5-1时刻过程噪声的
自适应因子,n为系统维数,在GPS/BD-2组合导航
系统中n=13。由于过程噪声短阵中起主要作用
的为对角线元素,因此设计自适应因子为对角矩阵,
即 亟 -,= diag(pu_i(1) ,Pa-1(2 ) , ,Pi-1(R) ?
带自适应因子东的AUKF算法主要分为两大
部分,分别是UKF滤波和自适应因子更新:
(1) UKF 滤 波
UKF的主要怡路在于采用确定性采样的方法
产生一组sigma点来近似非线性函数的概率分布。
选取的sigma点要能体现真实状态的均值和方差。
对于方程(10)描述的n维系统,可采用式(11)产生
2n+1个sigma点及其权系数。
其权系数为
式中:丽,和P:-u分别表示系统在K-1时刻的估计
值和估计误差协方差矩阵。A=a“(n+k)-n,式
中;aREsigma点的散布程度,10““一a<一1,k通
常取为0。(y(n+A)Px-1)i表示矩阵平方根的第i
列(或第5行),为增加数值的稳定性,TRA
Cholesky分解获得。6用来描述丁的分布信息,在高
斯情况下,6的最优值为2。
在获得2n+1个sigma点后,UKF可分为两大
步,即状态估计和状态更新。
第一步:状态估计
为一步预测误差协方差矩阵,3,为观测估计值。
第二步:状态校正
K, = PP (19)
列是反映滤波性能的重耐参数,其值越小,表示估计
越精确。因此可利用残差序列作为反馈量来实时调
整过程噪声协方差矩阵。
(2)自适应因子亚的确定
在源波算法中,源波增益决定了滤波器的带宽
和反应速度,同时决定了新息在状态估计中的权重。
当载体不机动时,较小的滤波增益可降低新息在状
态估计中的权重,降低估计噪声;当载体机动时,需
要有较大的滤波增益来提高新息在状态估计中的权
重,进而跟踪载体的机动。自适应UKF的思想即通
过实时改变过程噪声来调整系统的带宽和响应速
度。
基于上述思想,文献[13]设计了如下平滑溏波
器来获取自适应因子:
式中:0,(i)为中间变量,￠,(i)为自适应因子于
的对角线元素,厂(.)表示将向量从测量空间转换
到状态空间的转换函数,A,和A,为平滑滤波系数,
Qu(i,i)为Q,矩阵第;阶对角线上的值。上述方法
直接札用残差序列作为反馈量导致算法的稳定性较
差,这将在仿真实验中得到校验;同时需要采用无迹
变换将向量从测量空间转换到状态空间,计算繁琐。
基于此,本节在文献[13]的基础上,提出如下自造
应因子的确定方法。
在UKF中,滤波稳定时残差序列服从y:~
VW(0,P,,)分布,即有Elz:1=P,““。当载体估
计误差较大时,残差序列不再服从以上分布,残差序
列的协方差矩阵迅途增加导致E1zxz71>P,04。
BA,=E[vuor|-P,,万假设系统初值和模型精
确,则A,是由于噪声统计特性不准确产生的误差的
协方差矩阵。因此可将4:作为校正量实时调整过
程噪声协方差矩阵Q。
事实上,在估计过程中,由于初值、模型、噪声,
输人等因素的不确定性,估计结果不能完全精确,残
差序列协方差矩阵与P,,是近似相等的关系,无法
保证在估计精确时4,为0。为避免不必要的校正,
设计门限参数0,>0,当trace(4,)<0时假设
偏差在允许范围内,无须校正;当trace(4,)>0时
说明估计偏离程度较大,需要在线调整过程噪声协
方差矩阵,式中trace(“)为求矩阵的迹。
为保证算法的稳定性,需要协调当前时刻的过
程噪声协方差矩阵与误差新息之间的关系,以防止
无效的观测值导致Q,阵突变,造成滤波发散。因此
在文献[13]的基础上设计如下平滑滩波器:
1 -
式中:0,(i)为中间变量,ps()为自适应因子史
的对角线元素,;=1,2,...,4。当测量残差小于门
限参数时,假设估计精确,下一时刻的过程噪声保持
不变。A,、^Au为平滑参数,为保证上述平滢滤波命
稳定,应满足0<A<1,A+24,=1。Au越大系
统的稳态估计性能越好,但对机动的跟踪能力越差;
反之A越大,系统对机动的跟踪能力越强,但稳态
估计性能越差。门限参数的取值越小,系统对机
动的跟踪能力越强,但稳态估计性能差且算法计算
量增加;?取值越大,稳态估计性能越好丁算法计算
量小,但对机动的跟踪能力变差。关于参数A,
和I对系统性能的影响以及其对系统的影响将在仿
真结果中得到校验。
将残差序列的协方差矩阵Elo设为F:,
V,通常不易计算,可以采用文献[15]提出的方法通
过式(26)来估计。
式中:p为遗忘因子,0<p一1。
这一自适应过程通过调整过程噪声协方差
矩阵来快速地政变源波增益,使滤波算法能够迅
速地跟踪载体的机动,净小估计误差。对于模型
精确的系统,上述自适应UKF能达到满意的源波
精度。但对于复杂的机动载体,通常难以建立一
种能准确描述载体运动状态的模型,导致算法定
位精度较低。下面采用IMM算法来处理系统中
模型不确定的问题。
2.2“交互式多模型AUKF算法
IMM算法的基本思想是通过多个模型来匹配
载体的运动状态““。一个完整的IMM算法包括四
步,即模型交互混合,模型滤波,模型概率更新和信
息融合。对于第1节已绅建立的模型集M,若分别
用数字L、2、3代表CS、CA和CT模型,则IMM-
AUKF的具体描述为:
(1)状态交互混合得到各模型在5时刻的源波
初值。
值和估计误差协方差矩阵,i=1,2,3,u,),,,为模
型混合概率,〗=1,2,3,u*-为模型概率,c为归一
化常数,=井Tyxi_,,T7y为模型转移概率,一般
由先验知识获得。
(2)对每个模型进行自适应UKF滤波,获得每
个模型在时刻的滤波值怨和相应的估计误差协
方差矩阵P。
(3)计算各模型在时刻的模型概率以。
式中:A,为5时刻模型}的似然丽数,由式(32)计
算,det(,)表示求(,)的行列式值。
计误差协方差矩阵P。
x,=二以意(33)
P=二以[段+(息-盛)(恩-盛)]
j=l
(34 )
IMM-AUKF算法的结构框图如图1所示。
实验1:自适应UKF参数的确定
建立“当前“统计模型,采用自适应UKF对载体
进行定位、定速。载体的运动路径如图2所示,机动
详情如表1所示。
表 1 运动轨逢详情
Table 1 The detailed motion trajectory
。Se
1~60匀途直线150
61~102勾速转弛150
103~162匀速直线150
163~182匀加速直线15~351
183~195匀速转弯350
196 ~ 205 匀 加 速 直 线 35 ~40 0.5
206 ~ 300 匀 鹑 速 直 线 40 ~ 30.5 - 0.1
采用对参数比较敏感的速度误差来比较不同参
数对系统的影响。仿真结果如图3、4所示。
图 3 为平滑滤波器中滤波系数A,、Ao对系统
的影响。由图可知,当载体不机动或机动微弱时,
A越大定位结果的稳态估计性能越好;当载体发生
较强烈机动时,A越大系统对机动的跟踪能力越
强,估计精度越高。综合两参数的特点,可选择A,
=A, =0.5,
图 4 为门限参数0对系统的影响,分别选取门
限参数1、20进行对比。由图可知,在载体不机动或
机动微弱时,0越小定位结果波动越大。在载体发
生较强烈机动时,0越小系统对误差的检测能力越
强,估计精度越高。在此实验中可设“=10。在工
程实际中,由于存在观测噪声协方差矩阵R,不准确
的情况,0的具体取值应按照实际情况确定。
图 5 为文献[13]中自适应算法与本文提出自
适应算法间的比较。其中在110秒增加观测误差以
测试两种算法的估计性能。由图可见,本文提出
AUKF的优点体现在以下两个方面:(1)本文采用测
量残差的华方差矩阵作为校正量,与直接采用测量
残差作为校正量相比对未知干扰有较强的鲁棒性。
(2)本文提出的AUKF设计门限参数,降低了算法
的计算量,丁在载体不机动时刻稳定性好。
50 100 150 200 250 300
时间/s
图 3 平滑滤波系数对系统的影晋
Fig.3 Influence of the smooth filter coefficient on the system
且设模型转移概率和模型初始概率分别为
84坐标系转换为东北天坐标系。仿真结果如图6~
10所示。
图 9 “绝对位置误差
Fig.9 The absolute position error
误差,图9是绝对位署误差。图10是速度误差。由
仿真曲线可知,在载体不机动或机动微弱的情况下,
三者的估计精度相当。但当载体发生较强烈的机动
时,UKF的估计性能迅速下降。三种算法的估计性
能呈现明显的差异,其估计性能的优劣次序为;
IMM-AUKF IMM-UKF .UKF 。
￡2三种算法误差均方根的比较
Table 2 Comparison of the RMSE of three algorithms
滤波
算法东向位置误差北向位置误差高程误差绝对位置误差速度误差
UKF 3.3765 4.6087
IMM-UKF 1.8757 1.6475
IMM-AUKF 0.7403 0.8890
4“结“论
本文针对GPS/BD-2卫星导航系统中滤波模型
和噪声统计特性不确定的问题提出了一种新的自适
应滤波算法。首先,自适应UKF采用残差序列的坐
方差矩阵与UKF的验后二阶统计特性P,,的差值设
计自适应因子,并利用该自适应因子实时调整过程
噪声协方差,有效地改善了系统在噪声统计特性不
确定条件下的定位精度。该算法与已有算法相比计
算简单,易于实琴,稳定性好;其次,IMM算法解决
了单一模型对载体运动状态描述不全面而导致的滤
波精度低的问题。仿真误差幼线和误差的均方误差
统计值均证明本文提出的IMM-AUKF算法可有效
改善CPS/BD-2卫星导航系统中复杂机动载体的定
位定速精度。
