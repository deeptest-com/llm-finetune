基于概率核函数的改进粒子滤波算法研究
针对组合导航系统中粒子滤波算法出现的粒子退化现象,在粒子滤波应用过程中引入概率核函数,通过概率核函数在粒子滤波计算过程中的应用来解决粒子衰减退化问题,同时保持粒子集合的多样性.首先对重要性采样函数进行改进设计,利用状态估计概率和量测估计概率提高重要性采样函数的信息采样全面性;然后设计随机概率统计的核函数并将其应用在重采样计算过程中;最后建立改进的粒子滤波算法并将其应用到组合导航系统工作过程中.仿真结果表明,基于概率核函数的改进粒子滤波算法可以有效地降低系统误差,提高组合导航系统导航精度.

重要性采样函数 随机概率 核函数 粒子集合多样性  

针对粒子滤波算法在组合导航系统应用中出现
的粒子衰哲退化问题“,引人基于概率核函数的
probability ; Kernel function; Diversity of particle set
改进粒子滤波算法。这种改进算法在设计过程中引
人基于概率统计的核函数,通过改进粒子滤波算法
中的重要性函数来获得全面的系统信息;然后设计
出核函数和对应的交互核函数,并将其应用在粒子
滤波算法的重采样计算中;最后利用取得的粒子集
合和对应的权值生成新的粒子集。这样改进的粒子
滤波算法在阻止粒子集合退化现象发生的同时还可
以保持粒子的多样性,从而可以达到提高系统导航
精度的目的。仿真结果表明,引人改进粒子源波算
法的组合导航系统可以有效降低系统的误差,提高
系统导航精度。
1“重要性采样函数设计
在组合导航系统中引人粒子滤波算法计算时,
设系统的状态方程和观测方程如式(1)所示“:
在式(1)中,;Wn,分别表示系统的过程曝声
和量测噪声,整个滤波过程的主要任务就是通过可
以获得的系统观测值z,估计出系统的下一步状态
Gp,即要求能够得到系统的状态后验概率分布
plz)o通常的计算方法是在粒子滤波中主要
通过一系列随机样本的加权之和来表示状态后验概
率密度K0。
在改进的粒子滤波算法中,为了提高重要性采
样函数对整体系统得到数据的可信度,在设计重要
性函数的过程中要同时引人状态后验概率估计函数
p(xx|z)》和量测后验概率估计函数p(sx|xt_1o
这样,改进的重要性采样函数在采样过程中可以保
证信息的全面性。如果在设计重要性函数时仅使用
p(x,|z,)函数,由于导航系统传感器的精度限制,很
可能会在一些区域出现缺少采样集合的情况““。
在改进粒子源波算法中,引入状态后验概率估
计函数p(x:|s;〉和量测后验概率估计函数
p(x|m,,)来设计重要性采样函数。首先设一个采
样比例为a,其表达含义如下所示:
所以改进的粒子溏波算法的重要性采样函数表
达式如下所示;
通过式(3)得到粒子集合的权值后,再进行选代,
可以完成系统的状态估计。其状态估计表达如下;
芸一马nw,(4)
可以看出,改进粒子滤波算法在计算重要性采
样时考虑了已知量测值条件下状态估计概率和前一
状态值条件下的状态估计概率。通过这2种状态估
计概率值的比例,最大程度上反映了重要性采样函
数表示的系统信息,避免了可能因为传感器精度的
限制而出现的采样集合丢失。这样的设计可以有效
地提高系统粒子溏波的性能。
2“基于随机概率统计的核函数设计
核函数算法主要是用来提供一种处理非线性问
题的方法。粒子滤波算法中引人核函数的主要目的
是希望通过核函数算法来解决粒子滤波算法在计算
过程中发生的粒子退化现象。核函数的设计要与粒
子源波算法中得到的粒子集合的特征相对应。另外
在设计核函数的过程中还要考虑粒子滤波算法的计
算量和计算复杂度,避免在计算过程中出现获得非
线性积分数据的困难“。
因此,针对应用在组合导航系统中的籼子滤波
算法改进这一特定问题,选择什么样的核函数是至
关重要的。而且即使选择了某一核函数,相应参数
选取的不同也会影响改进的粒子滤波算法的计算精
度。所以改进粒子滤波算法中引人的核函数算法必
须考虑重采样粒子的概率特征,通过概率特征来设
计核函数的概率密度函数和分布函数,然后再通过
重采样计算得到新的粒子集。下面给出基于概率统
计理论的核函数推导。
假设工作为一个随机变量,则将函数式(5)所
表 示 的函数称为随机变量乃的概率分布函数“。
F(x) = P(X <x) (5)
如果存在一个非负函数人x*),使得对所有的
x,等式(6)恒成立,则称函数人x*)是随机变量X1
概率密度函数““1。
根据概率论知识,概率密度函数仁x)必须满趾
下列条件:
根据上述概率密度函数的定义,核函数设计的
核心是要从粒子滤波得到的重要性采样样本数据中
建立一个概率密度函数““,然后将这一概率密度函
数引人重采样计算中。
为了设计核函数,必须考虑粒子滤波中重采样
得到的粒子集合的特征,然后才能根据特征设计有
针对性的核函数。下面分析原来典型的粒子滤波重
采样算法得到的粒子集合的性质。
重采样粒子具有随机性,所以它们彼此之间具
有独立性,相互之间不影响对方的采样数值。粒子
重札样还是基于系统状态方程的估计进行采样的,
这些粒子同系统状态方程的分布有相同的分布,所
以具有同分布性。同时满足同分布性和随机性的粒
子集合可以近似看做是随机抽样样本“2“。经过上
面描述可知,粒子滤波过程中的重采样得到的新的
粒子集合满足上述条件,在引人核函数改进粒子滤
波算法的过程中可以将重札样过程得到的粒子集合
看做是随机采样数据集合。在设计核函数的时候利
用随机抽样集合的特征来建立核函数方程。
假设粒子滤波计算过程中一共有n个重采样粒
子,可以看做是n个样本估计。设对应的第;个粒
子对应得到的数据为E(x;,x)。由样本估计原理计
算得到粒子集合整体的概率密度估计表达式为:
根据随机抽样样本的特征,式(8)中系数o,要
满足的条件为:
定义由重采样计算得到的第;个粒子对应的函
数表达式F(x;,s)为交互核闻数,对于在粒子滤波
算法中的核函数则定义其表达式为K(x;,x)。
因为交互核函数E(x:,x)实际上是重采样算法
得到的粒子中第i个粒子的概率密度函数值,所以
对于任意的x,交互核函数E(xi,x)必须满足条件:
核函数K(x;,x)表示的含义是在粒子滤波重采
样中得到的第5个粒子的分布函数借。核函数和交
互核函数之间的关系如下:
为了在计算中方便求解,一般在设计交互核函
数时要尽可能地将已知量x;的函数表达式和未知
x的函数表达式分开。这样在计算过程中可以更
方便地求出核函数,这种设计方法可以使粒子滤波
算法减小计算量,有利于满足系统的实时性要求。
根据这一思路,设计的交互核函数一般将其改
进为:
所以概率密度函数人x)的表达式可以表示为:
式(12)中,因为设计的交互核函数k(x;,x)已
将关于x,的函数表达式和x的丽数表达式分开,在
求解核函数K(xi,x)时只对x做积分运算。所以在
计算过程中可以将函数y:(x;)看做常数。设改进
后的交互核函数V:(x;)4:(x)对x求积分得到的核
函数为:
Ktxzi,x〗 = 办 (xi) Pi(5) (14)
结合式(11),(12)和(14),可以得:
设计出核函数K(x;,x)和交互核函数K(xi,x)
后,将它们引人粒子滤波算法中的重采样计算中,利
用取得的粒子集合和对应的权值生成新的粒子集,
在阻止粒子集合退化现象发生的同时保持粒子的多
样性,这样可以提高粒子滤波算法的计算精度。
3引入核函数的改进粒子滤波算法
设计
因为传统的粒子滤波算法所依据的信息主要是
离散的样本粒子及其在后验概率分布中占有比重权
值的粒子。在传统的粒子滤波算法中引人重采样方
法的主要目的就是利用粒子权值来区别对待所获得
的采样粒子。它通过保留或者复制粒子权值较大的
粒子、放弈别除粒子权值较小的粒子来解决粒子退
化问题。由于大量的粒子在迭代过程中逐渐由相同
的大权值粒子复制而来,这样的结果必然导致粒子
样本的多样性丧失,样本粒子逐渐栎竭。
改进粒子源波算法根据前面推导得到的样本粒
子集合以及对应的权值,通过设计的核函数来模拟
拟合离散分布,估计出后验概率密度的连续模型分
布函数,再根据这个模型对粒子滤波算法进行重采
样,这样可以得到更具多样性的粒子,从而保证了粒
子集合的多样性,并能有效地披制粒子退化现象。
因此,推导改进的核函数粒子滤波算法的计算
步骤为:
步骤1:初始化:5=0时给定初始状态xo。一
般对于初始状态xo的概率分布表示如下:
步骤2:重要性采样:在“时刻(8=1,2,...),
Mq(x,|x,,2,)中随机抽取n个样本,同时利用条
件概率p(xzx|z:)和p(xx|x,-1)做为粒子滤波算法
中的重要性函数进行采样,用来避免因为采样不全
而产生误差。
步骤3:更新粒子权值,引人paz)和
P(xx|x-1)》做为重要性函数后,将其带人粒子权值
更新公式,粒子权值更新表达式为式(17);然后对
粒子权值进行归一化处理,粒子归一化处理如式
(《18)所示。
步骤4:根据组合导航系统对精度的要求,对改
进粒子滤波算法重采样算法设定门限值N,。对得
到的有效粒子数N和门限值V进行比较,如果有
效粒子数小于门限值,则进行重采样算法;否则就跳
过重札样,直接对系统状态进行估计解算。
在步骤4中,如果条件符合改进粒子滤波算法
重采样计算,在计算重采样的过程中分下面2步进
行计算;
1)由粒子集合x及其对应的权值w「构建分布
PREF, (x) WRIGHT BREF, (+) 组 成 数 据 集 合
(zi,F(x)),根据核函数推导条件选取核函数
K(si;,x)和交互核函数E(x;,x)以及对应于这些丽
数的参数,得到状态后验概率密度函数户(x):
再通过核函数得到重采样粒子集合的分布函数
F(x)如下;
2)将这一重采样过程视为一个随机采样过程。
根据模型式(19)和(20)进行随机采样,产生新的粒
子集合x*,得到新的粒子集合后设定所有粒子的权
值表达式:
步骤5:状态输出估计:当系统的改进粒千源波在步
骤4中进行重采样计算后,则状态输出估计表达式为:
当步骤4没有重采样计算时,状态输出估计表
达式为:
步骤6:设f=5+1,并返回步骤2缘续计算。
这6个步骤给出了引人核函数的粒子滤波改进
算法的计算推导过程。在这一改进算法中,首先,对
重要性函数设计所作的改进会使算法能通过采样粒
子更全面地反映系统状态,从而提高粒子滤波器的
工作性能;其次,在重采样过程中引入基于概率统计
的核函数算法,计算生成新的粒子集合。核函数的
引人可以使粒子滤波算法在计算过程中保持粒子集
合的多样性,不因粒子滤波算法的迭代而使粒子性
质变得单一;最后由于核函数计算过程中引人了随
机抽样算法的平均计算思路,这样如果计算过程中
出现粒子失真现象时可通过加权平均的思想将其变
得稳定。所以在计算粒子溏波过程中,核函数解算
可使粒子滤波中得到的重采样粒子集合变得平滑。
4“仿真验证
为验证改进粒子源波算法的性能,在组合导航
系统中应用改进的粒子滤波核函数算法和传统的粒
子滤波算法进行组合导航系统的滤波设计,通过两
者结果的比较来验证改进的粒子滤波算法的有效性
和可行性。
组合导航系统由惯性导航系统和GPS卫星定
位系统组成,组合导航系统的状态方程和观测方程
表 达 式如式(24)和(25)所示:
组合导航系统工作时的初始参数如下:
初始状态的速度误差和位置误差均为0,计算
过程中的迭代时间为300s
粒子算法中计算的粒子数目设为40,重采样的
粒子限制值Na设为20。
在计算过程中通过对组合导航系统内部的状态
误差进行估计,并得到计算结果。通过比对2种算
法的计算结果来判断改进算法的优劣。
组合导航系统在应用改进的粒子滤波核函数算
法时需要设计核函数,根据推导核函数时给出的核
函数相关信息,选择核函数K(xi;,s)的表达式为;
根据推导出来的交互核函数和核函数的关系,
通过计算可以得到交互核函数t(x;,x)的计算式:
为了简化计算,在核函数式(27)中设参数A的
值为1。
这样将设置好参数的核函数和交互核函数引人
改进粒子滤波算法的重采样算法中,分别将改进的
粒子滤波核函数算法和原来的纺典粒子滤波算法应
用到组合导航系统中。这2种算法都是通过粒子解
算估计出组合导航状态X的估计值,再通过滤波算
法得到下一状态的推测值。对比2种算法得到的误
差结果,从而判断改进的粒子滤波算法是否能起到
改善组合导航系统性能的要求。
图 1 ~5为2种算法的结果比较。图中的实线
表 示 引进核函数的改进粒子滤波算法得到的结果,
虚线表示传统的粒子源波算法得到的结果。
从仿真结果可以看出,当粒子集合退化严重,粒
子集合向单一性发展的时候,传统的粒子滤波算法
会产生较大的导航误差,并且误差有发散趋势。引|
人核函数的改进粒子滤波算法在工作中可以降低由
粒子集合退化产生的组合导航系统误差,并且使系
统误差的变化趋于平稳。组合导航系统在工作时误
差的变化率变得平稳,这样有利于系统在工作中达
到稳定状态。
图 1 正北方向位置误差比较
5“结论
针对传统粒子滤波算法中出现的粒子衰减退
化问题,引人了基于概率核函数设计的改进粒子
源波算法。并将这一算法应用在组合导航系统
中。该算法在粒子滤波算法出现粒子衰减退化现
象时能够有效披制粒子衰减并保持粒子的多样
性。仿真结果表明,这种基于概率核函数设计的
改进粒子源波算法可以很好地解决粒子滤波算法
在计算过程中出现的粒子衰殒退化问题,提高组
合导航系统的计算精度。
