一种高灵敏度深空应答机载波捕获算法
针对高灵敏度深空应答机的载波捕获,研究了一种快速解线调载波捕获算法。分析了算法的原理和实现方案。仿真和FPGA实现结果表明：该算法可准确捕获信噪比极低和多普勒动态范围极大的信号。针对算法的实际应用,给出了算法在不同工作模式下的参数设置,并对其资源占用、捕获时间和检测概率进行了计算,进一步说明了算法的工程可实现性。

深空应答机 灵敏度 多普勒频移 载波捕获  

0“引言
深空通信距离远,信号损耗大,噪声和干扰多,
导致信史信瞿比极低。如火星探测,由于地球与火
「星最近相距约5.6x10”km,最远相跚约4x10°km,
空间信号衰净可达280dBr1。要求深空应答机须
具备高灵镣度。为到达预定轨道,深空探测器与地
面站的最大相对速度高,达到第二宇宙速度(脱离地
球引力),致使信号载波的多普勒动态范围特别大。
当信号信噪比极低时,通过延长相干积累时间可改
善信噪比;若同时多普勤频移一次变化率较高,在长
相干积累时间内的多普勒频移会很大,由此导致相
干积累能量分散,无法捕获载波。
常用的基于线性调频(LFM)信号频率估计方
法有Wigner-Ville分布、Radon-Wigner变换、相位
展开法、最大似然估计法等。文献[2-3]对这些常用
的LFM信号频率估计方法进行了分析,但在极低
的信噱比条件下,上述方法难以达到预期效果“0。
文献[5]提出了一种新的LFM信号估计算法,计算
简单,可用于工程实现。在此基础上,本文对一种用
于深空应答机载波环的快速解线调载波捕获算法进
行了研究。
1算法分析
1.1“基本原理
参考深空探测需求,本文重点考虑的待测信号
指标为:最低归一化信噪比25dBHz(对应应答机灵
敏度一147dBm);载波多普勒频移范围一300一
+300kKHz;载波多普勤频移一次变化率范围一3一
十3kHz/s.其中,后两项指标合称为载波多普勒
.动态范围。
深空探测采用统一载波测控体制,遥控信号和
侧音信号按相位调制(PM)的方式调制在载波上。
为便于研究,取载波信号幅值为1,测距音仅考虑主
侧音,载波初始相位和遥控副载波初始相位均为0。
在足够短的时间段内,可认为多普勤频移二次变化
率为零,即信号载波的多普勒频移随时间呈线性变
化。这样,待测信号就筒化为LFM信号,待测信号
的实际载频(含多普勒频移)和多普勒频移一次变化
率可等同于LFM信号的初始频率和调频斜率。由
此,待测信号可表示为|
式中:fu为实际载频(含多普勒频移),即LFM信号
的初始频率;k.为多普勤频移一次变化率,即LFM
信号的调频斜率;为侧音信号调制指数;s。.(t为
EESsm为遥控副载波调制指数;su.(5)为遥控
剪载波信号。
快速解线调载波捕获算法的信号流程如图1所
示。为减少中频处理的数据量,先将待测信号数字
下 变 频 至 500 kHz, BF TEMES NES BME
多普勤频移)范围为十200一十800kHz,采样率降
为3MHz。因此,图1中的中频数字输人信号可表
示为
式 中 :b9(n) =ms. (n) +msy.(n) 7 一 &/(3 X 1056 ) , 整
数《E[0,3X10「T]。此处:了为信号持续时间。
正交下变频后的信号为|
si{n) = s(n)cos(2nfLn) =
tcos[L2r(fo 十 亡 十 音/c_:7z〉7t +n) ] 十
sq(n) = s(n) [— sin2xfin)] =
{ 一 sinL2r(fu 十 几 十 The) + 6nd] +
sin[L2r(上._J′L一{一鲁-/巳c，1)，1一jr~〔〕〕〈7】)〕}/2.4)
再经二次采样后的I、Q两路信号分别为
sim)=—-cos[2x(fio一儿十音/燮c771)7?′乙一_一
6, ( 了 (5
sq(m)=sin2x(fa一几十音/镳c??一z〉77z十
6, (m) ]. (6)
ANF m=k/f BE EEO, fT]. Wh: 乙 为 二
次采样频率。
若用于对消的本地预置值为&L.,则经对消后的
I、Q两路信史分别为
sie(m) = S-cos{2xl fa 一 乙 十
告〈/z`…一/垦L)7′1〕772十(?l(m)};(7
由式(7)、(8)可见,对消后的1.Q两路信号仍
为LFM信号,具有LFM信号的特性。
由Parseval定理可知:信号在时域的总能量与
在频域的总能量相等,经傅里叶变换后信号的总能
量保持不变,这符合能量守恒定理。因此,若设
LFM信号s(的频谱为S(o),则该信号的能量
如文献[6]所述,LFM信号具近似矩形的帽频
特性,一其时宽带宽积越大,菲涅耳纹波越小,幅值
频谱越接近于矩形,频谱宽度越近似等于信号带宽
B。因此,当时宽带宽积远大于1时,可对式(9)作
近似处理。将频域积分的区间换成0一B,并将
S(w) HEME A 代 替 , 则 |
AF:A为信号频谱幅值的均值。
已 知 ,LFM 信 号 的 Bk, THR EXER B=
h工,将其代人式(10)可得
可见,LFM信号能量一定时,在相同持续时间
内,信号频谱幅值平方与调频斜率成反比。式(7)、
(8)中:&L与&.越接近,|&。一&L|值越小,对消后信号
的多普勤频移一次变化率(调频斜率)越小,相应输
出信号的频谱峰值就越高。这样,通过搜索频谱峰
值,就可得到信号载波频率(初始频率)和多普勤频
移一次变化率(调频斜率)的估值.
1.2检测原理
该算法输入信号所夹杂的岫声是随机的,其变
化会引起捕获概率的变化,因此需对算法的运算结
果采用自适应恒虚警检测。信号恒虚警率(CFAR)
检测,就是在干扰强度变化的情况下,信号经恒虚警
率处理,使虚警概率保持恒定。CFAR处理中,确定
自适应的平均判决门限(ADT)是关键。
假设噪声分布模型的概率密度函数为p(z),则
求解
可得平均判决门限yaor[7。此处:Pu为虚警概率。
可用二分法在给定Pa的条件下,得到式(12)的
yAor,即寻找一个正整数,满足
(yapr) 之 1 一 Pa 且 上 (yaor +1 <
1— Pg. (13)
式(12)(13)给出了自适应判决门限的一般求
解方法。对不同的噪声背景,需用不同的CFAR检
测方法。yanr通常表示为
式中:N:为信号采样点数;为归一化判决门限。
对不同的噪声分布模型,CFAR检测的主要区
别是Z的求取方法不同。假设信号噪声为高斯分
布,则有
由Z可得单次检测概率
式中:rsvx为信号信噻比[1。
由式(14)、(15)可得自适应判决门限
由式(14)、(16)可得单次检测概率
根据算法厚理设计实现方案,框图如图2所示。
算法采用并行搜索方案,将输人的数字中频信号分
成N路分别送至N个通道处理模块。每个通道处
理模块除本地预置频率不同外,其余处理过程均
相同。
线,单纯用低通滤波滤除带外噪声会造成信号频谱
的混叠,敌将正交下变频后的信号依次通过积分梳
状(CIC)滤波器、半带(HB)漓波器和低通FIR源波
器。这样不仅可获得良好的滤波效果,而且能降低
采样率,减小运算量。
降采样率后的信号仍是LFM信号,其初始频
率为待测信号实际频率与本地预置频率的差,调频
斜率仍为信号的多普勒频移一次变化率。将载波多
普勤频移一次变化率的范围按固定步进划分为一组
可能值。分别用这组可能值对待测信号的相位变化
率进行对消,并对对消后的信号作快速傅里叶变换
(FFT),可得一组FFT峰值及其对应的一组频点。
对该组FFT峰值进行通道内比较选大,选出其中的
最大值。该最大值对应的多普勒频移一次变化率可
能值就是调频斜率的估值,对应的频点即为初始频
率的估值。
获得初始频率和调频斜率的估值后,将初始频
率估计值加上该通道的本地预置频率即是待测信号
的实际载频估值,而调频斜率的估值则是待测信号
的多普勤频移一次变化率估值。将这两个估值连同
该通道内的最大FFT峰值及该峰值对应的峰均比
作为该通道的输出,送至通道间模值比较选大模块。
通道间模值比较选大模块将各通道送来的最大
FFT峰值再进行比较选大,选出其中的最大值,该
最大值对应的通道即为正确通道。正确通道输出的
获值。最后由判诀模块寇成是否成功捕获的判武。
判欣模块的判决量是正确通遵输出的峰均毕,判决
门朔标用恒虚警检测的方法设置。眙正确通道输出
的峰均比高于判况门限,则表朐搬裕盘功;吴则捕芋
失煮,需重新捕获。
3“仿着与实现
3.1 WMatiab 仿 真
在Matlab教件中对算法迷行仿真验诊。
仿真参数为:後测借号载频263.872kiHzy待测信导多
普勒频秽一次变化率2781Hz/sx待滁信号灯一化信
嗜比25dBHfsy待测倩号采样频率3MHzHTRB
时长1.3s;下变簿途道的中心频率划分步进20kHz;
总通道30个;对消组的本地预圣值划分步进4Ha/s;
怠组1500个;二欣梆样频率25kHz,MXP
测借号,加噪25dBHz吹进行载波捕获,算法各通道
中辖出的FFT峰值分布如国3所示、
由图3可知;在通道本地顽罡俳270kHz和对
渊组本妇预罪值2782kHa/s的取汇梁,x辅出瑕
一个峰值,充分证明快途解线调揣获算炳的理论
正确。
仿真结果为:裁频捕获倦263870.738853Haz;
载频捕获换差一1.261147Hz;多普动频移一次变
化率捕获值2782Hz/s;多普勒娟移一次变化率据
获误差1Hz/sx峰均比21.2350084B。史见,在归
获载波多普勒动态范国大的载波、
3.2 FPGA 卖 现
在ISE中调用Modelsim教件,对算法中的变
化率对消模块进行行丹仿真,待测信号的参数设罪
如上。加暄25dBHz后,正确坦对消后的仿宗结根
妓图4扈示。
图 4 的峰值处放大如图5所示。图中:有输出端
口3个,dv(datavalid)输出为高电平时,FFT输出数
据有兔;zk_imdex为FFT输出数据的索引;sum为仿
真输出的倩号频谱、图4中标注鸯峰值是sun输出
数据有姬段(dv输出为高电平时3的最大值。
图 5 中,sum峰倩对应的xk_index为24738,
xk_index臧去由后续乘法器和加法器造成的延时
名,得到sum峰借对应的辖出索张为24734。由
sum峰值的辖画索驭绘734,俪号的二次札样率
国吊RARMadeioio信褚统果[然太]
Fig.5 ModelSim simulation result of key module {zoom in)
笙法楚级验诛煌硫件平合梁用XILINX公司的
用的模熨转换嚣译估板柔用TI公司的
ADS58C48RVM, 两 表 厢 造 煌 占 FMC-ADC-A-
DAPTRR途捷。一0
在上述磺件乎史止尊算法的栗化焕对消模块进
行旋缘骏谍:通述片上蒂辐办析税(ChipScope
Pro)对FPGA迷将寇魄版肉信号分析,加噪
254BHe时步税组对销胡借史筠类谱部图5所示。
6 HJR ES HME 2 RE AH 1 TO 24 738.3%
算可得载频捕获值为263.871kHe,$21Hz,|
裤正确,消差在可揉受范图内。
3.3应用分析
在深空探测器飞向目标星球进税中*借号信嬴
比极何和载波多兽助动悟范国极大两秒极限情况不
会同时指瑜,武平%袋有光验绣验的条亚下,算法的
提索范图司太幡缉小*这就星蕹节省了搜索时间和
硬仲资源。为症不闻条似下实现算法硬件资源和运
算时间红绑化需根据CCSDS对深城信号挡标的
规定,对算法设置不吊的工犬模式,
本文对快速镇织调嚎波捕获算法设置了4种工
作模式,模式闹绮躯动办换电羲波环的锁定指示输
出8,和射频前端朱拟宁动增益控佩(AGC)的输出
So共同热定。巾阆婉糖条件对应的工作模式见表
1.不命工作模式下y算法的参数设罪、占用资源.时
延深糖袭判狗门随酝设叙均不同。
为实现资源和时间的优化,不同工作模式下算
法的参数设置不同,见表2。|
表 2 不同工作模式算法参数|
Tab.2 Parameters of the algorithm in different operating modes
算法硬件采用的FPGA芯片为XILINX公司
的 Virtex-6 240T (XC6VLX240T-1FFG1156). 。 每
片240工含有:Slices37680个(含LUTs4个和触
发器8个),DSP48E1Slices768个(含乘法器25X
18个,加法器1个和累加器1个)18KbBlock
RAMs 832 个 。
算法中,FFT相干积累模块运算量最大,占用
资源达50%以上。因此,对算法的硬件资源占用量
和捕获时间的分析主要针对FFT相干积累模块,结
果见表3。表中的FFT点数取决于二次采样频率
.表3单次FFT占用资源和运算时延
Tab.3 Cost of hardware resource and time delay of single FFT operation
表 4 不同工作模式下算法总时延
Tab. 4 Total time delay of algorithm in different operating modes
丰和相干积累时长工。
以采用Radix-2结构实现FFT,FFT输入/输
出数据位数为8位,系统时钟200MHz为前提,用
ISE12. 2 的 Resource Estimates 估 计 出 FFT IP
CORE占用的资源,用Latency可估计单次FFT运
算的时延。结合单片240T的硬件资源可算出最大
单次并行运算FFT的个数(以FFT占用总资源的
50%计)。
在表3的基础上可得捕获算法在不同载波环工
作模式下由运算产生的时延见表4。表中:FFT运
算总个数为算法的总通道数N与总组数M之积;
FFT运算总个数除以最大单次并行运算FFT个数
可得串行FFT运算次数;FFT运算时延取决于略
行FFT运算次数和单次FFT运算的时延;捕获算
法总时延为FFT运算时延与数据缓存时延之和。
由表4可知:载波环在不同工作模式下,由捕获算法
运算产生总时延(含数据缓存时延)的极限值小于
1.5s,而一般情况下,算法总时延(含数据缓存时
延)小于0.5s。可见,算法的捕获时间在工程实现
可接受的范围内。
设定虚警概率,由式(17)、(18)可得算法的单次
检测概率,计算结果见表5。由表可知:即使在低信
噪比工作模式下,算法的单次检测概率仍高于
94.97%,
(下转第68页)
RADECS 01. Saint-Malo: [s. n, ], 1993: 401-408,
[12] HARDY T,MUROWINSKI R, DEEN M J. Charge
transfer efficiency in proton damaged CCDs[ J]. IEEE
Trans on Nuclear Science, 1998,45(2) : 154-163,
{13] WACZYNSKI A, ELIZABETH J P, MARSHALL P
W, et al. A comparison of charge transfer efficiency
measurement techniques on proton damaged n-channel
CCDs for the Hubble space telescope wide-Field cam-
era[ J]. IEEE Trans on Nuclear Science, 2001, 48
(6): 1807-1814,
[14] KUBOYAMA S, SHINDOU H, HIRAO T, et al
Consistency of bulk damage factor and NIEL for elec-
trons, protons, and heavy ions in Si CCDs[J]. IEEE
Trans on Nuclear Science,2002,49(6) : 2684-2689,
[15] HOPKINSON G R, CHLEBEK C. Proton damage
ANAASQmQwQSQSQwQSeSdNQNSeQSQSQwamQmwQNeQeAeAQQeAmeQmeAwQQAAQQQmQQAmQSQQQsQeQSQSAQQQSQSQSQ-
(上接第37页)
表 5 算法单次检测概率
Tab.5 Single detection probability of algorithm
针对高灵敲度深空应答机载波捕获的性能需
求,本文研究了一种快速解线调载波捕获算法。经
仿真和FPGA板级验证表明,该算法可准确捕获归
一化信噪比为25dBHz、多普勒频移一300一
+300kKHz、多普勒一次变化率一3一十3kHz/s的
信号。给出了工程应用的应用模式和参数设置,计
算了其资源占用、运算时延与单次检测概率。在信
噪比低至21.235dB时,算法的单次检测概率高于
94.97%.
a= CS CN Cn Ue Ure me LR SLT aS CA CN aN San CaS Un JR SU UR SUS CT Se MUR SUR SIR SUE EN a a Ua Ma SiS Ug ML RU SU Ue Lg De ML LES CR SU Ug Ug Ug
(上接第63页)
4“结束语
本文对一种基于三轴气浮台的微波成像仪干扰
力矩测量方法进行了研究。试验结果和理论分析有
较高的一致性,且微波成像仪开机前后卫星姿态无
明显干扰,表明本文提出的方法有效且可行。此测
试方法可用于其他有大型转动部件的航天器产品。
effects in an EEV CCD imager[ J]. IEEE Trans on
Nuclear Science, 1989, 36(2). 1865-1871.
[16] MEIDINGER N, SCHMALHOFER B, STRUDER
L. Alpha particle, proton and X-ray damage in fully
depleted pn-junction CCD detectors for X-ray imaging
and spectroscopy [J]. IEEE Trans on Nuclear Sci-
ence,1998,45(6) : 2849-2856.
[17] HOPKINSON G R. Cobalt 60 and proton radiation
effects on large format, 2-D, CCD arrays for an earth
imaging application[ J]. IEEE Trans on Nuclear Sci-
ence, 1992, 39(6): 2018-2025,
[18] YAMASHITA A, DOTANI T, BAUTZ M, et al.
Radiation damage to charge coupled devices in the
space environment[J]. IEEE Trans on Nuclear Sci-
ence, 1997 ,44(6) : 847-853,
