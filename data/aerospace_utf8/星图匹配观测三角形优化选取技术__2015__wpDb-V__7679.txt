星图匹配观测三角形优化选取技术
为了提高三角形星图识别算法的成功率,减少匹配过程中的计算量,进而提高星敏感器实时输出姿态的性能,提出一种星图匹配前＂二次优化＂选取观测三角形方法,该方法在在初选观测三角形的基础上,对观测三角形进行第二次优化筛选,进而提高星图识别环节的效率。优化选取观测三角形是基于QUEST定姿原理,将观测三角形的边与夹角的约束关系转换到像平面上。全天球遍历分析统计结果表明：在12°×12°视场中,采用本文提出的方法,可使一次匹配成功并输出可用于星图验证环节的较高精度姿态信息的概率提高60.9%,从总体上可大大减少星敏感器星图识别环节的计算量,并且每帧全天球定姿输出的时间一致性也被大大提高。

星敏感器 星图识别 观测三角形 优化方法  

0“引“言
星敏感器是一种高精度、高可靠性的空间姿态
测量仪器,它通过观测恒星来确定航天器姿态,在航
天领域应用非常广泛“““。星敏感器工作原理为:
图 像 传感器拍摄当前视场范围内的星空图像,提取
拍摄星点在观测视场中的位置和亮度信息,并由星
图 识 别算法在导航星库中搜索与观测星对应匹配的
导航星,最后利用这些匹配星对在空间坐标系中的
方向矢量信息计算出星镐感器的三轴姿态““。
在星敏感器刚刚进人工作状态的初始时刻或者
由于故障遇到姿态丢失的情况下,星敏感器需要对
初始姿态进行捕获,这是自主导航星敏感命研究的
重点和难点“““。目前,实际工程中主要以Liebe
和Quine研发的三角形星图识别算法为主,从而确
定娇态。三角形星图识别算法以全等三角形原理为
匹配识别标准。如何选取观测三角形进行星图识别
和建立适合三角形算法的导航星特征库是解决“太
空迷失“问题的关键技术,同时也是近年来各国学
者的研究重点。文献[7]提出采用存储星对角距的
形式来实现三角形匹配,理论上,N颗导航星可以组
成N(N-1)72个星对角距,要远小于可能组成的导
航三角形的数目,这将直接殒小导航星特征库存傅
容量和冗余匹配次数,缩短匹配时间等问题。
Quine等和Kruijff等“针对如何选取合适的
观测星组成三角形进行星图识别,提出不同的选取
原则,Quine等“认为每颗观测星只需一个三角形
即可,其观测三角形选取的原则:将观测星S,作为
三角形的第一颗星,在一个较小邻域半径(内径)
和较大的邻域半径(外径)R之间的区域选取最亮
的和次亮的两颗观测星S,MS,作为三角形的另两
颗星来构成观测三角形,如图1所示。采用这种方
法,NW颗观测星只需要N个观测三角形,减少了匹
配次数,缩小了识别时间。但观测星位置靠近视场
边缘时,观测三角形极有可能选择错误而导致错误
的识别。
Kruijff'?ELiebe和Quine三角形算法的基础
上 提 出 一 种 Douma/DUDE ( Delta-Utec Douma
Extension)算法,该算法选取观测三角形的原则:将
每颗观测星赋予一个概率值,该概率值与测量得到
的星等信息有关,具有最大概率值的观测星被挑选
被优先选择。Douma/~DUDE算法中在构造观测三
角形的时候还考虑到观测星在视场中的位置(是否
靠近边缘)对识别的影响。Douma/DUDE算法虽在
观测三角形的拼选上更加合理一些,但是由于需要
比较准确的亮度信息,因此其在实际应用中也受到
一定的局限。
文献[10j在此基础上,优先选取视场中最亮的星
构成观测三角形,其原则与Quine等和Kruijff等“7
的类似。但有所不同的是,这里并不是选取唯一一个
观测三角形来进行识别,而是从中选取数量为N,的
一组亮星,任意组成观测三角形,优先选取最亮的星
构成的观测三角形进行识别。如果某一观测三角形
组合识别失败,则按顺序选取剩余的观测三角形组合
来进行识别,若识别成功,则利用已识别的观测星信
息解算出星敏感器当前的姿态进行验证。文献[10]
给出的观测三角形选取方法是目前最经典的方法之
一,但由于在实际情况中,所选取的Ns颗观测星中可
能存在双星或者其中三颗亮星在视场中的位置近似
成一条直线的情况,这将导致用于星图识别验证环节
的实时姿态解算误差较大,为提高一次匹配成功即可
输出可用于星图验证环节的较高精度姿态信息的能
力,本文通过深人分析现有观测三角形选取方法的优
缺点,提出一种对初选观测三角形组进行第二次补充
筛选、再匹配识别的方法。
本文针对以上几种观测星选取方法的优缺点,
以角距匹配识别为基础,提出一种先初选观测三角
形,然后对观测三角形进行第二次优化筛选的方法,
从一可确保一次匹配成功并输出可用于星图识别验
证环节的高精度姿态信息。
1观测三角形约束条件的建立
在实际星图识别过程中,由于星图匹配一次的
计算量要远大于视场中选取出最优观测三角形所需
要的计算量,而且有时即使星图识别成功,但因观测
晋在视场中的位署近似一条直线,这将导致解算出
的姿态误差较大,在星图验证环节中失败,进而需要
重新选取观测三角形进行匹配识别,因此优先选取
优化观测三角形进行星图识别可大大加快星敏感器
定姿输出速度,对提高星敏感器性能和实时输出姿
态信息具有重要意义。
观测三角形只有满足一定的条件,才能实现一
次匹配、定娅有效计算。为提高计算效率,本文研究
在初选观测三角形的基础上,对观测三角形进行再
次优化筛选,最后再匹配的星图识别算法。观测三
角形优化选取,要根据同时满足正确匹配与高精度
定姿计算的双重约束,为提高在轨计算速率,需要通
过深人分析,转化为具体、易计算的像面直接约柬
条件。
双星对匹配识别的成功率影响很大,双星是指
在视线方向上相距较近(实际距离可能很远),在星
锋感器成像面上的星点不能互相区分开的两颗
星“,一般的星图识别算法无法对双星进行正确识
别。由于文献[10]中指出两颗星角距值小于
0.047“时按双星来处理,因此所选取的观测三角形
边长应至少大于双星门限阎值(4个像紫),同时为
提高星点位置的定位精度,一般采用离焦技术,以像
点大小5x5像素为例,为使两颗观测星质心完全分
离,其迅长距离应至少大于10个像素。地上因素作
为二次优化筛选观测三角形约林条件1,该约林条
件决定观测三角形最小边长d阎值的选取。
组成观测三角形的三颗星在视场中的位置关系
对星敏感器最终输出姿态的结果影响很大,例如某
三颗观测星近似一条直线时,这将直接导致星敏感
器定姿失败“““,这主要是因为参考矢量阵,u=
[Vi,f…,丫]在矩阵求逆的计算过程中,当观测
三角形三颗星位置相关性较强的时候,VV高度近
似奇异。
将观测三角形的边与夹角的约束关系转换到像
平面上分析,如图2所示,星敏感器像空间坐标系示
意图,0是星镐感器像空间坐标系的原点Starl、
Star2、Star3是恒星在像平面上的投影,f是星敏感器
的焦距,是Star2到底边c的垂线,9是三角形中最
小夹角,即a边与c边的夹角,8是边对应的夹角。
h = asinb (1)
为避免双星对星图识别的干抢,同时减小三颗观测
星在像平面上位置的相关性,即三颗观测星在像面
上 不 共 线 , 从 Qaaternion Estimation ( QUEST)! 定
姿原理分析,4应至少大于双星门限阎值,即:
其中8为双星门限阎值,式(1)、(2)作为二次优化
筛选观测三角形约束条件2,该约标条件决定了观
测三角形最小夹角,阎值的选取。
本文在初选观测三角形的基础上,对观测三角形
进行二次优化等选。初选观测三角形是指优先选取
视场中最亮的NN=5~6)颗星任意组成观测三角
形,将这些观测三角形组成待选观测三角形集合。二
次优化筛选观测三角形以如下约束条件为基础进行:
约束条件1:像面上,组成观测三角形的最小边
应大于dun个像素。
约束条件2:像面上,观测三角形中最小夹角应
KF 0 in [
2“优化观测三角形选取方法
图 3 是优化观测三角形选取方法流程图。m为
观测视场中出现观测星的数目,d是观测三角形
最小边长阎值,b是观测三角形最小夹角阎值,N
为观测星序号,初始值设为1,n为所选三颗亮星以
外第四颗亮星序号。
步骤1:将星敏感器视场中出现的观测星按其
星等信息进行升序排列(星等越小亮度越高)。
步骤2:以第N(W的初始值设为1)颗亮星为基
准,依序选取第N+1、N+2颗亮星组成三角形,将
N+3的值赋给n。
步骤3:计算组成的三角形三边边长,判断最小
边长是否大于d4,,,,如果是,执行步骤4进一步判断;
如果不是,输出“观测三角形存在双星“,执行步骤9。
步骤4:判断三角形中最小夹角是否大于9,
如果是,将此三颗亮星组成三角形进行识别后执行
PES;如果不是,输出“三颗观测星近似一条盲
线“,执行步骤12。
步骤3:验证(根据已识别的观测星信息解算出
星敏感器当前姿态,根据这个妍态产生一幅模拟星
图 并 与原始的观测星图作对比),若验证成功,即模
拟星图与观测星图中星点的位置对应一致,则输出
“识别成功“;若验证失败,执行步骤6。
步骤6:剔除已选三颗星中最暗的一颗星,引人
第n颗星组成新一角形,执行步骤7。
步骤7:判断第n颗亮星是否为视场中最后一
颗亮星,如果是,将N+1的值赋给N,执行步骤8;
如果不是,n+1的值赋给n,执行步骤3。
步骤8:判断第N颗亮星是否为视在中倒数第
二颗亮星,如果是,观测三角形识别失败;如果不是,
执行步骤2。
步骤9:判断第n颗亮星是否为视场中最后一颗亮星,
如果是,输出“最亮星为某星云中一颗星“,将N+1
的值赋给N,执行步骤10;如果不是,执行步骤11。
步骤10:判断第N颗亮星是吴为视场中倒数第
二颗亮星,如果是,未进人识别环节,识别失败;如果
不是,执行步骤2。
步骤11:剔除组成最小边长的次亮星,选取第n
颗亮星组成三角形,然后将n+1的值赋给n,执行
步骤3。
步骤12:判断第n颗亮星是否为视场中最后一
颗亮星,如果是,将N+1的值赋给N,执行步骤
10;如果不是,执行步骤13。
步骤13:剔除已选三颗星中最暗的一颗星,引
人第n额星组成新三角形,然后将+1的值赋给
n,执行步骤3。
3“仿真试验与结果分析
以经典的“仅选取视场中最亮的w颗观测星组
成观测三角形组再星图识别“方法““为基准,选取
Ny=6,即从观测星图中挑选出最亮的6颗星用以组
成观测三角形,若观测星数目不足6颜,则挑选所有
的观测星。6颗星所能组成的三角形数目为C=20。
利用工程上某型号星数感器对全天球逾历成像,其成
像系统参数如表!所示。分别以赤经、赤纬3“为间
隔,在全天球产生7200个均匀分布的视轴指向,基于
自研的星图模拟软件,严格按照物像投影关系,对这
7200个视轴指向依次进行扫描,在12“x12“视场中,
统计视场中不满足约束条件1.2的观测三角形(无法
解算得到可用于星图验证环节的较高精度的姿态信
息)数目的概率分布,如图4所示。
表 1 星敏感器成像系统参数
Table 1 Parameters of star sensor image system
参数参数值
视场12°x12°
像 元 数 512pixel x 512pixel
焦距40mm
像元尺寸16hm
位置不确定度1
角跚误差门限3
极限星等6
星等误差门限0.75
由图4分析可得,在每个视场中,优先选取的20
视场中出现不满足约束条件1、2的观测三角形数目
图 4 不满足约柬条件1.2的观测三角形数目的概率分布
Fig.4 Dissatisfy with constraint conditions 1, 2, observation
of the triangle number of probability distributions
个观测三角形,平均有7.74个观测三角形无法解算
出用于星图验证环节的较高精度的姿态信息,这意味
着在每次星图识别时,平均仅有61.3%的概率史一次
解算得到可用于星图验证环节的较高精度的姿态信
息,这将严重影响星敏感器输出姿态的实时性。
表 2 进一步给出了在全天球7200个视轴拾向
的视场中,以视场中最亮的两颗星为基准,依次选取
第34、5颗亮星组成观测三角形时,不满足约束条
件1.2的观测三角形具体统计数据。
表 2 不满足约束条件1、2的观测三角形具体情况统计
Table 2 Dissatisfy with constraint conditions 1 2, observation
of the triangle specific statistics
以视场中最亮的两颗星为7200个视轴指向中,不满足
基准,依次选取第N颗亮约束条件1.2的观测三角形
星组成观测三角形出现的次数
“赖颊贾园挂
规颖
觉。
注.观测星数目小于等于5的视场数口是6。
由表2分析可得,在所有观测星数目大于5的
视场中,最亮的三颗星组成的不满足约束条件1、2
的观测三角形(姿态解算的误差将较大)出现的次
数为2729,即第一次匹配后有37.99的概率使得相
对姿态解算误差较大,若直接用于星图验证环节,则
极有可能验证失败;对于每个“最亮三颗星组成的
观测三角形不满足约束条件1,2“的视场,保留最亮
的两颗星并同第4亮星组成新的观测三角形,经统
计,此时不满足约东条件1.2的观测三角形出现的
次数为1343,即至少存在18.66%的邋历统计概率,
使得通过连续两次三角形匹配均不能实现输出可用
于星图验证环节的较高精度姿态信息。
为克服上述不足,深人分析观测三角形中双星
及三颗星相对位置对星图识别和最终姿态输出过程
的影响机理后,提出星图匹配前“二次优化“选取观
测三角形的方法:将观测三角形中最小边长与最小
夹角作为两个约束条件,按照图3的过程对观测三
角形进行优化选取,实现了“首次匹配已优化后的
观测三角形“即可满足本文所提出的约束条件,从
而可保证“一次匹配成功即可输出用于星图验证环
节的较高精度姿态信息“,实现了约100%的一次匹
配并成功星图识别能力。丽文献[10]中“仅选取视
场中最亮的Ns颗观测星组成观测三角形组再星囹
识别“的方法,仅有62.1%一次匹配成功并输出可
用于星图验证环节的较高精度姿态信息的概率,即
使经过连续两次匹配验证环节,也仅有81.34%的概
率可以成功实现高精度姿态解算进而成功完成星图
识别的能力。因此,本文所提出的星图匹配前“二
次优化“选取观测三角形的方法从总体上可大大减
小星敏感器星图识别环节中的计算量,进而提高了
垂敏感器整体性能。
4“结“论
星敏感器是航天应用中最精确的姿态测量光学
传感器,本文介绍了选取的观测三角形对妍态输出
的影响,对现有观测三角形选取方法进行了深人分
析,并以三角形识别算法为基础,从QUEST定姿原
理分析,重点考虑双星和观测三角形中三颗星在像
面上的位置关系对星图识别和姿态输出的影响,提
出一种先对观测三角形优化选取、再匹配识别的方
法。仿真试验数据显示,相对文献[10]的方法,采
用优先选取的观测三角形进行星图识别,可使一次
匹配成功并输出可用于星图验证环节的较高精度姿
态信息的概率提高了60.99%8,从总体上可大大凑小
星敏感器星图识别环节中的计算量,并且每帧全天
球定姿输出的时间一致性也被大大提高。
star catalogue retrieval algorithm [J]. Journal of Astronautics,
2012, 33(5) :584 -589. ]
[ 2 ] Liebe C C. Accuracy performance of star trackers - a tutorial
[I]. IEEE Transactions on Aerospace and Electronic Systems,
2002 ,38(2 :587 - 599.
[ 3 ] Liebe C C. Pattern recognition of star constellations for spacecraft
applications [ J]. IEEE Aerospace and Electronic Systems
Magazine,1992 ,7(6) :34 —41.
[ 4 ] Liebe C C. Stars trackers for attitude determination { J]. IEEE
Transaction on Aerospace and Electronic Systems ,1995 ,6:10 - 16.
[5]宁晓琳,王龙华,白鑫贝,等.一种星光折射卫星自主导航系统方
案 设 计 [J]. 守 航 学 报 ,2012, 33(11) :1601 - 1610. [ Ning Xiao-lin,
Wang Long-hua,Bai Xin-bei, et al. A scheme design of satellite
autonomous navigation system based on stellar refraction J]. Journal
of Astronautics, 2012, 33(11)} :1601 - 1610. ]
[6]张磊,何昕,魏仲慧,等.三角形星图识别算法的政进[J].光
学 精 密 工 程 , 2010 ,18 (2 ) ;458 - 463. [ Zhang Lei, He Xin,
Wei Zhong-hui, et al. Modification of triangle identification
algorithm [J]. Opt. Precision Eng, 2010 ,18(2 ) ,458 - 463. ]
[7]张广军,貌新国,江洁.一种改进的三角形星图识别方法[
航 空 学 报 ,2006,27(6) :1150 - 1154. [ Zhang Guang-jun, Wei
Xin-guo, Jiang Jie. Star map identification based on a modified
triangle algorithm[ J]. Acta Aeronautica et Astronautica Sinica,
2006 , 27(6) ; 1150 -1154. ]
[ 8 ] Quine BM, Durrant-Whyte H F. Rapid star pattern identification
[J]. SPIE 1996,2739:351 ~ 360.
[ 9 ] Kruijff M. Star sensor algorithm application and spin-off [ C 1.
54" International Astronautical Congress of the International
Astronautical Federation ( IAF ) the International Academy of
Astronautics and the International Institute of Space Law, 2003.
[10]“张广军.星图识别[M].北京:国防工业出版社,2011:72-78.
[11]朱长征,居永忠,杜晓辉.导航星库制定方法研究[J].字航学
报 ,2010,31(5 ) : 1327 - 1330. [ Zhu Chang-zheng, Ju Yong-
zhong, Du Xiao-hui. Approach to founding a guide star catalogue
[ 刀 . Journal of Astronautics, 2010,31(5 ) : 1327 -1330. ]
[12]HEXRHR.基于容积卡尔曼滤波的卫星姿态佼计[1].
字 航 学 报 ,2013 ,34(2 ) :193 - 200. [ Wei Xi-ging, Song Shen-
min. Cubature Kalman filter-based satellite attitude estimation
[J]. Journal of Astronautics, 2013 ,34 (2 ) :193 - 200. ]
[13] Shuster, M. D. The quest for better attitudes [J]. The Journal
of the Astronautical Scienses,2006 ,S4(3 ) :657 - 683.
