基于三维非结构网格的连续伴随优化方法
基于非结构网格,采用Euler方程、连续伴随方法以及自由形面变形技术（Free-form deformation,FFD）结合序列二次规划（Sequential quadratic programming,SQP）优化算法,开发出了三维飞行器的气动外形优化代码。应用Fortran 90语言,动态存储数组和指针,节省了内存。采用Roe形式的二阶迎风格式和LU-SGS隐式时间离散格式求解连续伴随方程,同时采用一种新的参数化坐标求解方法,使得FFD技术更加鲁棒。和有限差分方法求得的梯度进行比较,验证了连续伴随方法所求梯度的正确性,实现了ONERA M6机翼的减阻优化,证明本文开发的优化代码能够实现三维气动外形的减阻优化。

非结构网格 连续伴随方法 EULER方程 Roe格式 LU-SGS隐式格式  

早期气动外形设计的主要方法是利用风洞进
行实验,但实验方法的缺点是成本高和周期长。随
着计算机性能和计算流体力学(Computational
fluiddynamics,CFD)技术的飞速发展,结合CFD
技术和优化理论的气动外形设计技术越来越受到
重视。气动优化方法分为全局优化方法和基于梯
度的优化方法。全局优化方法如基因算法和高效
全 局 优 化 (Efficient global optimization, EGO) 算
法等,已具有较广泛的应用“。传统基于梯度的
优化设计方法是有限差分法,但其计算量随着设计
变量个数的增加而增加,从而导致该方法在设计中
难以广泛应用。1988年Jameson首先提出最优控
edu. cn,
密对梯度计算的影响““。Baysal等利用流动控制
方程的离散格式推导伴随方程,建立了离散伴随
方法“““。随后离散伴随方法在非结构网格上也得
到了长足发展““2。离散伴随方法能够得到更为精
确的梯度,但是方程推导相对复杂,编程实现也较
为繁琐。而连续伴随方法直接从控制方程推导,思
路清晰,同时可采用与控制方程类似的数值求解方
法,使得连续伴随方法求解程序相对简单。对于连
续伴随方法的研究,美国斯坦福大学Francisco等
庭用C十十语言开发出了SU2“1优化程序。
国内对于伴随优化方法的研究主要集中于结
构网格。离散伴随方法方面:刘学强“““和吴文华
等0开展了离散伴随优化方法的研究,成功对翼
身融合体的外形进行了优化设计;左英桃“采用
LU-SGS隐式时间离散求解伴随方程,实现了二维
翰型和三维机翰在无粘和有粘状态下的优化。连
续伴随方程方面:唐智礼““““对连续伴随方法进行
了给深人研究,实现了应用Euler方程对翼型进行
反设计和有约束的气动优化,并结合伴随方法和对
策理论完成了多目标优化设计;黄勇[““1和周铸“20
实现了翼型在无粘和有粘状态下的优化;熊俊
涛r21等采用了多重加速技术,完成了跨声速机翼
的连绰伴随优化。
当外形较为复杂时,非结构网格比结构网格更
易于生成。国内关于非结构网格离散伴随方法的
研究也有所发展,关键“和高宜胜““实现了翼型
的二维离散伴随优化设计,李彬““2“1实现了三维机
BAME SBA EBERT, HMAT HTH
多重网格提高设计效率。但是在三维非结构网格
连缈伴随优化中,采用二阶迎风格式空间离散和
LU-SGS时间离散求解连续伴随方程,目前国内还
没有相关内容的文献公开发表。
本文基于非结构网格,采用Euler方程、连续
伴随方法以及FFD技术结合SQP优化算法,开发
出了三维飞行器的气动外形优化代码。本文所开
发代码使用Fortran90语言,动态存储数组和指
针,以便节省内存。对于连续伴随方程,运用Roe
形式的二阶迎风格式和LU-SGS隐式时间离散格
式进行求解,LU-SGS格式易于开发,且计算效率
高、占用内存小。同时在FFD变形技术中采用了
一种新的求解参数化坐标的方法,使得FFD技术
更加鲁棍。本文比较了连续伴随方法和有限差分
1“连续伴随方法
气动外形优化中大多数目标函数可表示为流
动变量的函数沿着物面边界的积分
式中:Y表示流动变量;S表示参考面积。
当物面发生变化时,目标函数的变化由两部分
组成
式中u为边界法矢的变分。
由于本文目标函数为阻力系数最小,约束条件
为升力系数保持不变。取
将式(32代人式(2)最终可得
与S
考虑定常无粘三维可压缩流动控制方程
vf-驱+驱+跃-0@
式中:三为对流通量向量;F:,MF.分别表示通
量向量与在z,y和z方向的分量。
为了避免计算式(7)中的8P,引人伴随变量
l_薹′【l`二`′〈′亟`l，′`歹`2，`歹`二…，^`」z"z薹yWs)e首董丨`…^」歹(蓄j′EulerPildin
行线性化,然后对线性Euler方程和伴随变量曰
求内积,对其在整个计算域积分,分部积分可得
〕一I〈艾灭薯【′T)'′噻′(箩【J(矗_(〕一丨`I`I'T(nsA)8UdS十
0 S
由于连续伴随方程特征值和Euler方程特征
值符号相反,则伴随方程的人流波对应Euler方程
式中:4为雅可比矩阵4的特征a值构成的对角
Be;T为相应右特征向量。
对于外形优化,由于来流特征变量变分SW=
T6U二0,通过选择合适的远场边界条件,可以消
除式(9)中绕远场的积分:流场特征值大于0即对
应伴随变量入流波时,蚊|.::o一0;流场特征值小于
0即对应伴随变量出流波时,边界处伴随变量由计
算域内部点外插得到。
应用Euler方程无穿透物面边界条件,绕物面
的积分可以分解为
| 曰 「(msA)6UdS =
把线性化的Euler方程物面边界条件?v=
~(853,v)*ns—édns?vs代人式(11),最终可得到
式中$一p卷十p(x曰十g十山g)十p东。
将式(12)代人式(9),并用式(7)减去式(9)得
到目标函数的变分形式为
巳
一
为消除式(13)中的SU和8P,令(CC城)4)7
和@,s一(iz:曲;十y虫;十n:虬)分别为零。则得
到伴随方程
AT (VY) 二 (( 女 亟 )4)7 二 0 (14)
以及物面边界条件
dens=mnV￥,+n￥, +n￥,) (15)
则最终目标函数变分为
何敏感度。
2“方程求解
流动控制方程和连续伴随方程空间离散方法
均采用二阶Roe格式,时间离散均采用LU-SGS
格式。
2.1流动控制方程
三维无粘可压缩流动控制方程积分形式
害呈I[义Y(i.「.霉-暑_f]歹'〔l`S=(〕17)
式中:DU为守恒变量;卫为对流通量。
空间离散采用Roe格式为
式中:UL,Ua为控制体边界两侧的守恒变量,可通过
线性重构进行求解,采用Venkatakrishnan限制器。
时间离散采用LU-SGS方法,非结构网格需
要通过一定的网格排序方法来确定上下三角矩阵。
网格排序可以通迈分层和染色两步来进行,具体过
程见文献[27]。LU-SGS方法需要通过前扫和后
扫两个过程来实琪。
2.2伴随方程
2.2.1“空间离散
本文采用有限体积方法求解连续伴随方程,伴
随方程的积分形式为
KFAAA,分别为雅可比矩阵4在z,y和*
方向的分量。
应用高斯定理,式(19)变换为
习:S
对于标一控制体,将伴随方程离散后得到
式中:Q:表示第;个控制体的体积;表示i点的
相邻点的集合;Yy表示伴随变量对应的通量;R:定
义为控制体;的残值。
本文伴随方程的空间离散采用Roe形式的离
散格式
Ez-_FEE「AUR’一仁一一
式中O=Are.|(Uzx一UL),本文采用的是@的近
似线性化
在很稀豌的网格上,近似线性化计算得到的梯
度和有限差分得到的梯度相差较大,但随着网格的
加密,该误差逐渐减小。通过下文这续伴随方法和
有限差分方法所计算的梯度对比,以及ONERA
M6机翼减阻优化的实现,说明本文的近似线性化
是可行的。
左右状态伴随变量虱和Pr表达式为
RAAT表示限制器;东表示相应控制体伴随变
量的梯度。
本文伴随变量梯度的计算采用格林-高斯法
限制器采用Venkatakrishnan限制器,其表达式为
At mex 一 max(￥;, max, ￥;) 一 ￥,
At min = min(￥;, min; ￥;) 一 圭
丛2=告〈v疃′趸*r;)
式中参数e:二(KAh)s,取K=5.0,Ah取值为控制
体体积的立方根。
2.2.2“时间离散
本文开发了连续伴随方程的LU-SGS隐式时
间离散格式。在本文的算例中,连缈伴随方程求解
中CFL数可取为1.0X10*,大大提高了连续伴随
方程的求解效率。将伴随方程离散为
式中A驿二A驿土一如。
对式(27)的右端项泰勤展开并整理得
来处理式(28)中伴随方程的雅可比矩阵志。由于
伴随方程雅可比矩阵只与流场解相关,而和伴随变
量无关,故有
LU-SGS中将隐式算子分解为3部分
D+ LD (D+U)AW 二 取 (30)
最终整理得到非结构网格下这续伴随方程的
LU-SGS方法为:
向前扫
AY" =D '(R— 7 2 as@aw — 7; 0%)
3D
向后扫
式中谱半径y定义为yy二|yy,my|十cy。
由于伴随方程的雅可比矩阵4一一47仅与流
动变量有关,所以在其LU-SGS求解中,可直接采
用流场中得到的雅可比矩阵进行计算。对于伴随
方程的LU-SGS格式,非结构网格同样需要通过
一定的网格排序方法来确定上下三角矩阵。
3“设计变量及自由形面变形技术
本文采用自由形面变形技术(Free-formde-
formation,FFD)来实现飞行器外形的变化。调整
FFD控制点的坐标,通过映射关系获得变形后的
物面网格点,再应用动网格技术得到新的空间网
格。采用贝塞尔控制体对飞行器整体或局部进行
参数化
KF: X AYE SWE FRET uv 和 忍 表 示 物
面点的参数化坐标且x,,忍E[0,11;B为;阶
Bernstein ZR s Pi FEE Hl f= c
通过式(33)可以求得物面网格点的参数化坐
标,在整个变形过程中参数化坐标保持不变。本文
在计算物面点的参数化坐标时,采用了一种新的等
参逆变换迭代解法“,不仅克服了三维问题中线
物面变形后,木用弹簧动网格方法得到余下网
格点
的长度;又表示;点未知的位移;乃表示已知的}
点的位移;N:表示i点所有的相邻点。该方程组用
雅可比迭代求解,即可得到所有点的新坐标。
本文FFD控制体共有60个控制点,由于无粘
情况下减阻即为削弱激波,且激波处于上翼面,因
此选用控制体上表面的25个控制点坐标为设计变
量。图1为初始的FFD控制体和ONERAM6机耀
网格,图2为优化后的FFD控制体和机翼网格。
本文选取其中5个设计变量的梯度进行比较,
1一5分别为FFD控制体上表面从翼根到翼梢的
控制点。比较结果如表1,可见本文伴随方法所得
的梯度和有限差分方法吟合较好,可以用于优化计
算中。
每次优化迭代中,连续伴随方法仅需要分别对
流动控制方程以及目标函数和约束函数的伴随方
程各计算一次,而有限差分方法需要分别求得初始
和各设计变量扰动后的流动状态,才能得到所有关
于设计变量的梯度。表2对连续伴随方法和有限
差分方法梯度计算效率进行定量对比分析。本测
试计算在HP-Z620(2.8Hz)工作站上进行,各方
倍流场的计算量,计算效率远高于有限差分方法。
￡1阻力敏感导数比较
Tab.1 Comparison of derivatives of drag
控制点“有限差分法连续伴随法Al'%
1 3.450 2X 10 一 3.498 2X 10 一 1. 39
2 6.648 5X1073 6.350 1X107% —4.49
3 4.141 不 X 10 一 4. 209 5X 10 一 1. 64
4 4,483 8X 10 一 4,2258X%X107% —5.75
5 一 9. 859 3X10-4 一 9. 814 1X10-4 —0.46
表 2 计算效率定量测试
Tab. 2 Quantitative test of computational efficiency
wuEMSHIR命,伟沥限
时 间 比 1.00 1.03 1.05 3.08 心 26
注:时间比是与计算流动控制方程所需时间的比值。
5“计算结果
优化方法采用序列二次规划(Sequential
quadratic programming , SQP) 算 法 , SQP 方 法 可
用于计算无约柬和有约束、线性和非线性优化问
题。计算状态是来流马赫数Ma=0.8395,攻角
e一3.06“,无侧滑。本文网格点31万个,通过求解
Euler方程得到升力和阻力系数分别为CL一0.2903,
Cpob=0.014 2, 图 3 为 ONERA M6 机 翼 压 强
云图。
机翼的无约束减阻优化中,升力系数会随着跚
力系数同时降低,可见无约李的聪阻优化并不能应
用于工程实际,因此减阻优化问题常常需要加人保
持升力系数不变的约束条件。本文ONERAM6
机翼的喜阻优化问题,目标函数是阻力系数最小,
约束条件是保持升力系数不变。图4表示优化后
最终机翼的压强云图,从该图可以看出最初的激波
已经弱化。图5为优化过程中升力系数和阻力系
数变化曲线,阻力系数由0.01417下降为
0.01059;升力系数最终为0.29,接近于最初的升
力系数0.2903。由图5可知,只需20次优化迭代
升阻力系数基本达到收敛,可见本文的优化方法具
有较高的计算效率。表3给出了优化前后升力阻
力和升阻比的变化大小。图6为优化前后机翼展
向30%和70%处截面形状对比,30%处截面略有
变化,而70%处截面相当于减小了当地攻角,从而
图 3 ONERAM6机翼压强云图
Hig. 3 Pressure counters of ONERA M6 wing
′图4优化后机奚压强云图
Fig.《 Pressure counters of final wing
图 5 优化过程中阻力和升力系数变化曲线
Fig.5 Convergence curves of Cy and Cy
′裸3“优化结梁
Tab.3 Optimization results
“参数仰化前“忽化后Ay命
Cu 0.2908 0.2900 —0.10
Co 0.014 17 0.01059 —25.26
K 20. 49 27.38 33, 63
6“结束语
本文开发了基于非结构网格,采用连续伴随方
法,结合三纳Euler方程和FFD网格变形技术的
基于梯度的优化方法,研究了连续伴隋方程的推导
final wings
original and final wings
过程和离散求解方法,并梁用二阶Roe格式和
LU-SGS离散格式求解连缠伴随方程。将本文连
缈伴随方法计算梯度和差分方法的梯度进行比较,
WuUMLTNW3 BB WTR A) SE 大 ANA) 一 = 医 7 Z BY Vu H VEX PEL
的目标。下一步将实现该套代码的并行化,以提高
计算敌率,同时研究N-S连续伴随方程的求解。
