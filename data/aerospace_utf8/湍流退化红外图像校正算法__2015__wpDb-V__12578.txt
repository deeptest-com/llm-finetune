湍流退化红外图像校正算法
针对高速湍流场引起的红外图像模糊问题，提出了一种基于改进增量Wiener滤波的复原校正算法。首先，基于先验知识对湍流退化图像的降晰函数进行辨识并得到复原图像的起始估计；其次，提取起始复原图像中的强边缘并平滑边缘区域；最后，利用改进的增量维纳滤波算法迭代复原图像。实验结果表明：该算法与传统的迭代盲复原算法及基于Fuzzy滤波器的后期去振铃算法相比，复原图像的振铃测度有较大下降，同时提高了复原图像的质量，降低了算法的时间复杂度。

气动光学效应 湍流退化 红外图像 振铃效应 边缘平滑 增量Wiener滤波  

学退化效应仿真及退化图像复原方面的研究。
图 像 处理与目标感知识别.网络信息安全,电子对抗模拟与仿真等
0引言
红外成像系统具有灵敏度高、抗干扰能力强、可
实现复杂战场环境下全天时工作等优良特性。红外
成像精确制导已经成为我国重点研究的技术之一。
然而,导弹在大气层内以超声速/高超声速飞行时产
生的气动光学效应0对光学成像探测系统造成热
辑射干扰和图像传输干扰,导致光学系统接收到的
目标图像产生偏移、抖动、模糊等,大大影响了导引
头探测、识别和跟踪目标的能力,降低了导弹命中目
标的精度,严重时甚至无法检测识别目标。因此,如
何从湍流退化图像中有效地复原出目标图像,是实
现超声速/高超声速巡航导弹成像探测及精确制导
与寻的必须解决的关键问题之一。
目前对渝流退化模糊图像的复原多采用迭代育
复原算法。如付长军等提出的基于最大熵盲复原方
法日,Hong等人提出的基于各向异性规整化的湍流退
化图像盲复原算法。由于盲复原算法中点扩展函数
未知,如果估计的点扩展函数尺寸小于实际值会使
复原结果出现模糊,达不到复原的目的;如果估计点
扩展函数大于实际值则会使复原结果出现严重的振
铃。针对这一问题,肖利平等人4推导了图像退化点
扩展函数大小与飞行参数之间的关系,但关键系数
仍需要通过大量风洞实验获得,限制了该方法的使
用。另一方面,为了提高了盲复原算法的效率,一些
学者也提出了各种快速算法,如洪汉玉等人提出的
基于线性搜索的红外目标图像循环迭代复原加速算
法口,邵慧等人提出的基于Huber正则化二阶加速
复原算法史,Deshmukh等提出的基于分层块的快速
降低渝流退化算法古但是,为了得到较好的复原图像
质量,盲复原算法仍需要较多的迭代次数,难以满足
实时性的应用需求仪。
满流退化图像复原校正方法的研究不能仅集中
在算法本身,还需要考虑到退化过程中的一些先验
知识。肖利平等人I建立退化图像降晰函数尺寸与
飞行参数之间的关系是一个很好的尝试。文中以气
动光学效应的研究成果作为先验知识,将湍流引起
的图像模糊过程简化为可用参数描述的二维高斯函
数形式;并利用基于图像质量评价的降晰函数辨识
方法估计出降晰函数和复原图像起始值;最后使用
改进的增量Wiener滤波器进行迭代复原。
1图像退化模型与增量Wiener滤波器
1.1图像退化模型
气动光学效应的已有研究成果口口表明:当流
场中的湍流规模比波长大,比系统孔径小时,湍流引
起的像模糊效应可以用降晰函数表示,图像的退化
可近似为空间不变模糊。此时,湍流退化过程可视为
线性空不变模糊,图像退化模型的可表示为:
式中:s为退化(观测)图像;f为原始图像;h为降晤
函数;为加性嚣声;*为卷积运算。
变换到频率域,公式(1)变为:
G(w)=H(w)F(w)+N(w) (2)
图 像 复原就是由退化图像g求解原始图像f如
果h未知,则属于相复原问题;如果已知,则转化为
经典图像复原问题。因此,若能通过先验知识得到气
动光学效应的降晰函数,则湍流退化图像的复原将
变为一个绢典的逆溏波问题,图像复原校正的效率
就可以得到提高。
1.2增量Wiener滤波器
增量Wiener滤波器口是一种基于迭代的滤波
器,并能保证反卷积误差的L2范数随着迭代次数的
增 加 而 凑 小 。 IER EBHIRES(0)=6G(w)-Fu(w)H(w),
Wiener滤波器提供的估计可以写成;
由于上式月端第二项分式部分:
_Z_」薯((【))_霆-青「一_上TS`′'′(:芝(三亡)/~S'】(】r((j))=I
因此,增量Wiener滤波器可以近似为:
】【「r`ew((【))=′『()l【l〈(【】)-_-莘'r…>_吾青羞〕卉('T呈卜囊孛乏(4)
式中:y=Su(w)/Su(凶为噪声和信号功率谱的比值。
由此可以看出,增量Wiener滤波器工作于频
率域,只有简单的乘法和加法运算,其有较高的计
算效率,易于硬件实现,能够较忠地收敛到可以接
受的解,而且可以通过设定准则控制迭代的次数。
上述优势使其非常适合于复原高速渝流引起的图
像退化。
2基于边绍平滑的湍流退化红外图像校正
算法
文中复原算法为降晰函数(卷积核)已知条件下的
迭代反卷积。为提高算法效率,反卷积算法使用增量
Wiener滤波器。为了降低复原图像中的振铃效应,使
用了边缘平滑技术以降低边缘区域的像素突变。
2.1湍流退化图像的降晰函数估计
长曝光成像条件下,像模糊的降晰函数具有高
斯函数形式:
式中:D,为降晰函数的支持域;(in,川为Dy的中心点;
c为归一化系数,使得一R(i,])=1。支持域D,和参数
a共同表征了这个Gauss函数;因此,湍流退化图像
的降晰函数辨识工作就是确定支持域D,和参数a。
文中选择基于图像质量评价的湍流退化图像降
晰函数勘识算法屹,该算法对于信噪比高于25dB的
退化图像有较好的表现;同时,该算法还可以为后绩
迭代复原提供复原图像的起始估计。将估计得到的
降晰函数标记为,复原图像的起始估计记为方。
2.2增量Wiener滤波器y值的确定
蚩然增量Wiener滤波器不需要噪声和信号功
率谱的准确比值,但较大的y会减缓算法的收敛速
度,而较小的y值又会使算法过快的收敛到一个常
常不需要的逆滤波解。因此,合理的确定y值既有利
于提高收敛速度又有利于得到一个可以接受的复原
结果。
文中噪声和信号功率谱比值y取值记为;
式中:Vu为图像的信噪比,单位为dB;1为控制系
数,与反卷积误差$和降晰函数支持域D有关;
AFhk为控制参数;S_a,Si-分别是第i-2,i-~1次迭
代的反眼积误差,i乏3;ll-lI表示L2范数;1,z=10,D。
从公式(6)、(7)可以看出,y的取值会随着迭代
过程中图像的信噪比和反卷积误差动态变化,以在
复原质量和收敛速度上平衡。准确计算退化图像的
信噪比较囱难,但在实际应用中有学者给水了一些
近似估计并被证明可行,文中采用邹谋炎的估计方法。
2.3边缘平滑
图 像 边缘对像素分布的连续性产生了砾坏,因
此,平滑边缘可以政善边绍处的连续性进而降低复
原图像中的振铃效应。
对图像户的边绍使用Canny算法进行检测,得
到二值边缘图像B(边缘像素值为1,非边缘像素值
为0)。采用大小为3x3的结构元素对B进行膨胀操作
得到边缘区域E:,则边缘图像e可以由公式(8)得到:
为减小图像巾中边缘区域像素值的跳变,需对
边缘区域进行适当的平滑以使其梯度帽值净小。文
中使用均匀源波器平滑边缘区域以得到边缘平滑后
的起始复原图像户「:
2.4复原图像
将辨识到的降晰函数R及边缘平滑后的复原图
像起始估计户代人增量Wiener滤波器进行迭代复
原。复原过程中可以设定迭代次数准则或图像质量
改善量准则作为算法的终止条件。
3实验结果与分析
为验证算法的有效性,文中在Intel(R)Core(TM)
2.80GHzCPU,2.0G内存的硬件环境和Windows
XpSP3操作系统,MATLABR2010a软件环境下进
行了实验。复原前采用MATLAB中的Edgetaper函
数处理图像边界以抑制边界振铃。
实验中用到的参考图像如图1所示,图1大小
为320x240,实验采用信噪比改善量(Inctemental
Signal-to-Noise Ratio,ISNR) 0 、 振 铃 测 Bf (Ringing
Metric, RM)! 、 特 征 结 构 相 似 度 (Features Similarity
Index,FSIM)04等图像质量评价指标衡量复原算法
的性能。ISNR表征了复原前后闸像相对原始囹像的
信噻比改善情况,数值越大则复原图像的信嚣比增
益越大,图像质量越好。RM搅述了振铃效应的强
度,其值越小算法抑制振铃的效果越好。FSIM度量
了复原图像与参考图像在特征结构上的相似程度,
数值越接近1,复原图像质量越好。
首先进行了不同噪声级别下的对比实验,退化
图 像 采用7x7的高斯核(a=5)进行模糊,并加人不同
级别的零均值高斯户噪声,实验结果如图2和表1
所示。图2中第1行为不同噪声级别下的模糊图像,
国2不同噪声级别下吊种算法复原结果
Fig.2 Comparison of deblurred images with different noise variance
从左至有方差依次为104,103和102;第2~5行分别
为 迭 代 盲 复 厚 算 法 (Iterative Blind Deconvolution,
IBD) 、 肖 复 原 并 Fuzzy 滤 波 I“1(Fuzzy Filtering ,FF) 的
去振铃算法、增量Wiener滤波算(Incremental
Wiener,IW)和文中提出的堀于边绍平滑的改进增量
Wiener 滤 波 算 法 (Edge Smoothed IW ,ESIW) 的 复 原
结果。实验中每种算法都迭代50次。
表 1 实验1中复原图像的质量评价
Tab.1 Image quality assessment of restored
in experiment 1
IBD 4.290 2 0.303 4 0.8435
10
IW 5.662 8 0.239 8 0.871 5
ESIW 5.844 6 0.182 8 0.880 6
IBD 4.054 0 0.306 9 0.837 5
IBD+FF 3.7076 0.2415 0.8550
10°
IW 5.567 5 0.236 9 0.8703
ESIW 5.691 9 0.176 0 0.878 4
IBD -4.332 0.428 7 0.6121
10-2
IW 2.4680 0.2808 0.7839
ESIW 2.6451 0.2523 0.7898
从图2和表1中可以看出,当图像的模糊信号
噪 声 比 (Blur Signal-to-Noise Ratio,BSNR) 较 高 时 , 几
种算法的复原效果都比较好,而文中提出的ESIW
算法具有更好的复原效果。随着BSNR的降低,儿种
复原算法的效果都有所下降,由于IBD算法会放大
噪声,故其复原图像的质量最差;Fuzzy滤波器能够
抑制振铃和噪声,降低源波后图像的振铃效应,在一
定程度上提高了图像质量;增量Wiener滤波由于引
人了规整化项,对噪声有一定的抑制作用。与传统
增量Wiener滤波算法相比,文中算法由于对边缘进
行了平滑,振铃效应有明显下降,图像质量(ISNR,
FSIM)也有所提升。在各种BSNR条件下,文中算法
对振铃效应都有明显的抑制作用,复原图像的振铃
测度值都低于其他三种算法复原的结果。
3.2淌流退化红外图像序列实验
为了验证复原算法对红外目标跟踪算法能力的
影响,文中进行了红外退化图像序列的复原实验。图3
是标目标场景的红外图像序列中的第3帧,225帧、
255帧.300帧和365帧,两面的分辨率为320x256。
图 3 中(a)~(e)为复原前退化图像,(f)~(j)为使用文中
方法复原的对应图像。为验证图像复原对目标追踪
精度的影响,使用BeyondSemiAdboost跟踪算法0
对复原前后图像序列中的指定目标进行追踪,图3中
黑色边框内的区域为追踪目标。第225帧退化图像
(两图3(b))由于追踪时丢失了目标,故没有黑色边
框划定的区域。为了更准确地标识目标追踪的精度,
图 4 给出了各帧追踪的偏移误差,图中Z轻采用了
半对数坐标系。由于退化图像序列中存在跟踪目标
丢失的情况,退化图像序列的跟踪误差曲线在第
224~227帧之间存在间断。
从图3和图4中可以看出,复原后图像的噪声
得到了抑制,图像清晰度得到了提高,目标追踪的精
度也大大提升EERERRS,,场景发生较大变
化,追踪算法仍能够准确地跟踪目标。
为了比较各种算法的时间复杂度,表2给出了
各种算法在相同迭代次数条件下复原同一帽(帧)图
像的时间消耗。从表中可以看出,文中算法消耗的时
间远小于IBD算法;相比IW算法,文中的算法也仅
多消耗了0.1s。因此,文中算法的实时性优于迭代盲
复原算法。
表 2 各算法时间复杂度对比(单位:秒)
Tab.2 Time complexity comparison of the
algorithms (Unit:s)
Image IBD IBD+FF IW ESIW
从以上两组实验的结果中可以看出,与IBD方法
和Fuzzy滤波去振铃算法相比,文中算法能够更好地
抑制振铃效应和提升复原图像的质量。与增量Wiener
滤波算法相比,采用边缘平滑技术后,复原图像的振
铃得到了减少,图像质量得到了提升。同时,相比迭代
育复原算法,文中算法也具有更好的实时性。
4结论
采用迭代盲目反卷积算法复原湍流退化图像
时,由于降晰函数估计的误差常导致复原图像中存
在大量的振铃,而算法的运算复杂度也难以满足实
时性要求。文中提出的基于改进增量Wiener滤波器
的方法,为淌流退化红外图像的复原校正提供了一
种新的思路。仿真实验结果表明,文中算法能很好地
降低图像复原后存在的边缘振铃,图像的视觉质量
和各种客观评价指标都得到了明显改咤,同时算法
具有较好的实时性。
