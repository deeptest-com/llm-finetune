基于粒子滤波和似然比的接收机自主完好性监测算法
由于粒子滤波算法在处理非线性系统非高斯噪声问题具有较大的优势,提出将粒子滤波算法与对数似然比方法有机结合应用于接收机自主完好性监测（Receiver autonomous integrity monitoring,RAIM）中。通过粒子滤波算法对状态进行精确估计,利用对数似然比建立一致性检验统计量进行故障检测。在建立全量累加对数似然比和部分累加对数似然比检验统计值的基础上,通过比较系统各状态累加对数似然比和检测阈值之间的关系,进而对卫星故障进行检测。对算法进行了数学建模,描述了RAIM算法流程。通过实测数据对提出的RAIM算法进行验证,结果表明：粒子滤波在非高斯测量噪声情况下可以对GPS接收机状态进行精确的估计,利用对数似然比建立的一致性检验统计量能有效地检测并隔离故障卫星,验证了该算法应用于接收机自主完好性监测的可行性和有效性。

GPS 接收机自主完好性监测 粒子滤波 似然比 故障检测  

ch,
借息可靠性不受影响。随着全球导航卫星系统
(Global navigation satellite system, GNSS) 的 发
展以及用户对于GNSS服务性能要求的不断升
级,完好性监测日益受到重视。由于通过卫星导航
系统自身的操作控制部分进行卫星故障监测时,告
警时间比较长,通常在15min到儿小时,不能满足
航空导航需求,因此在用户端对卫星故障进行快速
agi3E丨]擅妾l'丨文机自主〕′宅好′丨生监素乒卫‖(Receiverautono-
mous integrity monitoring, RAIM) 成 为 研 究 的 热
点。RAIM是一种基于一致性检验的自主完好性
监测方法,它通过对冗余观测信息的检测来判断测
量结果中是否含有较大卫星距离误差,当系统性能
超出指定的容差级时,它能实时有效地给用户提供
告警信息“。
目前,RAIM算法包括两大类:一类是利用当
前伪跋观测量的快照算法;一类是基于卡尔曼滤波
的RAIM算法。在故障检测和排除算法中,传统
的广义似然比方法基于高斯白噪声假设,比较简单
而常用的是快照算法,由于其具有不需要外部支持
设备反映速度快、容易实现等优点,目前得到了广
泛的使用。快照算法主要有奇偶空间法、最小二乘
残差和法和最大间隔法等。奇倡空间法和最小二
乘残差和法在检测准则上是等价的。卡尔曼滤波
算法利用历史观测量来提高效果,对先验误差特性
依赖性强,而实际误差特性很难准确预测“。而
且,卡尔曼算法要求测量噪声服从高斯分布,而在
实际中测量噪声很难严格服从高斯分布“1,因此算
法的性能就会降级.。
为了解决上述算法对噪声分布要求的限制,本
文将粒子滤波引人到接收机自主完好性监测中,提
出将基于对数似然比(CLog-likelihoodratio,LLR)
方法的粒子滤波算法用于故障卫星检测,通过实测
数据对提出的RAIM算法进行仿真,验证了该算
法能有效地检测并隔离故障卫星,证明了其在
RAIM中的可行性和有效性。
1“用于故障检测的粒子滤波算法
故障检测是指对被监测系统故障的存在作出
判断,故障隔离是指对系统故障的类型作出判断,
并剔除故障。
粒子滤波可以较好地适应观测量出现异常突
变的情况,适用于非线性、非高斯系统,对系统的过
快速增长“,因此,可将粒子滤波用于故障检测中。
Gordon提出基于藩特卡罗方法的序贯重要性重采
样粒二滤波算法以来“,粒子滤波成为非线性非高
斯系统状态估计问题的一个研究热点,广泛用于自
动控制、导航、跟踪等研究领域,并应用于动态系统
的故障检测等问题“““1。粒子溏波算法中的重要
性权是追代计算的,为了有较好的估计效果,重要
性应接近真实的状态后验分布,因此重要性权的方
差越小越好。但重要性权的方差随着时间增大,经
过若干次迭代,栋个权可能趋于1,其余的权都趋
于0,从而对后验概率密度函数的估计不起作用,
造成了权值退化现象。退化现象是粒子滁波最常
见的问题,理论上可以尽量采用大的粒子数,实际
操作中,一般选择好的重要性密度和重采样的方法
来提高粒子质量。选择好的重要性概率密度分布
函数需要全面考虑源波性能与计算复杂度之间的
关系。重采样可抑制粒子的权值退化,文中选择重
采样的方法来解决退化问题。
假设描述动态系统的状态方程和观测方程可
表 示 为
必 g =`′(`(`Z`/z_-1 ，′Z//z_1〉
又 h =h(x, $M)
KFxz分别为系统的状态向量和量测向量;丁
为状态转移函数;为状态量与观测量之间的传递
函数;vx和s分别为系统噪声和量测噪声“27。
设k一1时刻有一组后验粒子集,(tze-1(DD),
wr()si=1,2,,N},其中N为粒子数目,
zx-1(日为&一1时刻的第TRFro(DREk]
时刻第;个粒子的权重。基于序贯重要采样的粒
子滤波的步骤为:
(1)粒子集初始化,*二0
根据先验概率密度p(X)抽取随机样本,
X,又吊,,又0(CN为随机样本数)。
(2)当k二1,2,..时,执行以下步骤
@〇状态预测。根据系统的状态方程抽取*BF
刻的先验粒子
{Xp1(D):i=1,2,,N} ~ p(X, | 友 1 》
@更新。首先,进行权值更新。在获得测量值
之后,根据系统的观测方程计算粒子的权值w为
w =e p(Zi | X 红 ) 二 N 。 )
归一化权值为
然后,计算有效粒子数N。t,并与设定的阎值
Nam进行比较。计算有效粒子数目为
N,
式中:有效粒子数目的阎值一般选择为总粒子数目
的 2/3, 即 Nines =2N,/33 MFR Nst 一 Nus, 则 对 先
BRFEXo)进行重采样,得到N个等权
值的粒子(文品_,,方。否则,执行以下步骤:
@估计。计算当前时刻系统的状态估计值
友一1X纹u(4)
@将g=k十1,转到步骤(2)。
2“新RAIM算法及流程
RAIM算法包括卫星故障的检测与隔离。检
验统计量是利用测量值计算,应尽可能近似地描述
故障。检测门限是认定系统为故障的检验统计量
的值,根据要求的误警率求得检测门限。
本文采用基于粒子溏波算法和LLR的RAIM
算法来实现卫星故障的检测和隔离。即利用粒子
滤波对系统的测量值进行处理,计算各个时刻对应
的LLR,并将窗丽数内各时刻的LLR进行累加,
得到此时刻所对应的累加LLR,进而得到检验统
计量;然后,对检验统计量进行一致性检测,根据故
障所引起的一致性的变化来检测故障发生时刻,实
现对故障卫星的检测。
2.1“系统模型
系统的状态方程为
式中:万一[r:,r,,rs,A]rer,r.为接收机的三
维位置,AS为接收机相对于GPS卫星时间的误差
偏移;专为转移矩阵,在静止状态下为单位矩阵;v
为过程噪声。
GPS信号包挠时钟信号和导航信息,GPS接
收机接收到的信号受到噪声和其他误差源的干扰,
包括星历误差、电离层误差、多径误差等““GPS
接收机测量伪距方程可以表示为
式 中 :p;(&) 为 接 收 机 (r: ,r7,,r7:) 与 第 5 BILE SL,
史,史)之间的伪跚(m);c为光途(m/s);A8为接收
机时钟与卫星时钟相对于GPS时的时钟偏差(s);
E'为星历误差的影响(m)y;了为对流层延时(s);e
K =r, 一 弘 广 十 ry — 8) t\r,—s;) (0)
2.2“对数似然比检验统计量
对数似然比是一个随机变量y的函数“,定
义为
式中:ps(y)(i一0,1)是以ai为参数的概率密度函
数。
将LLR检验定义为各辅助粒子溏波和主粒子
滤波的概率密度函数之比,表达式为
量测量vy,到y*的累加LLR可以表示为
由于系统状态估计的似然离数可用粒子滤波
中粒子的归一化权值近似表示,故式(9)中的
口 ? (y; I Yo) #0 pt (y: Y. 1) CIE]
偿设当前用于定位解算的卫星数目s一6,并
假设其中有一颗卫星出现故障。为了检测故障卫
星,需要Q二s十1个粒子滤波,其中,1个作为主粒
子滤波,其余的s个粒子滤波作为辅助粒子滤波。
主粒子滤波的作用是处理所有颗卫星的测量值以
计算系统的状态估计;s个辅助粒子滤波是在依次
去除s颗卫星中的一颗卫星的测量值后由其余观
测值计算而得到对应的状态估计,计算结果用于
LLR并进行一致性检验。
基于粒子滤波和LLR方法的故障检测原理框
图 如 图1所示,GPS接收机输出6组量测数据,即
y二[y:,ys,“..,yse]“。图中的主粒子源波用于处
理所有的6个量测值对系统的状态z“和概率密
度函数p“(y)进行估计,同时,其余6个作为辅助
粒子滤波处理6个量测值中的5个,以计算状态估
计2(@=A,B,...,f)和对应的概率密度函数
PU,通过计算神加LLR的方法进行一致性检
测。各个粒子滤波的量测矢量表达为
邹 (8) 二 [y: “ys 2s yi “ 35 ys]
班 ( 二 [ys ys ys 3 e
趴 ( 二 [y! 3s vs ￥5 Ye]
跋()二[y!3￥3￥s]17
.}，乏=〈/燮)=_二.)′123Ys-)′′5〕′l'
从上述各粒子滤波输人的量测值表示式中史
以看出,当一颗卫星发生故障时,6个辅助粒子滤
波中的1个不含故障卫星的量测值,即在一致性检
测中,至少会有1个超出告警的阚值。
图 1 基于粒子滤波和LLR方法的故障检测原理框图
Fig. 1 Failure detection structure diagram based
on particle filter and LLR
2.4新RAIM算法流程
根据接收机所在坐标(rs,y,,r:)产生N个主
粒子滤波的初始粒子{z4(53:i一1,2,…,N}和辅
助粒子滤波的初始粒子{z8(i5):i二1,2,…,Mj
Zz“(刀一性(吊。每个时刻《重复以下步骤:
(1)状态预测。将{古(i二1,2,…,X)和
{28(D:i二1,2,,N}分别代人式(5),得到粒子
预测值zf-1(山和zfla-1(力。
(2)计算粒子权重。将粒子预测值=(0,
Zzflx-i(刀和第;颗卫星的位置坐标(sssys)UR
时间误差AC等代人系统量测方程,得到预测的第
wi (DF wid), “
(C3) 计 算 LLR
数。
(5)故障判决。如果B二r(r为判决阙值1,故
障告警设置为t一t时刻并跳转至步骤(6);如果
A一r,则表示没有故障,跳转至步骤(7)。
(6)故障检测。在k~>t下,取出Q颗卫星中
累积LLR最大的卫星子集。
(7)状态更新。柯子溏波重采样得到更新粒
子。
3“实测实验与结果分析
3.1“实验条件
为验证算法的故障监测性能,通过实验对本文
提出的算法进行分析,实验中使用带原始观测数据
输出的接收机N220获取实验数据,观测的数据包
括用于接收机位置解算的卫星的位置信息和伪跚
值,从采集的测量数据中截取418s的数据。在此
期间,有6颗用于定位解算的卫星,卫星编号分别
为3,15,18,19,21,26,对应的伪距量测值表示为
薹'=(-)′1，-)′2，-)'3，-)′4薹，二〉'5，`′〉'(窟〉。同[…=`_'，矛c_`丨逻…_弓RCB-4H
接收机模块监测得到此时用于定位解算的这些卫
星无故障,定位处于正常可靠状态。为了模拟验证
某颗卫星发生故障时,算法是否能够对故障卫星进
行正确检测,人为地加人偏差,这里,对用于解算的
第19号卫星在90一152时刻注人50m偏差作为
阶跋类型的故障。在实验中,粒子数N二100,计
算判决函数的窗口长度选为30。在&时刻通过统
计检测量B*与预先设定门限值x的比较,进行故
障检测。如果8一r,则时刻检测无故障;反之,
系统有故障,则进行故障卫星的识别。此时即完成
*时刻的故障监测,此后滑动窗向前滑动一个时刻
按照同样的方法进行下一时刻(&十1时刻)的故障
监测。卫导系统用于航空时需满足一定的完好性
需求,实验中门限参数根据航空无线电技术委员会
制定的卫导系统应用于民用航空飞行时完好性保
障方面的最低运行性能标准L选取。
库 占 小 受 谚 政 碳 tb&Xxtended Kalman filter, EAE)
算法和基于粒子滤波的完好性监测算法对采集的
实验数据分别进行处理。图2,3给出了正常情况
下采用粒子滤波的完好性监测算法和采用EKF的
完好性监测算法用于故障检测和隔离(Faultde-
tectionandisolation,FDI)的判决函数检验统计量
和累加LLR。图4,5给出了加人阶跃故障后的检验
统计量和粒子滤波算法下的完好性监测实验结果。
从图2可以看出,在没有故障发生情况下,采用
粒子滤波的FDI算法的判决函数比采用EKF的
FDI算法的检验统计量值波动较小,其值&小于故
障判决的阎值r,降低了故障检测的虚警概率。
从图4,5可以看出,在人为加入偏差后,每组
的结果都发生变化,基于粒子滤波的FDI算法在
警时间有一定的延时。而采用粒子滤波的FDI算
法判决函数B的跳变高于采用EKF的FDI的8
跳变幅度,提高FDI的灵敏度。并且依据前文描
述的最大似然准则,可判断出故障卫星为19号卫
星,这段时间内在利用卫星数据进行定位解算时应
当舍弃19号卫星的观测数据,为定位结果可靠性
提供保障。
粒子滤波的序贯重要性采样方法经过若干次
迭代后造成权值退化和多样性丧失。仿真中选用
粒子样本数目为100,计算得到的平均有效粒子数
目为17.8779。从滤波状态估计的均方根误荣
(Root mean squared error, RMSE) 参 数 来 看 , 粒
子滤波算法的RMSE较EKF算法的RMSE小,
进而在进行接收机自主完好性监测时,提高了检测
的精度。两种算法处理后的参数对比如表1所示。
算法疆昌一霰菖「RMSE
EKF 15.637 51
粒 子 滤 波 100 17. 877 9 7. 453 75
这里,粒子源波的有效粒子数目采用式(3)计
算,RMSE的表达式为
出用于GPS接收机自主完好性监测的方法,建立
了故障检测的检验统计量,对故障检测的方法进行
了描述。通过利用GPS接收机实验平台采集实测
数据进行验证分析,结果显示:该方法在非高斯量
测噪声环境下可以对卫星故障进行检测和隔离。
实验表明了基于粒子滤波算法与LLR的RAIM
算法的可行性和有效性。
