机载多跳波分复用网络时间确定性分析方法
波分复用技术有望应用于航空电子系统的综合化互连,特别是传感器前端处理部分的实时网络互连。根据机载多跳波分复用网络的关键部件波长路由器的结构,对实时通信流量特性和优先级排队的服务特性进行建模,给出突发度、服务时延等参数指标的计算方法,并在高优先级时间触发流量的压力下,提出了在机载多跳波分复用网络中事件触发流量的最坏情况下,端到端延迟的网络演算方法;使用该方法计算得到的结果可以作为机载波分复用网络时间确定性分析的依据。将最坏情况下的分析结果与软件仿真结果相对比,发现两者变化规律相符,验证了该方法的有效性。

波分复用网络 航空电子 实时系统 流量特性 网络演算  

0引言
综合化的航空电子系统采用系统工程方法,在飞
机物理结构空间中将探测、通信、导航、识别、电子对
抗、任务管理、《行控制和火力控制等功能及相应的电
子设备通过机载网络君软件等技术组合成为一个有机
的整体,能够有效地利用处理和通信资源,以较少的
软、硬件代价获得更完善的态势感知能力。美国F-35
战机的航空电子系统具有传感信号综合和统一网络互
连的特征,是当今先进综合式航电系统“的范例。
在航空电子前端的信号处理部分,需要能够支持
高带宽、大数据量的模拟和数字信号通道,例如合成孔
径雷达和电子战探测各具有Gbivs量级的实时通信需
求,多方位的光电传感器各具有几百Mbitxs以上的实
时通信需求,对于信号的延迟和时延抖动具有严苛的
要求。与采用虚拟通道逻辑隔离的航空电子光纤通道
(FC) 技 术 相 比 , 波 分 复 用 ( Wave Division Multiplexing,
WDM)光互连提供单根光纤上物理隔离的多条信号传
输,使共享每条物理链路的通信流量数月不至于过多,“存在广义增函数B(t),且B(0)=0,当且仅当Ys<t,
降低了多路复用排队延迟的变化范围,可以更有效地
满足信号前端的实时互连需求,并使传感信史综合处
理和网络化控制的品质得以提升。
早在1999年,国外学者就探讨了WDM技术航空
电子应用的问题“;近十年来,该项技术在军用通信领
域逐渐得以发展;文献[3]研究了ROBUS,Clos和多级
交换等光交换结构的适用性;近五年来,在国内外的航
空电子领域则全面开展了WDM实时通信的调度、流
量管理和性能评价方法研究“。
先进综合式航电系统的复杂程度很高,需要依靠
最坏情况分析技术在设计阶段保证综合化的性能。确
定性网络演算方法““及其扩展(共轰演算等)是一种
适用于实时网络端到端延迟上界计算的方法,本文采
用这种方法对于信号前端互连应用背景下多跳波分复
用网络的端到端时间确定性参数进行分析计算,得到
适用于这种基于WDM的新型高速互连技术的实时性
能评价方法。
1网络演算原理
网络演算理论将具体的网络拍象为几种简单的网
络元件一一固定延迟线、接收缓存、解多路复用器、多
路复用器(Multiplexer,MUX)、流量调节器等,其中,实
时流量所属的消息在最坏情况下的延迟分析的关键是
MUX排队造成可变延迟的界限。
在网络演算理论中,还采用min-plus异构代数的
形式定义运算符,其中重要的min-plus卷积运算符
“@“的定义为:对于任意定义域为!关0的广义增函数
%(口和y(古,且设它们在f<0时候为0,存在x(i)@
y(=inf[x(s)+y(t-5)]。在求解网络时间参数的
过程中,z(My)的卷积结果也可以写成以;为自
变量的函数形式(x@y)(6)。
采用到达曲线描述进人MUX流量的突发度约丛,
采用服务曲线描述以MUX为核心的实时通信服务质
量(Qos)保证能力。如果考虑带有优先级排队系统,
可以将高优先级流量对当前流量的影响折算为预留的
服务能力,体现于服务曲线模型中的休假时延参数中。
到达曲线.服务曲线,以及在网络演算模型下单级时延
界限的定义如下所述。
定义1到达曲线。对于定义域为f之0的广义增
函数a(),对于流量的累积量函数T(t),当且仅当
Vs<t,I(t)-TCs)世a(t-s)时,a()可以作为流量的
到达曲线,且使T(t)<(I?a)()恭成立。
定义2服务曲线。对于具有输人和输出二端口
节点,输人输出的累积量函数分别记为TCt)和0(1),
0(t4)-T(s)2B(t-s),8()可以作为节点的服务曲
线 , 且 使 0(4) =(IQB) (+) BRL.
定义3延迟界限。设流量的到达曲线为o,HA
服务曲线为6的二端口节点,则时延4的上界为:d4不h
a和B绘制到同一坐标系,则A(a,8)为两条曲线之间
水平方向偏差的最大值。
常用的到达曲线模型为(,p)形式,即a(t)=
o+pt,KP,0为突发度,p为史持续速率。常用的服
务曲线模型为“速率一时延“模型,即8(t)=rx
(t-7)“,其中,r为传输流量的服务器速率,7为服务
的休假时延。
在综合化网络中,可以为不同类型的流量设置多
优先级。WDM网络虽然在传输中物理隔离,但一方面
考虑到全光交换还没能完全实用于航电系统,另一方
面实时通信需要在“光电一电光“转换的交换节点实
施调度策略,因此需要考虑当高优先级流量注人时的
网络演算方法。
以二级静态优先级为例(见图1),高、低优先级的
到达曲线参数分别设为(,p1)和(u,pn),丁为已
知;服务曲线参数分别设为(ru,7t)和(rn,Tr)。其中:
T=0,表示服务器为高优先级流量立即服务(对于一
般的网络,会考虑由于当前发送的消息不可抢占,令口
等于转发最大消息帧的时间,但本文的研究对象不做
此假设,具体原因在下文说明);考虑一定的资源冗余,
r一般取略大于p的合理值。设物理链路的容量(即
码速辜)为C,则
式中,h表示由优先服务而造成的延迟。
对于输人流量(,,px)和服务能力(rs,7,)的配合
(其中,为I或IL,表示优先级编号),可得延迟界限为
d,=T, +0,/r0
对于多跳复用网络,端到端的延迟不是各个节点
延迟的累加,还必须考虑接受服务后流量特性的变化,
在多跳路径上不进行重新整形的情况下,输出流量的
突发度会增大。存在o.,(1)=a;(t+4),其中,j为跟
数,4为在第跳节点的延迟。
计算最坏条件下的延迟可以考虑“突发度一次性“
原则0;例如在图2中,对于给定流量人,在MUX,上的
其他流量突发度对它的最坏情况下延迟的影响只发生
在这一级,不用在下一级重复考虑,即使有比它优先级
高的流量也是如此;因为在物理链路上,这些已经聚合
的流量被“申行化“,属于各条流量的消息帧互不干扰;
在下一级的延迟计算只需考虑新接人的流量对它的影
响。考虑这种原则后,可以缓解延迟界限的保守性。
波长路由器,它集成了电层和光层路由器的功能,底层
考虑两级优先级的惧况,给定在WDM网络中高
为光交叉连接(0XC),构成不同的波长通道集合嵌人
物理拓扑从而形成可重构虚拓扑,并可扩展物理端口
的数量以支持多点互连拓扑;上层的电层负责将消息
流在虚拓扑的波长通道上路由,支持多传议。每组传
感信号处理模块全双工接人(可以通过光纤,也可以使
用电路连接)到就近的波长路由器,波长路由器之间一
般形成环形或带有冗余通道的环形结构。
波长路由器的结构如图3所示,不同波长通道上
的流量分为3种:本地接收、不变子波调制直通,以及
需要经过光电转换后经过路由组件、MUX后重新调制
后转发;对于多跳端到端传输的网络演算主要针对第
3种流量。消息流端对端延迟可以表示为
式中:d,,为物理信号传播延迟,一般可忽略;d.根据网
络演算中的组件分解方法“由每跳的延迟累加得到。
星然组件分解方法与求整体服务曲线方法相比,可能得
到更保守的解,但易于编程实现,并可通过合理折算服
务器休假时延了的措施加以缓解。在各跳的延迟中,有
固定的技术时延,它们是“光电一电光“转换和存储转发
的开销,可变时延主要体现于多路复用排队上。
在多跳WDM网络上的网络演算模型需要对图3
所示的模型进一步抽象,其中,固定的路由“光电一电
光“转换开销被抽象为恒定延迟线。波长通道转发排
队被抽象成FIFO的多路复用器,如图4所示。
设计的时刻调度表精确控制各跳出现的时刻,低优先
级为异步的事件触发(ET)消息流。借鉴TTE网络标
准古的精确全局定时和“多孔调度“机制“01,离线设计
FEETHET消息预留的空隙,也考虑了足够的保护
间隔使TT消息发送时不会有ET消息正在接收服务。
如图5示意性说明了形成ET孔隙的过程,首先进行先
验调度得到可行的TDMA调度方案,随后进行后验调
度将TT消息在时间轴上分散开,并考虑所谓“调度解
释“(网络交换设备对TT消息和ET消息的衔接关
系),正是这些先验的完整性控制机制,使得高优先级
的服务曲线延迟参数7!=0,而高优先级对低优先级服
设周期性的ET流量以二元组(Z.,P;)表示,其中,
L为所属消息的最大长度,Pi为消息流的周期;对于非
周期流量,可用最短可能发生间隔等效为周期,在演算
中作为周期消息流考虑。设波长路由系统中的流量集
合为=if忍尖,...|,每条消息流的(c,p)形式的到
达曲线为
式中:下标“计表示流量;由于经过一级排队,到达曲
线会发生变化,下文中将采用ai,表示流量人在第}跳
输人端的到达曲线模型。
为了求解消息流在波长路由器排队的可变延迟界
限问题,将采用FIFO多路复用的服务曲线定义为
式中:R为总速率;7;为本级服务器的“休假“延迟。
设本级高优先级流量的总突发度和总速率分别为z,
Mops, , 则 有
′…j=C`_p芝，贞(5)
式中,C为每个子波通道的物理码速率,而式(5)的含
义在于,如果服务器已经以pz,的码速率持续传输高优
先级流量,这时又有rs,的高优先级突发流量到达,将
造成对低优先级流量的最大延迟。在实际工况下,路
由器对于数据帧的延迟还应该包含固定的技术时延,
但本文采用的分析方法将延迟的先验已知部分和可变
部分分开考虑(如式(2)),只需在网络演算完成后将
前者神加人端到端延迟即可。
2.2“最坏情况下的延迟
最坏情况下的(可变)延迟怠到达曲线与服务曲
务质量的影响完全可以折算到服务曲线的参数7u和
r,如式(1)所示。本文主要计算ET流量在最坏情况
下的端到端延迟,在不引起歧义的情况下,下文中省略
表 示 优先级的脚标。
到数据帧经过单级转发的最坏情况下的延迟为
So.
突发度。
由于多路复用器的缓存作用,增加了输出流量的
最坏情况下的突发度,下游排队的到达曲线变为
a. (t) =a, (t+d) = (0, +p," d) +p,“ t 。 (8)
端到端延迟由各跳的最坏情况延迟之和再累加传
播延迟和技术延迟而得,如式(2)所示。
3“室例研究及仿真验证
抽象于典型的航空电子WDM网络,设定含有5个
波长路由器的案例,如图6所示。
图 6 航电WDM网络案例的拓扑结构示意图
Fig.6 Case study-Topology of an avionics WDM network
图 中 光纤为单纤双向系统。每条光纤支持粗波分
复用共4条子波通道,每个波长路由器配有2个发射
机和2个接收机端口,史向有物理连接的路由器发送
一定流量特性的流量。每个波长通道的物理码速率为
1Gbitxs,采用两级优先级排队,高优先级安排给TT流
量,低优先级为异步的ET消息流提供FIFO多路排队
服务。不失一般性,演算和仿真均设固定延迟为0。
为了使光电交换机简易实现,设ET消息的长度是
定长,为1536bit(合192Byte)。根据波长路由器的结
构(见图3),除了本地接收、不变子波调制直通的流量
之外,案例中需要多路复用排队的流量为9条,其参数
如表1所示。流量的路径根据航空电子应用的需要决
定,是静态配置的,并不一定是最短路径。
表 1 _航电WDM网络案例的事件触发流量配置
Table 1 The configuration of event-triggered flows in
the case of an avionics WDM network
fi 50 2S SoS 。 c 万 伟
再 S02 Sy SoS, aSa aS
fo 100 2 【 82 8,08 8,55, 图 So
各节点为高优先级流量预留的突发度和可持续速
率,如表2所示,在表中两种参数都以物理码速率C迢
行了归一化,使前者转换为时间值,后者转换为比率。
根据式(5)和式(6),在表2中还给出低优先级速率的
剩余比率,及其服务曲线“休假“的时延。
表 2 航电WDM网络栾例的时间蛮发流量参数
Table 2 The parameters of time-triggered flows in
the case of an avionic WDM network
S0 一 4 0.6 0.1 0.9 0.67
S1 $—S 0.4 0.08 “ 怀 0.92 0.44
Sl 一 S5 0.4 0. 08 0.92: 0.44
S 一 54 0. 2 0. 04 。 0.86 021
S, $,—S, 0.4 0.08 0.92 0.44
5 一 83 0.2 0.04  . 0.96 0.21
Ss S38, 0.2 0.04 , 0.96 0.21
S, “ S4d 一 S9 0.4 0.08 , 0.92 0.44
高优先级的TT消息是静态配置的,不会出现属于
不同流量的消息同时突发到达的情况,其突发度可以粗
略地等于最大可能的数据帧的长度,如果希望更精确地
确定该参数,可以记录整个集群循环“内的流量累积量
A(t),利用网络演算中到达曲线的性质进行求解,即a
(1) = AQ) ? A(t) =supuzoth(t +u) Au) i , 养 中 ,
幻为min-plus代数的解卷积算子。图7给出了这样一
个例子,图中黑色虚线为经过解卷积演算得到的阶梯状
的到达曲线,该曲线在“关键时刻“t=0的取值作为等效
突发度,粗略估算的突发度与之近似相等。值得说明的
是,如果这时对TT流量进行(r,p)模型的包络(图中的
点化线),会得到保守的窝发度估计(图中的G),这是一
种“更坏“的情况,蛎然演算公式完全成立,但是会造成
计算得到的延迟界限过大。
际案例中的窍发度和速率预留仍以表2数据为准。
图 8 展示了这9条EKT流量的虚拟链路(Virtual
Link,VL)拓扑结构情况。根据流量参数和网络演算原
理进行计算,并累加上技术延迟(每跳路径转发处理
0.2us),得到的各条流量最坏情况下的端到端延迟如
表 3 所示。
图 8 航电WDM网络案例的虚拟链路的拓扑
Fig. 8 Case study-Topology of VLs in an avienic
WDM network
最坏情况分析对于把握实时通信的确定性具有重
要的作用,但为了了解网络工作的动态情况,可以采用
离散事件仿真的方法。利用OPNET网络仿真工具,开
发相应的节点层、模块层和过程层的航电WDM网络
模型,在相同的场晋和参数设定(见图6、图8,表1~表
3)下进行仿真,每次仿真时间长度5.1s,重复仿真100
次,排除仿真肢动时0.1s时段的野值,取平均得到的
“一一一一一一-一
结果如图9所示。
表 3 航电WDM网络案例的最坏情况下端到端延迟
Table 3 The worst-case end-to-end delay values
in the case of an avionic WDM network
图 9 航电WDM网络案例的演算与仿真数据对比
Fig.9 Case study-A comparison between network
calculus and simulation results
从图9可见,仿真演算结果明显低于最均情况,这
是正常的体现。因为最坏情况对应的发生概率在10“
之下的稀有事件,常规仿真难以穷尽各种可能达到这
种状态。另外,虽然在仿真中限制ET流量,使之不能
RATT的时间窗口,造成等待延迟,但由于高优先级
流量参数也是在最坏情况下给出的,平均的延迟时间
也低于最大值。
但是,对比图中两组数据可以发现,各条VL仿真结
果的相对情况符合各条最坏情况下的变化趋势,在一定
程度上印证了本网络时间确定性分析方法的合理性。
4“结论
本文提出了航空电子WDM网络配置下ET流量
的端到端最坏情况流量的演算方法,在算法中,考虑了
网络互连中含有离线设计的TT流量的情况,也发展了
TT流量和ET流量分别为高低优先级情况下后者的服
务曲线的参数设计方法。
上述方法为衡量波分多路复用条件下ET流量时
间确定性建立了理论与方法基础,经过对设定的案例
进行验证,亚与运行时的软件仿真结果相对比,说明了
该方法的有效性。
未来将尝试利用轨迹法等方法,进一步提升最坏
情况下延迟界限的紧致程度;另一方面,拟引进重要性
采样等加速仿真方法,使软件仿真也能在有限的时间
内对网络互连最坏情况下的表现进行模拟。
