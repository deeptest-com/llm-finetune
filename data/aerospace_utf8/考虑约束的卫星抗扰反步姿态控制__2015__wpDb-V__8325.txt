考虑约束的卫星抗扰反步姿态控制
针对具有不确定性、外干扰及饱和约束的卫星非线性姿态跟踪问题，将约束反步法与状态观测器相结合，提出分块自适应抗扰反步控制器。卫星模型由修正罗德里格参数进行描述。利用带参数投影的非线性扩张状态观测器对时变的“总干扰”项进行在线估计补偿，以提高反步控制器的鲁棒性。在设计反步控制器时，引入指令滤波器和修正跟踪误差信号以施加系统状态和执行器的饱和限制，同时较容易获得虚拟控制导数，并且放宽了干扰估计律投影算子的投影集范围。Lyapunov理论证明了闭环系统在非线性阻尼的作用下输入-状态稳定。对比仿真表明，与传统自适应反步法相比，所提出的控制器具有更高的姿态跟踪性能和干扰估计精度。

姿态跟踪 修正罗德里格参数 反步法 扩张状态观测器 饱和约束  

0引言
随着卫星应用领域不断扩展,对其机动性和控制
精度的要求也不断提高,这就需要姿态控制不断增强
鲁棒性,同时考虑控制饱和的影响。目前,广泛研究和
应用于卫星非线性姿态控制的方法主要有动态逆““、
滑模控制“「和反步法“““1。因为反步法具有严格的稳
定性,同时在增强控制鲁棒性和自适应性方面,其结构
具备很大的灵活性“,所以本文以反步法设计姻态控
制器。
对于受多种不确定因素影响的卫星控制问题,可采
用两种自适应反步结构以提高控制器的性能““:一是
调节函数自适应反步法(TFAB),该方法通过Lyapunov
丽数的通归推导来构造不确定参数的自适应律,参数
更新律和控制律形式复杂,系统动态与更新律动态强
耦合,不能保证真值估计,日不可预知的参数更新动态
可能导致非期望的闭环瞬态响应,因而控制器参数调
节困难;二是分块自适应反步法(MAB),该方法分别
设计鲁森反步控制律和最小二乘估计器,估计器直接
在线估计补偿不确定性和外干扰的影响,但是最小二
乘估计律的使用需要非线性回归函数滤波,增加了估
计律的阶次和计算量,影响估计性能。为此,Krstik结
合浸入与不变流形思想又提出了无需回归函数滤波的
最小二乘自适应控制方法“,但该方法仅适用于线性
参数化的规范型非线性系统,对于更广泛的严反馈系
统,参数估计过参数化,这对于应用最小二乘估计来说
是不希望的。相比其他常用估计器,非线性扩张状态
观测器(NES0)不依赖干扰信息,不需要回归函数滤
波,更适合未知时变不确定性的估计“),所以本文采用
NESO对卫星受到的“总于扰“(外干扰和惯性参数摄
动引起的干扰力矩)进行实时估计补偿,以提高反步控
制的鲁棒性和精度。
卫星执行器饱和与状态约束的存在会严重降低闭
环系统的性能,所以在设计控制器时还必须考虑输人
受限问题(““““。本文采用指令滤波器来施加状态和控
制输人的幅值及速率约柱,并对路踪误差进行修正以
消除饰和约柬对跟踪误差收敛性的影响,同时还可方
便地得到虚拟控制导数以简化设计过程。
最终,在非线性阻尼和估计律参数投影的作用下,
NESO与反步控制器构成输人-状态稳定的分块自适
应抗拥约束反步控制结构(MACB)。通过与指令滤波
反步法““(CFBS)和基于调节函数的约李自适应反步
法““(CABS)进行比较仿真,验证了该方法在高精度
卫星姿态控制中的有效性。
1卫星修正罗德里格参数姿态模型
修正罗德里格参数(MRP)是描述姿态运动的三
参数全局非奇异方法,能够表示|9|<360“的特征轴转
动,参数较少,计算量小“。
1.1“姿态运动学方程
由MRP表示的卫星姿态运动方程为
式中:n为卫星转道角速率;=[r!,0,0]eR,
为MRP姿态参数向量;‖火‖表示向量的2范数或矩
阵的诱导2范数;N()为MRP运动学矩阵;为3x3
单位矩阵;w=[w,w?]sR「,为卫星相对于惯
性系1的角速度向量;ci(),5=1,2,3,为MRP方向余
弦矩阵C()的第;列向量,C()表示如下。
S,表示反对称矩阵
1.2“姿态动力学方程
由向量形式的欧拉转动方程可得卫星标称姿态动
力学方程为
式中:Ts,T7.,T,sBR,为卫星在本体坐标系8上所受的
外力矩,7s=3n“S.,Jcs,为非均匀重力场引起的重力
梯度力矩,7.为执行器控制力矩,7,=Tu+Tax,HB
干扰力矩,Tu及Tuex分别表示惯性参数摄动引起的干
扰力矩和受到的环境外干扰力矩;J,eR“,为卫星惯
性张量矩阵的已知测量部分。
1.3假设条件与分析
针对卫星MRP姿态数学模型式(1)式(4),在全
局范围内做如下假设。
假设102存在正常数,和.,使得|Tuxll<
Mos‖Tax[|<M,成立。
偿设1表明环境外干扰属于有界慢时变形式,在
航天背景下,虽然卫星受到不同空间干扰,如引力摄
动、大气阻力等,其大小差别很大,但是与卫星姿态控
制力矩相比都非常小。文献[13]措出,在控制器设计
中可将其作为有界的未知项处理,并通常具有偏差项
与周期项相加的形式。
引理“慌性张量常值偏差引起的干扰力矩Ta及
其导数T有界。
该引理证明可参见文献[14]。
假设2参考指令信号及其一阶导数存在旦有界。
在实际系统中,参考指令通常均有界。将参考信
号进行一阶滤波形成新的参考指令,则可使得其一阶
导数存在且有界。
假设3系统状态(姿态角,角速度)完全可知。
工程中卫星姿态角和角速度是可测的。
至此,控制器设计目标为:针对式(1)和式(4)绍成
的6阶非线性严格反馈MRP模型,设计控制律7.,使得
在系统不确定性和十扰条件下卫星姿态跟踪光滑参
考指令,闭环系统全局稳定且当oo时跟踪误差2,
(i=1,2)收敛于包含零的可任意小的邻域内。
2“约束反步控制
2.1控制器设计
考虑系统式(1)和式(4),首先定义跟踪误差向量
式中:x,.为实际内环参考角速度,x,.及其导数多.可
通过对句.=n-X指令滤波后获得,m为设计的内
环虚拟控制律;x,为由于滤波作用而定义的修正项。
考虑数值仿真的效率,对于文献[9]的指令滤波
器可采用如下离散形式
Rpex,为滤波器输人信号;xr,为滤波器状态;x.,乌
为滤波器输出;S..(.)为饱和函数,*取M和R分别
表 示 幅值和速率;At为仿真时间步长。由于在实际饰
和发生时往往需要保持控制力矩向量的方向,因此选
取超球面饱和函数Su.(-),*为饱和限,即
包=力(-SJyw+3n’Sdyc;)+小7+J5刀一口。
(10)
为消除饱和约束对跟踪误差的影响,进一步定义
修正跟踪误差
2,22, 一 龙 L,22 二 Zo 一 2 (11)
带饱和约束的指令源波对跟踪误差z,、z的效应由如
下稳定的线性滤波进行估计,即修正项X,x.满足
至此,未经滩波的初始控制律设计为
T0=S,Jow -3n°S Joe, + J[ %,, —k,2, -
HA BRIEF kk, >0;h =J5 kKJ , 为 非 线 性 阻 尼
Wik=K“>0,为鲁棒增益;为“总干扰“力矩估计
值。实际饱和约束下执行器的控制力矩7由7通过
式(7)指令滤波获得。
2.2“非线性扩张状态观测嚣设计
非线性扩张状态观测器(NES0)是将被控对象中
存在的“总于扰“作为扩张状态与系统状态一起进行
估计。对于卫星姿态模型,干扰项仅存在于动力学方
程式(4)中,因此NESO可采用如下形式,即
HREAN?=-w,非线性增益函数/ul(.)选择为
式中,非线性参数5,>0,0<a;一1,增益矩阵B;>0。
观测器式(16)的估计误差动态为
SH.
对于参数的选择,可以首先取o=1,则式(18)成
HERMESfal=台,通过极点配置选择合适的观测器
增益B:.,此时式(19)为
由于B;,i=1,2和V,是对角矩阵,线性观测器式(20)
可以使用如下特征多项式配置极点,即
式中,表示相应矩阵王的第}个对角元素。为使观
测器稳定,8B,J,"都必须为正。分析线性观测器
式(20)的稳态形式。
对式(22)求解可得
上式表明,对于满足假设1和引理的有界的7,要
减小估计误差@和6,必须选择尽可能大的增益8和
尽可能小的8,,从式(21)可知,这意昧着线性观测器
具有高自然频率和低阻尼比的目标动态。
然后,再引人非线性参数a:,8;以提高对于时变干
扰的估计性能,改善由追求小稳态误差带来的低阻尼
佼计性能。对于小的状态估计误差,即|6;|<5,<8,
由式(18)\式(19)可知,观测器每个角误差分量具有
如下特征多项式
由此可知,较小的a;能够降低稳态估计误差,同
时减小估计误差较大时(|召|>8)的估计增益,以改
善系统动态;增益分界参数5:应选小于1的较小值,使
得在原点周围较小的范围观测器具有较高的增益和更
快的动态,以增强估计跟踪性能。最终,在假设1和引
理条件下,如果选择合适的参数B:,au,5;,i=1,2,可在
有限时间内使得w趋近,占趋近于7。
迸一步,由偎设1和引理可知“总干拢“Tu有界,
所以要使得估计误差$有界,可通过对NESO估计律
使用参数投影以使估计值有界。式(16)中Proj(,)
即表示参数的光滑投影算子“,其将状态/干扰的估
计值@约束在定义的包含真值的凸集42上。
式中:r表示估计更新律;5>0,为小的常值;为超球
面集2的半径。
通常,为了保证抑制干扰力矩的要求,同时避免状
态和执行器饱和造成系统失稳,需要选择估计的投影
集X在饱和限制内,但由于在反步设计中采用了指令
滤波来施加饱和约束,并对跟踪误差信号进行了修正,
避免了闭环系统在约束条件下不稳定,所以可以适当
放宽投影集的范围,使得控制律能获得更准确的干扰
伙计值,有利于提高闭环系统抑制十抢力矩的能力。
3“闭环稳定性证明
首先,分析闭环系统修正跟踪误差式(11)的动
怪,由式(9)可知
进一步代人式(12)、式(14)可得
二=-匕五J′…〕(蛋害′号Z`′〈'T)二(27)
同理,由式(10)、式(13)\式(15)可得
LEX: =
此,选取闭环系统的Lyapunov候选函数为
其沿式(27)、式(28)的时间导数为
V=君〈一潺晶+誓盂N(矿〉觊)+2,(~k,2,-
由上节分析可知,合理选择NESO参数以及在估
计律参数投影的作用下,于扰力矩估计误差7是有界
的,因而式(30)表明,修正跟踪误差5,i=1,2相对于
TAA-状态稳定,渐近收敛于包含原点的邻域U(0,
二(FK-吊)“2),丁选择非线性阻尼增益充分大可
使该邻域任意小。而通过合理设计指令滤波器,能够
保证X:,5=1,2很小,由式(11)可知,这使得跟踪误差
z;与修正跟踪误差5一样具有输入~状态稳定性并收
敛于相同的邻域“。
4“仿真结果与分析
针对卫星姿态机动,本文分别基于文献[9]的
CFBS,文献[10]中的CABS以及本文的MACB进行仿
HELE,
由于干扰力矩的时变性质,CABS控制器的内环控
制律乙也需要增加非线性阻尼项J“KJy来克服估
计误差,而其调节函数估计律由修正跟踪误差,驱动,
如式(31),自适应增益厂>0。
4.1“参数选择
为了公平比较,CFBS控制器内环控制律同样加入
非线性阻尼,且3种控制器控制增益相同,=diag10.2,
0.2,0.2} k, =diag{1,1,1} ,k=J, - diag}1,1,1}+ J,
在非自适应的情况下(7=0),修正跟踪误差动
态式(27)、式(28)的状态空间形式为
式中,=k,+diagi{l,1,1],为内环等价增益。对于
非强机动的平缓参考信号,跟踪误差较小,即o~0,,
业时3Z:N(o)~-二,则式(32)解耦为3个二阶系
统,每个二阶系统对应一个姿态角分量,并具有如下特
征多项式
式中,f,,君为增益矩阵和乙的第}个对角元素。由
此可知,选择的增益使得闭环系统具有极点为p:=-
0.235rad/s,-1.965rad/s|的系统性能,该极点对应
内环外环两个一阶系统。
根据2.2节对NESO设计的分析,参数选择如下:
B =diag |1,1,1] B, =diagi5,5,5}  J,,a, =0.25,5, =
0. 05 ,a =0.5,5, =0.05,
由式(21)可知,选择的参数使得线性观测器的自
然频率和阻尼比分别为w,=2.24rad/s,{=0.22,观测
器具有比非自适应的闭环系统式(32)更快的动态。
而由式(24)可知,引人非线性参数后0,=4.73rad/s,
￠=0.99,观测器的低阻尼性能得到改善,并且在原点
附近动态进一步提高。
对于调节函数估计律式(31),垂然仅要求估计增益
了为正,但如引言对TFAB的论述,闭环瞬态性能与估计
动态耦合,所以需要经过反复调整,选择7=diag|6,
6,6} * Joo
4.2“仿真分析
卫 星 轨 道 角 速 度 n =1. 078 x10 rad/s, HHH ER
J=Jo+AJ,J,FmJ的第;个对角元素“,J和AJ的
单位为kg,m7。
外干扰力矩Tx「“7(单位N,m)为
卫星参考姿态分为初始姿态m到目标姿态0的
重定向和目标姿态0So,之间周期个=110s的正弦
扫描机动两部分,仿真步长0.01s。
根据执行器物理约柬及星载仪器对其状态的限
制“,指令滩波器参数为:内环x,.限幅1(“)/s,速率
限制0.2(“)/s「,控制力矩7限幅0.05N.m,速率
限制5Nm/s,相应选择适当放宽的投影算子参数
Ma =2 (“)/s,5s =0. 02 (°)/s,M;.=0.1 N + m,8; =
0.001 N * m,
仿真结果如图1~图5所示,其中,MACB姿态跟
踪如图1a、图2a所示,图1b和图2b为CFBS\CABS和
MACB的路踪误差比较,其中0.=4arctan(‖.‖),为
式(36)所示特征轴转角0表示的跟踪误差,‖心.|为
角速度跟踪误差的2范数。
图 1 MRP姿态角跟踪控制
Fig. 1 Tracking control of the MRP attitude angle
aMACB角速度跟踪b3种控制器角速度路踪误差比较
图 2 姿态角速度跟踪控制
Fig.2 Tracking control of the attitude angular rate
可以看出,在给定输人-状态约丞下,尽管卫星跟
陡设计的参考姿态出现了角速度和控制力矩饱和,由
于引人了指令溏波和修正跟踪误差,3种控制器均能
实现稳定跟踪,但非自适应的CFBS对惯性参数摄动
和周期性干扰的抑制能力较弱,并且受外加常值干扰
的影响,b.和‖.||均产生了稳态跟踪误差,自适应控
制器MACB和CABS跟踪效果更好,但相比之下,
CABS内外环跟踪误差较大,而MACB的跟踪更精确,
性能主要受饱和约束影响。
从图3控制力矩变化可知,MACB控制律对干扰
的抑制并不以较大的控制量为代价,若定义卫星能量
消耗的量度“1(单位为JJ为
式中,w;和7分别表示角速度w和控制力矩7.的第i
个 分 量 , 则 Py =0. 2803 Py =0. 2776, Py =0. 2769,
MACB能量消耗更小。
aNESO干扰力矩估计b角速度佼计误差范数
图 4 NESO干扰和状态佑计
Fig.4 Disturbance and state estimation of the NESO
从图4NESO对状态和干扰力矩的估计可以看出
(图4a中7u表示干扰力矩7的第;个分量,图4b为
角速度估计误差的2范数),NESO能够迅速准确地估
计“总干扰“和角速度的变化,所以干扰补偿更有效。
而CABS的调节函数估计律由Lyapunov函数得出,以
保证闭环系统稳定为前提,估计性能不可预知,其干扰
力矩估计卫如图5所示,可以看出气的分量氙和氙耦
合,整体估计效果较差。
5“结束语
本文针对刚体卫星在模型不确定性外部扰动和
饱和约束情况下的姿态跟踪问题,利用指令滤波反步
法和自抗扰理论,设计了闭环输入-状态稳定的自适
应抗扰反步姿态控制器,指令滤波解决了输人约束下
的反步控制和虎拟控制导数的计算膨胀问题,而NESO
对干扰力矩进行在线估计补偿,提高了娅态机动的抗
扰鲁棒性和跟踪精度,日相比传统的自适应反步法,本
文的设计参数可面向性能进行调节,在姿态跟跋和干
扰表偿方面性能更优。
