一种基于旋转不变特征的星图识别算法
栅格算法作为星图识别算法中的代表，有着识别速度快、识别率高、导航数据库容量小的优点，应用较广，但其在构造恒星特征模式时存在需要选取临近星进行图像旋转的问题。为克服这一缺陷，提出了一种基于旋转不变特征的星图识别算法。该算法利用模式识别类星图识别算法思想，为每颗恒星建立一种与旋转无关的特征模式，采用改进的 Hausdorff 距离进行匹配识别。仿真实验结果表明，基于旋转不变特征的星图识别算法对星点位置噪声与缺失星鲁棒性均优于栅格算法，具有良好的识别效果，但其识别速度与存储容量仍需进一步优化。

星图识别 栅格算法 HAUSDORFF距离  

05言
星图识别是星敏感器关键技术之一,在星敏感器进人初始工作状态或者姿态丢失时,如果没有任何先
验的姿态信息,便需要进行全天球星图识别。全天球星图识别算法一般可分为两大类1
1)子图同构类算法
子图同构类算法,将恒星看作无相图极点,以恒星星对间的角距为边,恒星为顶点,将观测星图看成
、二用/心画(伐“异。
Gottlieb于1978年提出的多边形角距算法是最早的星图匹配算法之一,将任意两颗恒星间的角距与存
储在导航星数据库中的所有导航星的星对角距进行比对,如果满足一定的闻值条件,则完成匹配。方法简
单易于实现,但识别时间与存储量都较大71。
Groth于1986年提出的三角形算法是现今使用最多、最成熟的算法,以三颗恒星相互间的角距作为匹
配特征,匹配时在导航星数据库中寻找与观测三角形最接近的匹配星组。方法简单,但由于三角形的特征
维数较低,易产生冗余匹配,日用三角形算法存储导航三角形,导航星数据库一般较大[
2)模式识别类算法
模式识别类算法,为每颗恒星构造一个独一无二的特征一一“恒星模式“,通常是由柄一恒星一定邻域
范围内恒星的几何分布特征构成,识别时寻找与观测星模式最为相近的导航星模式。栅格算法是其中最具
代表性的算法。
PadgettC于1997年提出栅格算法。他将观测星与附近伴星的几何分布特征用栅格划分为矩阵模式,
作为恒星的特征模式。与传统算法相比,栅格算法识别率较高,导航数据库容量较小,但伴星选择错误会
影响识别结果。
ClouseD于2000年提出基于贝叶斯分类器的榔格算法。他在PadgettC的栅格算法上加以改进,利用
贝叶斯模式分类理论,提出可调节阙值概念,该算法运用于小视场星敏感器上,识别率较好F1。
近年来,众多学者提出很多新型星图识别算法,
属于子图同构类算法的如三角形内切圆算法吊,基于
惯性比特征的三角形算法口等,虽较传统三角形算法有较大改进,但仍存在较大的冗余匹配,属于模式识
别类算法的如极坐标系下的栅格算法卯,基于三角剖分及径向基函数神经网络算法口,基于三角形剖分以
及PSO-BP神经网络算法[“,在理想情况下识别率与识别速度较传统栅格算法均有较大提高,但文献中均
未给出存在噪声情况下算法识别率的变化,而基于同心圆分割算法“1,所需导航星库存储量较低,识别时
间较快,但在存在噪声情况下识别率为90%,仍需进一步提高,基于星三角形角度的竞选式算法[“,抗躁
声能力强,识别精度稳健,在接近一个像素的位置噪声情况下识别率大于92%。
从星图识别算法发展现状来看,模式识别类算法对星点位置噪声与星等亮度噪声不敏感,整体上较子
图 同 构类算法鲁棒性强,所需存储空间小,速度较快,是今后星图识别算法的发展方向。但传统的匹配需
根据邻近星进行星图的旋转,在星点提取误差较大的情况下,临近星错误选择将使得恒星模式生成错误,
致使匹配失败。
本文基于模式识别类算法的恒星模式概念,提出一种基于恒星角距的恒星模式,受文献[13]启发,采
用一种改进的Hausdorff距离进行模板匹配,有效地解决了模式识别类算法旋转匹配问题。仿真结果表明
这种方法在星点位置噪声较大和存在缺失星的情况下仍具有较好的识别率。
1“旋转不变特征量提取
1.1星图成像的旋转不变性
当星敏感器视轴OZ对准树一天区时,萱于视场内的两颗恒星4与B分别成像于像平面OXYLia
点和?点,如图1所示。保持星敏感器视轴OZ不变
,像平面绕OZ视轴旋转某一角度,恒星4与8仍成
像于空间的a点与b点处,所对应两点的球心角LAOB不变。可以得出结论:当星敏感器视轴指向不变时,
其绕视轴的角度变化将不影响恒星成像时对应的球心角大小,即恒星对之间的角距保持不变口。基于这一
原理,提出了一种基于旋转不变量的恒星模式提取方法。
1.2恒星旋转不变特征量
假设柄一时刻恒星成像于像平面O必7的图像如图2所示。
矩形框代表星敏感器视场。对于星点a来说,可以构造一个与旋转无关的模式量。考虑1.1节恒星星
对角距旋转不变特性,连接a点与所有剩余点组成一个线段组{a},计算出点a与其余各点之间的角距
http://www.gdgc.ac.cn
孪仔量。灯僧半囡门皂力名里尼众伏假上坝处埋,信到毒个星良的特仔四量I、姣,卵力观测星的
特征量。
4/3倍视场半径大小,选取标准星库中与其角距在邻域半径内的恒星,按上述方法生成对应的特征向量,
作为这颗恒星的特征数据库,即为图中的国形框,虚线代表处于星敏感器视场之外。遍历标准星库中的每
颗恒星,生成导航星数据库。
一般来说,观测星的特征量数目不多于标准星库
中对应恒星的特征量数目。例如图2所示的a点,其
比较靠近视场边缘,按上述方法生成的观测星特征量应为|<a5,<ac,<ae,<ag,<af|,而对应导航星数据库
中的值为|Lap,<ac,Lae,<ag,<ajf,<ai,<aj,Lak「,<a|,观测星a的特征量为其对应导航星特征量的一个
子集。推广开来,所有观测星的特征量均为其对应导航星特征量的一个子集。设观测星特征量的集合为
{H'},导航星数据库集合为{Z},即有{Z}c{Z}。
依据这一性质,本文利用基于旋转不变特征量进行观
测星与导航星匹配识别。
2“基于旋转不变特征量的星图识别
在给出基于旋转不变特征量的星图识别算法具体步骤前,首先介绍点集间Hausdorff距离的概念。
2. 1 Hausdorff 距 离 (HD)
对 于 两 个 有 限 点 集 4= {auau,...,a} FAB ={b,,b,,..
Hr.h(4,B)为4,B间的有向Hausdorff距离,肌尴B)=唔垦X湟戛n‖魔_簪‖，|||是某种距离范数。
如果定义一个点a到点集B的距离4s(a)为a点到点集8中每一个点距离的最小值,即
dy(a)=minlla—bll,WIh(4,B)是点集《中所有点到点集8的距离do(a)的最大值。
若令模板为4,待匹配图像为8,则可用A(C4,B)
度量4和8的匹配程度,Ah(4,8)值越小说明两幅图
像越相似,故Hausdorff距离可用于图像匹配中。例如图3所示,为一种基于Hausdorff距离的图像匹配求
解方法。图3(a)为待识别的图,图3(b)、(c)分别为模板。分别计算(a)、(b)之间的Hausdorff距离与(a)、(c)
之间的Hausdorff距离,有乙((a),(b))<H((a),(c)),所以图3(a)与图3(b)更为匹配,与直观感觉吻合。
力s印人四FRyI1auSUOLLL岐门LL,乙,A心里研光tt1I小多团网屋刑吴划丢乙一50H).
2.2基于旋转不变量的识别算法
基于旋转不变量的算法识别过程分为两个步骤一一匹配识别与验证识别。匹配识别时,提取观诞星图
中每颗恒星的旋转不变量作为初始向量,生成的点集组{亿“}与导航星库点集组(H}作Hausdorff距离运算,
取所得最小值对应的星号为观测恒星的匹配值;考虑到观测星图中观测星的正确匹配应集中在星敏感器视
场约李范围内,而不正确的匹配星点随机分布于整个星空范围内,基于视场约束的原理,可以剔除不符合
条件的星点。验证识别时如果是算法生成的星图,根据识别出的星号即可判断算法是否正确;若是软件模
拟的星图,可根据匹配结果和星敏感器成像参数生成识别星图,并与原星图作对比,若识别星图中的星点
大部分能在原始星图中找到对应的观测星点,则可认为识别正确。
下面主要闸述匹配识别算法具体的实现过程;
D)生成导航星数据库:
对于标准星库中的一颗恒星a,取邻域半径r为4/3倍星敏感器视场半径大小,在标准星库中等选与其
角距在邻域半径内的所有恒星,以该恒星a为中心依次计算其与邻域星之间的角距,存储为特征向量表||all
作为恒星a的特征数据库。遍历标准星库中的每一颗恒星,生成导航星数据库{P},{H}可看作以旋转不
变特征量为基本元素的点集组。
2)获取观测星图:
根据观测星图得到像平面各星点的位置坐标,分两种情况老虑:
第一种根据星敏感器成像原理,编写程序生成星敏感器柄一视轴指向下观测星的星点坐标,具体步骤
为;
O计算在给定视轴指向下全天球坐标系到星敏感器坐标系的旋转矩阵R;
@根据给定视轴指向在标准星库搜索得到视场内的恒星星号信息;
@由星号信息与旋转矩阵R依据星敏感器成像参数生成星德感器像平面的星点位置坐标,并存储对
应星点星号信息。
第二种是由天文软件或实际拍摄得到模拟或实际的星图,对星图进行预处理和质心细分定位得到观测
星图的星点位置坐标。
第一种方法易于测试算法的鲁棒性、识别率及识别速度;第二种方法适用于验证算法的正确性。
3)观测星图特征提取:
由第二步得到像平面各星点的位置坐标,可以计算出任意两个星点之间的角距值并作为旋转不变特征
量生成观测星图特征点集组{Z「},{亿}中每组数据对应于像平面栋一星点的旋转不变特征向量。
4)基于改进Hausdorff距离的星点匹配:
对观测星特征点集组{亿“}中每组向量点集与导航星数据库{}作改进的Hausdorff距离运算,当取最
AMERY,BU{H}中的星号作为该组对应星点的匹配值。
5)基于星敏感器视场约束的匹配值判别:
考虐到观测星图中观测星的正确匹配应集中在星敏感器视场约束范围内,而不正确的匹配星点随机分
布于整个星空范围内,对匹配出的点在天区的分布作聚类分析,剔除离散的星点数据。
6)识别结果:
如果有两个以上的星点识别完全正确,便认为识别成加;如果存在错误识别或者少于两个星点识别正
确则识别失败。
基于旋转不变量的星图识别算泼伪代码如表1所示。
http://www.gdgc.ac.cn
Table 1 The pseudo-code of the rotation-invariant based star identification algorithm
Generating the guide star database
1 N + total number of stars in the guide star catalogue
1 R 一 “the number of stars detected in the image
2 R ? 4/3(field radius of the star sensor)
3S; ? the ith star in the guide star catalogue
4 for i from 1 to “ do
10 end for
3仿真实验与结果分析
3.1实验参数设置
仿真实验平台参数:操作系统WindowsXPProfessional,开发环境Matlab7.1,主机CPU主频3.01GHz,
星敏感器成像参数:星敏感躁视场大小12“x122,像平面分辨力1024x1024,主点位置(512,512),焦
BE60mm,最大可敏感星等6.0。
算法计算所需的邻域半径大小为8?。
选用标准星表数据为J2000.0历元的史密松(SAO)星表,包含258997颗星等亮度高于11等的恒星。
使用星等阎值泓生成亮度在0到6等星范围内的导航星表,得到导航星表数据,包含5103颗恒星星号、
赤经及赤纬信息。
3.2星点位置噪声对识别率的影响
茎'彗彗戛扇鼻誓丨亨方宴真董熹熹茎熹萱熹菖吾善′′宣菖1旱置亘王青菖茎量布彗茎亭亘壹奢蠡二克量责旱曹真戛<白菖彗鼻熹〕(熹菖鼻官:
量灵丨乏三二量二蓼亘丨三I乎_晕鸳辜孟兽二昙亡I二工茎菖(′′青彗Lrx5=FigA.rev:-rate
从图4可以看出在|个像素的位置误差情况下,
本
文提出的算法识别率大约为96.8%,高于栅格算法识别率,日较文献[12]中加入噪声情况下92%的识别率
有所提高,可见本文提出的算法抗噪声干扰能力优于栅格算法,日效果较好。
http://www.gdgc.ac.cn
术用祷怀-下多讳从全大坤社围斗陪矿挂叟1VUU
个侦绍万史生次观删土图,炳益鹏览加土图陪朱妮|这
若干个星点,老察“缺失星“对算法的影响。对每幅观测星图随机添加一定数目星点,考察“假星“对算
泓的影响。采用栅格算法与本文提出的算泓在同等实验条件下进行性能分析,如果有两个以上的星点识别
完全正确,便认为识别成功;如果存在错误识别或者少于两个星点识别正确则识别失败。对1000次试验
结果进行统计,如图5所示为存在“缺失星“情况下两种算法的识别率变化曲线,图6所示为存在“假星“
情况下两种算法的识别率变化曲线。其中染格算法所用参数与3.2节一致。
法识别率。
从图6可以看出在存在2颗“假星“的情况下,
本文提出的算法识别率大约为93.2%,略高于栅格算
法识别率。
3.4识别时间与存储容量
在同等实验条件下,三角形算法、栅格算法与本文提出的算法识别所需的平均时间与存储容量如表2
所示。从表2可以看出本文提出的算法在存储容量与识别时间上均优于传统的三角形算法,但相比栅格算
法仍存在一定差距。
表 2 识别时间与存储容量
Table 2 Identification time and memory capacity
Method Time/ms Guide star catalogue/kB Guide star database/MB
Triangle algorithm 367.4
Grid algorithm 312
Proposed algorithm 112.5
4结“论
本文提出一种基于旋转不变特征的星图识别算法
,利用模式识别类星图识别算法思想,为每颗恒星建
立一种与旋转无关的特征模式,采用改进的Hausdorff距离进行匹配识别。该算法一方面克服了栅格算法
在构造恒星特征模式时需要选取邻近星进行图像旋转的缺点,另一方面采用图像匹配领域较为常用的
Hausdorff距离进行星图的匹配。从仿真实验结果来看,基于旋转不变特征的星图识别算法对星点位置噪声
与缺失星鲁棒性优于栅格算法,有一定的研究价值,
但其识别时间与存储容量仍需进一步优化。
