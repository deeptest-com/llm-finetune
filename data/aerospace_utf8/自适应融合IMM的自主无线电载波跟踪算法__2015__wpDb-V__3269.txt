自适应融合IMM的自主无线电载波跟踪算法
针对深空自主无线电接收技术中信噪比（SNR）未知的载波跟踪问题,提出了一种自适应融合的交互式多模型（IMM）算法,可以根据实际环境的信噪比自适应地调节IMM估计器的噪声方差,以实现对未知SNR信号的正常跟踪,并保证频率跟踪精度几乎不受初始噪声方差的影响。在分析系统收敛性的基础上,该算法采用模型概率自适应调整策略,根据系统收敛判断条件自适应地调整IMM模型集中各模型的概率,保证了系统的收敛性,提高了跟踪精度,与广泛使用的Sage-Husa自适应滤波算法相比,收敛时间缩短了一倍左右。

深空通信 自主无线电 交互式多模型 自适应算法 载波跟踪  

05“言
深空测控通信由于通信距离极远(如火星距离
地球最远跚离达4亿公里),接收信号具有极低信
噪比的特点。传统的微弱信号接收采用固定环路带
宽的锁频环(FLL)、锁相环(PLL)算法““或固定
噪声方差的卡尔曼滤波算法“-“。但是当探测器的
发射功率、环境温度、接收电路参数、天线对准角度
误差等未知时,接收系统的载波同步需要在信噪比
(SignaltoNoiseRatio,SNR)未知的条件下完成,此
时无法根据SNR确定环路带宽或噪声方差。针对
此问题,可以采用自主无线电技术,在有关SNR特
性的先验信息未知时也可自动识别无线电信号的特
性,并自动配置接收机而进行接收。
文献[8-12]已绅研究了一些基于自主无线电
的SNR未知条件下的同步接收算法。文献[8]提出
的载波路踪算法通过实时估计接收信号的载噪比和
飞行器动态参数来自适应地调整锁相环的环路参
数,以使得跟踪误差达到最小。文献[9]提出了基
于卡尔曼滤波的自适应锁频环算法,可以根据实际
的噪声环境自适应地调整环路带宽,实现了环路带
宽的最优化。与采用固定增益的锁频环相比,具有
较高的初始捕获带宽,较短的环路收敛时间。文献
[10]提出了一种自适应扩展卡尔曼滤波(AEKF)的
载波跟踪算法,该算法通过实时监测源波器新息或
残差的动态变化,修正状态噪声方差和观测噪声方
差,以适应当前的信噪比环境,其估计误差小于传统
EKF。文献[11]提出了一种用于载波跟踪的基于新
息协方差的自适应卡尔曼源波算法,通过遗忘因子
自适应地调节预测误差协方差矩阵,从而达到实时
调整增益矩阵的目的,使源波器在噪声统计特性不
准确时仍接近最优,其估计精度明显优于PLL环。
文献[8-11]的缺点是其正常工作的载噪比门限较
高,都在30dB-Hz以上。文献[12]的自适应卡尔
曼源波通过载噪比估计来确定观测噪声的统计特
性,从而根据瞻声的大小自适应地调整等效环路噪
声带宽。与固定带宽的PLL环相比,此法具有更高
的相位估计精度,可以工作在载噪比25dB-Hz的
条件下。但是当载噪比小于30dB~Hz以后,估计
误差急剧增大。同时,当接收信号存在相位随机抖
动或载波同步环存在鉴别器的非线性效应时,难以
准确估计信号的载噪比,进而自适应地调整等效环
路噪声带宽。
本文在分析载波跟踪过程中跟踪精度与收敛时
间的基础上,提出了一种自适应融合的交互式多模型
(Interactive Multiple Model, IMM) 算 法 , 采 用 IMM 估
HEC,根据估计精度、收敛时间的要求建立一个
含有多个模型的模型集来描述系统当前的模式,系统
的总体估计是各个模型输出状态估计的加权融合。
该算法在信噻比信息未知时,可以自适应地对其噪声
方差进行估计和修正,以适应当前的信瞿比环境。同
时,该算法根据系统收敛判断条件进行模型概率的自
适应调整,即保证了收敛性又提高了收敛速度,与自
适应滤波算法相比,收敛时间短了一倍左右。
1IMM算法用于载波跟踪
1.1“载波跟踪环路分析
当SNR信息未知时,为了保证估计精度,通常
采用基于自适应滤波的载波路踪方法““。自适应
滤波估计器根据当前的估计环境不断修正噪声的统
计特性,从而提高估计精度。卡尔曼滤波(KF)状态
估计值的表达式如下
x,=Xia+K,(z,一′薹赋′-i`亡′噱】=一l)(1)
式中:tuu-,为滤波预测值,,为系统观测矩阵,
为滤波增益。由于观测值z,中含有观测噪声,当王
估计精度较高时,说明噪声对状态估计的影响较小,
可知K,较小。同时,K,与估计器的收敛时间、本地
载波的相位误差存在以下关系
式中;5为收敛时间,c,、co为固定常数,B.,为KF
的等效噪声带宽“1,y为环路信噪比,P为接收信
号功率,No为噪声功率谱密度。
从式(2)~(4)可以看出,当K,较小时,观测值
对新的状态估计值的修正能力较弱,等效噪声带宽
也较小,从而导致估计器的收敛时间较长。反之,如
RK,较大,等效噪声带宽也较大,估计器的收敛速
度会变快,但是隧声对状态估计的影响也会变大,同
时本地载波相位的估计误差也会变大。根据以上分
析可知,滤波过程的收敛速度和估计误差可以从K,
反眨。自适应滤波的方法降低了观测噪声对源波结
果的影响,蚀然估计精度高,但由于K,较小,导致收
敛时间较长。为此本文采用了一种基于IMM的载
波跟踪算法来满足估计精度与收敛时间的要求。基
于IMM的载波跟踪环路结构如图1所示。
相(和正交(0)采样数据。然后1和0分量通过
低通滤波后滤除高频分量,滤波后的同相()和正
交(0,)分量送人鉴相器以提取相位误差信息。
接着,本文将鉴相器输出的相位误差估计值作
为IMM估计器的观测值,对载波相位差、多普勒频
差及频率变化率进行估计,并用估计结果来调节载
波NCO的输出相位,使本地载波环所复现的载波与
接收到的载波保持一致,以保证接收信号中的载波
在跟踪环路中被彻底剥离。
1.2系统的状态方程与观测方程
状态方程描述的是状态向量的行为,待估计的
状态向量x:=[xa。xa。s。]「是经过IMM估计算
法的各个模型交互后的输出结果。其中,xao是真
实载波和本地载波的相位差,?,,是多普勒频差,x。
是多普勤变化率,则系统的状态方程可以表示为:
龙 +1 二 dx, + WwW, =
式中:@为状态转移矩阵,7为采样间隔,wARE
噪声矢量,w,、w、ws分别是载波相位差、多普勤
频差及频率变化率的扰动噪声。
观测方程描述的是观测值和状态向量之间的关
系,史表示为:
观测值z,在每个采样间隔内由鉴相器计算得到,y
是零均值白高斯观测噪声矢量。
2IMM算法描述
IMM算法首先设计一个含有多个模型的模型
集来描述系统可能的模态““1,与每个系统模型相匹
配的源波器并行工作,利用每个源波器输出的残差
信息以及各模型的先验信息,依据某种假设检验规
则,得出每个滤波器所对应的模型为当前时刻系统
匹配模型的概率,系统的总体估计是各滤波器输出
状态估值的概率加权融合。为了兼顾估计精度与收
敛时间的要求,模型1采用常规卡尔曼滤波模型,模
型2采用自适应源波模型,IMM算法的每一个更新
周期包括以下五个步骤。
1)计算混合概率:
设系统模型集为M={mm},模型m和m。
分别对应常规卡尔曼滤波与自适应溏波。在每一次
IMM估计器更新周期的开始计算各模型的混合概
率:
式中:L-i为5-1时刻估计值处于模型m,的概率,
称为模型概率;py为预先设定的模型之间的转移概
率;lie为模型条件转移概率;c为归一化因子。
2)输人交互:
各滤波命在每个滤波周期的初值由上一滤波周
期的所有状态估计值和模型条件转移概率计算得
到,也是总体信息再分配过程,即
式中:_为5-1时刻模型m,得到的估计;
笃,为输人交互后5-1时刻模型m输出的佼
计;PY为输人交互后8-1时刻模型的估计
误差协方差矩阵。
3)模型溏波:
各模型利用输人交互的结果进行卡尔曼滤波,
其中模型1噪声方差矩阵保持不变,模型2采用上
一滤波周期更新后的噪声方差矩阵,最后获得状态
估计x,及其估计的协方差Puu。
4)模型概率更新:
各模型的似然函数为
其中,eo,为源波器的新息,S,为新息方差的理论值。
表 达 式为
c,可得*时刻模型m的概率以如下:
5)输出交互:
最终的状态输出是将所有子模型的状态估计加
权合并得到的,即画各模型的状态估计值和模型概
率乘积得到
了=1
P,,=芝′′′(′诿=畜】!)/易【|′=+[Xs—Xp,1[X,=Xu,"
j=1
(17)
由此可见,当w=maxip,pu,)时,模型集向左
转移,表明模型1的噪声方差初始化设置较为准确。
当=maxiu,ut时,模型集向右转移,表明模型
1的噪声方差矩阵初始化设置不够准确,需要更多
依赖于当前自适应调整后的噪声方差。
3“自适应融合的IMM算法
3.1“噪声方差的自适应修正
为了在缩短环路收敛时间的同时保证系统的收
攸性,并适应当前的噪声环境,本文采用自适应融合
的IMM算法,算法结构图如图2所示。
整个模型集的噪声方差矩阵Q,MR,进行估计和修
正,以适应当前的瞿声环境,得到估计状态的最优
值。因为Q,MR,与新息e,、预测误差协方差矩阵
Pyxu-!、滤波增益K,有关,所以还需对每个模型的e,
MP,进行计算加权。即
e.=万史以(18)
i=1
三亡删雅_1=DIEA(19)
j=1
Py=乏`′′【′′′诿【毫′,蜇霉l′′_l+[*0—Xp]“
j=1
得到e:、Pu:-:、R,后,采用基于Sage-Husa自适应
滤波算法的噪声方差修正方法““1,对Q,和R,进行
修正,方法如下
Q, =(1-4)0,, +d,(K.e.e.K, + P, - @P, Dd")
(22)
R,=(1一j′【)R′`7_l十d/【〈e'噩e更一矗′′曼′，′誓_′霄一】王′乏`〉
(23 )
3.2“模型概率的自适应调整
在低信噪比的条件下,图1中的鉴相输出值受
到噪声的影响较大,会出现鉴相误差超出正常范围
的异常观测值(异常观测值可以根据文献[17]的窗
口法判定)。异常的观测值也会造成新息￠,出现较
大误差,僧离正常的统计特性。同时,新息序列与
IMM估计值存在如下关系
x, =x, +Ke 二 Xi-1 +Ke, =
龋|`亡砸'i`亡′朦_z,十K′l7__馨′:一l亡矗十Ke,=
锤2'毫'′t=_2十@'K′灞_]e′I:一l十K.e,=
由式(24)可知,估计值是新息序列e,的线性组
合,新的观测值所带来的新息以线性组合的方式对
估计值产生影响。当观测值异常时,带来的异常新
Be,会对系统的预测值进行错误的修正,使估计值
发生偏移。当连续出现异常新息时,估计值就会出
现误差的积累,使得误差不断增大,降低估计器的可
靠性,甚至可能导致系统发散。
因此,在每一次估计过程中,还需要根据系统收
受条件来判断系统是否处于发散状态,以便后续采
取模型概率的自适应调整策略来披制估计器的发
散。当估计器发散时,误差协方差阵无界,此时实际
估计误差往往比理论预计误差大很多借。根据这一
特点,当前是否发散可以根据新息e+进行判断,e,
表 达 式如下;
a′【二′z/【_^z′曹_′矗一l=
Hx,+n,一′f′髻毫′′:_′二-】=
式中:z,为估计器实际观测值,2us.为预测观测值,
Xue=X,-uxi为预测误差。e;均值的理论值为:
又 因 贯g Py, = E(x, 1X01) 》 R, =
E(mn,),fille,方差的理论值表示为:
S, = E[e,e!] =
二E`二|二〈′i_′簪壬′重】′′:_[+′z′c)〈′.′′r'壬′誓_J髻一】+n,)"]=
矗′/【′:，翼'儡_】F一l′鹭莫`+R,(27)
由于估计器的实际估计误差为e「e:,所以可以
利用新息序列e,来判断估计器的收敛性。判断系
统是否收敛的依据为:
式中:tr为矩阵的迹,y为可调系数,y之1。若式
(28)成立,表明系统收敛;若不成立,即估计器的实
际误差将超过理论预计值y倍,系统处于发散状态。
当系统处于发散状态时,说明噪声统计特性
不准确,需要更充分地利用屹适应源波模型的估
计值,并通过新息对器声方差进行自适应地调
整,以保证后续时刻的系统收敛。因此当系统处
于发散状态时,有必要重新对模型概率进行分
配,取=0,L*=1,此时系统完全工作在自适
应的模式下。当系统处于收敛状态时,模型概率
依然按照式(14)得到,即采用IMM多模式的方
法进行载波跟踪,以加快收敛速度。系统的状态
估计是这两个模型滤波器所做估计的数据融合。
自适应融合的IMM算法既可以在每次选代过程
中对噪声方差进行自适应地调整,以适应当前的
噪声环境,同时根据系统收敛判断条件采用模型
概率的自适应调整策略,以克服自适应滤波收敛
时间长的缺点。
4“仿真校验
4.1“自适应融合后的调整结果
当深空接收信号的高阶多普勤变化率较小时,
通常可以采用恒变化率模型来分析接收信号频率。
同时由于BPSK调制的功率效率较高,抗噪声性能
好,所以本文针对BPSK调制信号进行讨论,则接收
信号的表达式为
式中:人为中频频率;Af为多普勒频偏;a为多普
勤变化率;4为信号幅度;8(t)为信息比特,取值1
或-1;n(4)为服从NO)分布的加性高斯白
噪声。
信号模型,针对本文提出的算法进行仿真。载波粗
捕获采用文献[18]的FFT鉴频算法。载波粗捕获
完成后,载波跟踪的多普勒频偏在35Hz以内,频率
变化率在15Hz/s以内。设观测噪声方差初始值为
R,,R,是真实值的1K10,在整个估计过程中,常规
卡尔曼滤波算法保持R,=R。,在载噪比(Carrier-
Noise-Ratio,CNR)为24dB-Hz的情况下,得到观测
噪声估计方差Rs,的变化曲线如图3(a)所示。当Ru
是真实值的10倍,得到R:的变化曲线如图3(b)所
示。图中,R(m,a)代表R,的第m行第n列的
元素。
从图3可以看出,Sage-Husa自适应滤波算法与
自适应融合的IMM算法都史以根据实际环境中的
噪声特性对R,进行连续地调整。在未知SNR信息
的前提下经过一定次数的融合迭代后Sage-Husa算
法的R,接近于真实值,自适应融合IMMBHR,
与真实值有一个小的佐差(图3(a)、(b)中R(1,1)
与真实值最大差值约0.05)。这是由于自适应融合
的IMM在每次迭代计算R,的过程中用到的新息
e:、预测误差协方差矩阵Pu:-,是由IMM模型集中
模型1和模型2经过加权融合得到的结果,为了保
证收敛时间,只有模型2采用自适应滤波模型,而模
型1仍然采用常规卡尔曼源波模型。所以经过融合
计算后的结果会与真实值有一定偏差,但还能基本
反映实际环境的观测噪声方差。而对于常规卡尔曼
滤波算法,当R,预设不准确时,则无法正确反映实
际的噪声特性。
4.2无相位噪声时的跟踪性能
在CNR为24至28dB-Hz的范围内,仿真得到
频率跟踪精度图,频率跟踪精度由均方根(Root
MeanSquare,RMS)频率误差来表示。当嵊声方差
未知,R,是真实值的1L/10时,常规卡尔曼滤波算
法、Sage-Husa自适应源波算法和本文算法的RMS
频率误差与CNR的关系曲线如图4所示。在CNR
为24dB-Hz的情况下,仿真得到3种算法的收敛时
间表。
表 + 收敛时间对比(无相位嵇声)
Table 1 Comparison of convergence time ( without phase noise)
算 法 Wie Feit 8] /s
卡尔曼滤波5.5
Sage-Husa自适应滩波11
自适应融合的IMM算法6
从图4可以看出,在载波跟踪的过程中,常规卡
尔曼滤波算法由于噪声方差初始取值不准确,又不
能对其实时调整,不能准确反映当前噪声的统计特
性,从而导致估计误差较大,特别是在低载噪比区
域。采用Sage-Husa自适应滤波算法后,滤波器实
时修正噪声方差的统计特性,使得估计误差变小,但
收敛时间增加了一倍左右。本文中自适应融合的
IMM算法采用基于IMM的模型概率自适应控制策
24 25 26 27 28
载噪比/dB-Hz
图 4 RMS频率误差与CNR关系囹
Fig.4 Relationships between RMS frequency error and CNR
略,不断修正状态估计值,并根据滤波收敛判据选择
相应的模式,使得估计精度高于常规卡尔曼溏波算
法,同时由于其噪声方差矩阵R,经过调整后与真实
值有一个小的偏差,所以估计精度略低于Sage-Husa
算法。
从表1可以看出,自适应融合IMM算法的收敛
时间远远短于Sage-Husa算法,仅比常规卡尔曼滤
波算法长0.5s。这是因为该算法经过一定次数的
迭代后,模型集的噪声方差基本反映了实际环境的
噪声特性,估计误差减小,系统处于收敛状态,此时
模型概率u大于uw,系统主要依靠模型!即可完
成载波路踪。根据1.1节所述,模型1的等效噪声
带宽较大,系统的收敛速度也随之加快。
因而本文的自适应融合的IMM算法在低载噪
比情况下工作良好,兼顾了估计精度与收敛时间的
要求,克服了常规卡尔曼滤波算法精度低及Sage-
Husa自适应源波算法收敛时间长的缺点。
4.3“有相位噪声时的跟踪性能
对于实际传输环境,由于信号在传输过程、调制
与解调端都会受到本振的相位噪声影响造成相位随
机抖动。因此,需要在有相位噱声的情况下进行仿
真分析。为模拟相位噪声,输人信号相位采用如下
模型“1;
B(妻l【_【I'】i'寓e一a【:k+A,(30)
式中;b,为正常无抖动情况下的相位值,A,为符合
高斯分布(w(0,:))的噪声。在CNR为24至
28dB-Hz的范围内,仿真得到4.2节中3种算法在
含有相位噪声情况下的频率跟踪精度图,如图5所
示。图中MSE为A,的均方误差(MeanSquare
Error),
24 25 26 27 28
载噪比/dB-Hz
图 5 含相位噪声时RMS频率误差与CNR关系图
Fig. 5 Relationships between RMS frequency error
and CNR with phase noise
表 2 收敛时间对比(有相位噱声,MSE=0.5)
Table 2 Comparison of convergence time
( with phase noise, MSE = 0. 5 )
算法收敛时间/s
卡尔曼源波6
Sage-Husa自适应滩波15
自适应融合的IMM算法6.5
从图5可以看出,在有相位噪声的情况下,两种
基于自适应能力的源波算法受到相位噪声的影响较
小,在CNR为24dB-Hz,MSE3%0.5时,频率路踪
精度的损失都不到0.4Hz。而常规卡尔曼源波算
法的频率跟踪精度在相同的条件下,损失达到
0.8Hz以上。这是因为Sage-Husa自适应滢波算法
在源波的同时,可以根据实际相位噪声的变化情况,
不断估计和修正滤波器的噪声统计特性以提高滤波
精度,但收敛时间与无相位嚣声时相比,长了4s。
这是因为加人相位噬声后,观测值准确度下降,为了
保证估计精度,滤波增益减小,估计器的收敛速度变
慢。而自适应融合的IMM算法除了可以实时修正
估计器的噪声统计特性外,还可以自适应地调整模
型集中各模型的概率,从而得到估计状态的最优值,
并缩短了跟踪收敛时间(收敛时间仅比无相位噪声
寺长0.5s)。
5&“论
本文提出了一种自适应融合IMM的载波路踪
算法,在信瞿比信息未知的条件下,设计噪声统计参
数的自适应控制策略,对未知的噪声统计参数进行
估计和修正。根据估计精度、收敛时间的要求建立
一个含有多个模型的模型集来描述系统当前的模
式,系统的总体估计是各个模型输出状态估值的概
率加权融合,并根据系统收敛判断条件对模型集中
各模型的概率进行自适应地调整,在一定程度上兼
顾了跟踪精度与收敛时间的要求,适用于深空自主
无线电接收系统。
