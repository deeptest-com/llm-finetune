一种改进的强跟踪滤波算法
强跟踪滤波算法由于对判断滤波发散的阈值设置较小,以较大概率产生渐消因子而导致对滤波增益过调节,最终对状态估计不够平滑.在分析强跟踪滤波算法运行机理的基础上,提出了一种改进的强跟踪滤波算法.通过适当提高判断滤波发散的阈值,有效降低了误判滤波发散的概率,并能针对不同维数量测方程确定不同的弱化因子,避免了凭经验加入弱化因子解决这一问题的缺陷.数值仿真结果表明：改进的强跟踪滤波算法对系统状态突变不但具有较强的鲁棒性,而且能有效保持滤波精度和对状态估计的平滑性,从而验证了该算法的可行性和有效性.

强跟踪滤波 鲁棒性 渐消因子 弱化因子  

robustness, fading factor, softening factor
在坝代估计理论中,卡尔曼孺沧(Kalmanfilter,KF)具有重姗的地位,但对十模塑说莲鲜
棒性不强,严重时甚至发散[团为了提高KF的估计精度,阻止其发散,文献[2-3]提出了渐消
滤波算法.该算法在滤波方程中加入渐消因子,
降低了旧量测值对滤波估计的修正作用,增加
了新量测值在源波估计中的权重,有效抑制了滤波发散.文献[4]基于渐消滤波算法思想,提
出了可以自适应地求取最佳淅消因子的强跟踪滤波(strongtrackingfilter,STF)算法,根据强
迫残差序列正交的方法来确定最佳渐消因子,使得源波在具有模型误差和状态突变时仍能很
好地跟踪状态的变化.该算法具有较强的鲁棒性和较高的估计精度,因此得到了广泛应用l;
但对状态估计不够平滑,即使引入弱化因子加以调节(弱化因子需要凭经验选取),也难以在
实际中应用I“101,
本文深入研究了STF算法的理论基础,并将其应用于一维线性系统.STF算法对判断湍
波发散的闻值设置较小,使误判溏波发散的概率增大,即使在系统正常的情况下,产生淅消因
子的概率仍然较大,导致对滤波增益的过度调节,影响了状态估计的平滑性.为此,本文提出
了改进的强跟踪源波(improvedSTF,ISTF)算法,通过适当增大判断滤波发散的闻值,降低
了误判滤波发散的概率,有效弦补了对状态估计不平滑的铁点,日不必凭经验选取弼化因子,
使其在实际应用中更便利.
1“STF算法
考虑如下的线性模型:
式中,weve为零均值的高斯白噪声,其协方差分别为
Elwiwi] = Qu, Elusvg | = Ry
则STF算法的递推公式如下:
Bk+l/yhk = Fue
其中
式中,tra(.)表示对矩阵求迹;p为遗忘因子,一般取p=0.95;8>1为弱化因子,它可以使状
态估计值更加平滑,通常6>1凭经验选取.同样需要说明的是,MD,x+li并没有理论上的求解
方法,故只能依靠输出残差序列的加权和近做获得[K6l.
若系统模型为非线性,即
则非线性系统下的强跟踪扩展卡尔曼滤波(strongtrackingextendedKalmanfilter,STEKF)算
法应将一步状态预测方程和一步量测预测方程改成如下形式:
式中,和Heya可分别以系统方程和量测方程的雅可比矩阵来代替,即
其他方程不变.
2STF算法分析
2.1STF算法原理分析
当系统模型正常时,在最优溏波条件下,系统输出的残差应该是互不相关的高斯白噪声
序列L+14,即
| Vik 二 丁 (yiY) 二 0, i#k
旦
MD,x+1二z…;〈′')'/【(=-_一1′')′彗`苛一1)一
′′茎′C十1z〕′(亨〈_^1/′【7zT芝彗`_|′1十Ret1
当系统具有模型误差或者状态突变时,MD,x+l变大,从而使得
在强跟踪滤波算法中,为了保证溏波的最优性,需要将Po放大Ax+1倍,强迫输出的残差
序列相互正交,即令
根据式(20)即可求出Ae+t,不但披制了滤波发散,而且得到了最佳的滤波结果.
分析式(19)和(20)可知,可以将强跟踪滤波对Axc+i的调整认为是对Vopr设置了一个
RITUAL UXT T 3 LU DLX RA 1 月 U3 _ 2K 1IKy _kALUJ ZINA A 十 1 ; 门 火 J〉 A441 一 士 Ph 八 LL f F 一
尔曼溏波公式.
然而在实际应用中发现,强跟踪源波对状态的估计不够平滑,于是加入弱化因子来克服
这个问题.弱化因子的选取并没有具体的公式,
而只能靠经验选取,这给实际应用带来了不便.
2.2STF算法问题分析
本节将STF应用于正常情况下的一维线性系统,以分析产生上述问题的原因.
由于分析的系统为一维,滤波方程中的每一项皆为标量;但为了便于理解,以及向多维系
统STF进行扩展,滩波方程仍然以向量形式表示.
′显然,当系统模型准确下没有状态突变时
,KF为最优源波,此时若应用STF,则滤波方
程应当尽量保持与KF溏波方程一致,较少地产生大于1的渐消因子,才能得到较好的估计结
果,日使估计曲线更加平滑.
应用STF时,由于,x+l没有解析解,而只能通过残差序列加权求和近似得到,侗得近
似值与理论值相比,会有一定概率产生较大偏差,而较大的偏差导致滤波结果不够平滑.证明
如下:
为了表示与“+1次输出残差方差近似值Vb,*+i的区别,以Cox+i表示其理论值,则有
Cok+1 = Hiy1Pey1/Hiyy + Rk+1 (22)
Hk=21, p 二 0.95 时 , 有
由KFBERTH,ye服从均值为0、TENCopy的高斯分布.在源波过程中,对
于k+1时刻得到的残差Yp+l「,可以认为是对高斯分布N(yxe+l;0,Cox+1)的一次采样,根据
概率论的知识可知
PvE, 1 不 2Co,x+1) = 84.1%
此时判断滤波发散的概率
P(Vo,e+1 = Cot1) > P(t
> 2Co 511) = 1 — 84.1% ~ 16%
这说明即使是在系统正常工作的情况下,STF算法也会导致超过16%的概率判定系统
以上两个原因导致STF对状态估计过分依赖量测值,使得溏波增益达不到最优,导致估
计效果不够平滑.
若在Ne+i中加入弱化因子8,则将阅值增大为HyerPopajpHY,+BRe+l,相当于提高
了判断滤波发散的闻值,减少了在正常情况下产生渐消因子Ax的概率.然而,BHCort迦
与Pen有关.对于不同系统,单纯地调整0没有规律可寻,而只能凭经验或试验选取,故缺
乏可操作性,
J ANI RK FFL
由2.2的分析可知,STF对状态估计不够平滑的主要原因如下;对Vopr的近似不够准
确,导致对判定源波异常的阗值设置较小,即使在系统正常情况下,也有较大的概率被视为
溏波异常,从而产生渐消因子,破坏了滤波的最优性.要使STF的估计曲线更加平滑,以提
高STF的溏波精度,则应适当增大判断渡波发散的阗值,在保证对模型失配和状态窃变具有
较强鲁棒性的同时,使系统在正常工作情况下产生尽可能少的渐消因子.
由于
P(′Y′′′童十1一6Co,x+1)=98.5%
可知
P(Ye4r 之 6Cokx+1) = 1.5%
于是可将阗值提高到3Co,e+i,此时如果不考虑Vo,则有
P(VMx+i > 3Cont1) = P(v2,, > 6Cox+1) = 1.5%
如果考虑Vor的影响,BTVor<Co,x+l「即使假设两者相等,仍有
P(Hnyl 么 3Cox+1) = P(y&hl 么 5Cog+1) = 2.6%
因此,当将D,e+l的阙值取到3Co,x-+i时,
STF算法在正常工作情况下误判滤波发散的概
ETE1.5%~2.6%,于是大大降低了产生淅消因子的几率,使得STF更加接近KF.对于因
状态突变或模型不准确导致的误差,如果其方差小于3Cox+l,则可视为合理的高斯白噪声,
直接利用KF处理.
当系统具有模型误差或状态窕变时,将阗值取为3Cox+l,则有
Vo,p+t4=矾入灶十1互险十1FkP灶F汪H菖十l十j【1「′c」「1C2′c〕L止「j「昙「苛_1十屉k+1)(24)
从而有
弱化因子6「=3,这样结合式(3)~~(8)便构成了ISTF算法.
与原STF算法相比,改进的算法对Neo和Mo进行调整,并增加了针对HeQuHL
和HxylPkPkFFHZi的固定弱化因子V=3,
能避免通过经验选取弱化因子的麻烦;同时新
界乎人炙怡坦列四日X巩厂2正,也育应正堑奶团友V止.
以上关于ISTF算法推导均基于一维系统,
但也可以推广到多维系统上.当推广到多维系
统时,在理论推导上需稍作改变,弱化因子也要适当调整,此时STF算法判断滤波异常的条
件为
仍然假设Hb,x=Co,x+l,则式(31)等价为
式中,n为观测向量的维数.
此时应当选取合适的6,使误判滤波发散的概率P(54ukx+l>(26「—1)n)控制在较小的
范围内.由于6x+i的每个状态分量都服从标准
的正态分布,5&+16x+l服从自由度为n的X2分
布,根据x?分布的性质可知误判滤波发散的概率为6「和n的单调递减函数,若单纯调节6将
难以达到较好的效果,故需要对不同的n求取不同的9「.为了保证STF对状态突变和模型误
差的敏感性,误判滤波发散的概率也不宜设置过小,只需将其控制在3%以内即可.对照x2分
布表可知,量测向量维数n与弱化因子9「的关系可表示为
此时8「的取值可以看作是对ISTF鲁棒性和平滑性的一个折中,如果8「取值较小,则算
法的鲁棒性较强,对状态突变和模型误差的跟踪性强,但对滤波发散的误判概率较高,估计效
果不够平滑;如果BERK,则误判滤波发散的概率变小,降低了产生大于1的渐消因子概
率,况且渐消因子较小,导致对模型失配和状态突变不够敏感,鲁棒性减弱,甚至可能使算法
退化为智通的KF或EKF.
若非线性系统采用线性化的EKF算法,则带来一定的截断误差,而这些误差会影响所
设计的强跟踪滤波算法的性能,因此在求取渐消因子时必须加以考虑.根据文献[15]的理论,
可以将非线性系统线性化带来的误差看作虚拟白噪声,为了保证算法的鲁棒性,可以适当将
虚拟白噪声的协方差扩大.假设由线性化引起
的系统虚拟噪声和量测虚拟噪声的协方差分别
为0.5GQk和0.5Rk+l,此时可认为系统噪声和量测噪声协方差为1.5@Qx和1.5Re+l,则淅消因
子和弱化因子的关系为
从而对于非线性系统,ISTEKF的淅消因子可以解得
Ak+1 = max(1, Ao)
M T APNE) MTA RL
4“数值仿真及分析
本文采用文献[给出的非线性系统模型来验证所提出改进算法的有效性,其非线性模型
如下:
此 k 十 1,1 二 0.001 (dg zx 一 e′(:z)/c)/c/~痘 十 乙 ,l 十 2DR,1
Zk+12 = 0.001L( 一 ekzk + asbr)/ck 十 Zf,2 十 Wi 2
此 p+1,3 = 0001m腻1 十 Cf,3 十 Wi 3
Zk+l,4 = 0.0012k 2 + Tia 十 Wa
Ye+1,1 二 Tht+1,1Tk+1,3 十 Vk+1,1
Yk+1,1 二 Ck+1,2 十 Uk+1,2
式中
dr = a1 + a2co8(Tk,4), ex = as + 0.5azcos(x,4),
Zr=Q2sin(zx,4)(Tx,1%k,2+0.52%5)一Q4〔薹OS(:】二′c，二…)一Us〔〉OS(二[〉′c，3十重)〕Z罐，z薹〉十仑k,l,
be = 一 0.5aa sin(2k,4)2& 1 一 Q5 cos(5k,3 + Tha) + Uk 2,
cx = asd 一 es, a; 二 3.82, Q2 = 2.12,a3
二 0.71,a4 = 81.82,a5 = 24.6.
在滤波过程中设
Q=0, R=diag(0.01,0.01,0.01),
up = 125 一 5(1 一
exp(—0.2k)),
&k2 = 125 — 10(1 — exp(~0.2k))
仿真时间为200s,同时假设当5=70和*=140时,由于外部强干扰,zx.i分别有+4和一3的
窃变,于是分别使用EKF、STEKF(弱化因子为1)和本文提出的ISTEKEF对系统进行滤波.
对于ISTEKF,由于量测向量的维数为n一3,
则根据式(34)可知弱化因子取4=3较为合
适.为了验证本文所取9「的合理性,又分别取9「=2,8=6两种情况进行比较,此时得到的
状态k,l的估计曲线和淅消因子的响应曲线分别如图1和2所示.
图 1 ap的估计曲线
Figure 1 Estimate of z?,1
图 2 渐消因子响应曲线
Figure 2 Response of fading factors
由图1可知,EKF不能跟踪状态的突变,且鲁棒性较差; STEKF和本文提出的ISTEKF
(6「=2,6「=3)都能对状态的突变迅速反应,具有较强的跟踪能力.然而,STEKFMRE
的估计不够平滑,不论是否发生状态突变,STEKF都会围绕理论值产生抖动;ISTEKF(9「=
2)的光滑性好于STEKF,日较ISTEKF(9「=3)稍差;ISTEKF(G「一3)的估计结果最平
滑,即使有状态究变,仍能快速跟踪真实状态,且围绕理论值抖动时间较短,估计结果更精
确;ISTEKF(4「=6)的跟踪能力较弱,不能对状态窃变快速反应,其原因在于4的设置过大,
导敏算法对模型失配和状态突变不数感,这也验证了前面的理论分析.'
由图2可知,STEKF在较多时刻产生了大于1的渐消因子,在状态窃变时产生的渐消
因子较大,在状态未突变时产生的渐消因子较小.正是由于STEKF在状态未突变时产
生了较多大于1的渐消因子,才会使源波估计过分依赖量测值,导致对状态估计不够平|
滑;ISTEKF(8=2)产生的渐消因子少于STEKF,但也在状态未突变时产生了大于1的渐
HEF,影响了估计效果;ISTEKF(B8「=3)只在状态发生窃变后产生大于1的渐消因子,并
东渐消因子迅速减小,直到下降为1,这样避免了对滤波增益的过调节,保证了较好的估计
效果;ISTEKF(=6)也只在状态窃变后产生大于1的淅消因子,但4设置过大会导致渐消
因子较小,产生的源波增益也较小,降低了对量测值的依赖程度,减弱了对状态突变的跟踪
能力.
5“结语
STF算法对模型失配和状态窃变的系统具有良好的鲁棒性,但对状态估计的结果不够平
滑,需要加入弱化因子来调整.然而,弱化因子没有确定的求取方法,对不同系统只能通过试
验或经验选取,因此在实际应用中不够便利.为此,本文提出了ISTF算法,通过适当提高判
断源波发散的阎值,降低了误判滑波发散的概率,较为合理地产生大于1的渐消因子,并针对
不同维数的观测方程选取不同弱化因子.理论分析和仿真结果表明,ISTF算法能在保持鲁棒
性的同时有效提高滤波精度,使状态估计曲线更加平滢,具有实用价值.
