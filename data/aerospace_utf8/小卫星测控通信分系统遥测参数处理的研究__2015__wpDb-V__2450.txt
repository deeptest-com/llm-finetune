小卫星测控通信分系统遥测参数处理的研究
提出一种小卫星遥测参数的处理方法 ,它采用三帧同步捕获的方法来减少误同步和漏同步 ,从而提高测控通信分系统的可靠性和有效性 ;同时 ,采用对遥测参数进行分类处理的方法确保测控系统可靠地运行

+小卫星 遥测 同步 可靠性  

面向孙航任务,尤其是载人、交会对接、捕获等
关键任务的空间嵌人式电子系统,通常要求具有高
可靠性和故障容错能力.常规芯片的失效率一般为
10“次/秒量级,关键任务类嵌人式电子系统则通常
要求平均无故障时间(MTBF,meantimebetween
failures)要达到10“h或者更高.为滢足任务期内的
高可靠性要求,关键任务类电子系统需要通过多模
热备份容错来实现.
空间多模冗余峰人式电子系统的多模热备份之
间可能由于时钟偏差导致失步.例如,以晶振10us/s
的精度计算,在1s内多模之间的时钟偏差可达微秒
量级,且该误差将随时间累积.空间多模冗余崴人式
电子系统在热备份工作模式下要求多模之间满足一
定边界条件(如偏差不超过1us,根据系统需要确
定)的精确时钟同步,多模之间时间偏差过大将导
致计算机无法收敛一致,给任务带来致命风险.
本文在空间多模冗余髅人式电子系统基础上,
基 于 IEEE1588 协 议 , 采 用 FPGA( field programmable
gate array )/ASIC ( application specific integrated cir-
cuit)技术,结合软件和硬件同步,提出了一种多模
热备份的时间同步算法.该算法既有硬件同步的精
度优势,同时具有软件同步的成本优势和容错能力.
1“多模冗余的同步方法
空间多模冗余热备份嵇人式电子系统同步的方
法主要包括:(1)热备份多模采用外部提供的统一
时铁;(2)热备份多模各自提供一组时钟组成热备
份时钟,多模通过交互算法选择其中的一组作为多
模的统一时钟,出现故障后切换时钟;(3)热备份多
模通过软件信息或硬件信号交互,通过同步算法完
成同步.
三种同步方法各有特点.方法(1)中,统一时钟
需要外部提供单独的硬件电路,且外部的时钟产生
电路将成为系统的可靠性瓶颈:当统一时钟出现故
障,将出现多模任务中断,无法满足对时间连续性要
求较高的任务需求.方法(2)中,选择多模某时钟的
算法则不需要提供唯一的时钟硬件电路,对于时钟
故障的容错能力有所提高,但切换时钟会造成时钟
连续性中断.这两种同步算法存在的缺点在关键任
务类嵌人式电子系统中是不可容忍的.
方法(3)中,同步算法的时钟连续性较好,对于
错误的容错能力最好,但对软硬件要求较高,在国内
文献中未出现航天工程应用.多模同步算法分为硬
件和软件同步两种“1.
硬件同步算法通过硬件锁相环完成多模间的时
间同步,通过计算本地时钟和外部时钟的相位差获
得多模之间的时钟误差信息,将相位差转换的电压
信号输出给压控晶振调节晶振输出频率完成时钟同
步,此算法精度较高,需要额外的复杂硬件支持,一
需要占用单独的时钟拓扑通道“““1,
软件同步算法通过软件信息交互完成同步,对
软件的消耗较大,日由于信息的传递、处理造成延
时.软件算法的精度较低,通常只有毫秒量级“1.软
件算法中的一种常见应用为TEEE1588华议.
对于单一的硬件或软件算法都存在缺点,但采
用软硬件结合的方法可以在资源消耗和性能之间进
行取舍,获得不同环境下的最优效果.超大规模FP-
GA/ASIC器件在空间广泛应用,为实现同步算法
(3)提供了实现技术途径.
通过FPGA/ASIC等大规模逻辑器件处理同步
算法协议,可以降低处理器的软件负荷;采用FP-
GA/ASIC模拟传统硬件同步所需的相位误差比较
器和压控振荡器完成时钟精确同步,可以在不增加
复杂硬件电路的前提下提高系统时钟同步精度.由
于容错需求,空间多模冗余崴人式电子系统多模热
备份之间通常具有全交织的交互拓扑网络,如图1
所示(以5模系统为例),多模同步算法可以通过此
全交织网络完成信息交互同步.
IEEE1588标准的全称是“网络测量和控制系统
的精密时钟同步协议标准(IEFEE1588precisiontime
protocol)“,简称IEEE1588PTP,它的基本原理是通
过一个同步信号周期性对网络中所有节点的时钟进
行校正同步.这种协议非常适合对同步有严格要求
的嵌人式电子系统.IEEE1588协议的同步六层
mF,
(1)网络主机对其他计算机广播同步Sync报
文,从机收到Sync报文后记录报文到达时间7;
(2)网络主机广播Follow_Up报文,报文中包含
(1)Sync报文的发送时间T;
(3)从机向主机发送Delay_Redq报文,并记录报
文发送时间7;
(4)主机记录接收到Delay_Redq报文时的本地
时间口;
(5)主机向从机发送DelayResp报文,包括
(4)中的T,时间;
(6)从机从7!~7计算主机和从机的偏差4,
对从机本地时间进行校正.
假设网络通路具有双向相同的路径延时,在同
步过程中,从机的时钟斜率稳定,则4=(7+7-
T, -T,) 21.
空间多模冗余嵌人式电子系统具有如下特点:
具有可靠的全交织拓扑网络;需要较高的可靠性,需
要根据需求容忍m(meN,m女1)重任意故障;多模
之间更需要严格的同步.因此,IEEEK1588是空间多
模冗余嵌人式电子系统多模之间同步的一种有效解
决方案.图2描述了基于IEEK1588的多模同步算
法流程.
辑,在相位误差测量方面结合软件IEEELS88协议
提高系统自主恢复能力,完成具有自建容错能力的
多模热备份的时间同步.首先根据算法边界条件需
要设置部分参数;
(DN为系统内的计算机冗余模数,i,j一W;
(2)F REF EW;
(3)m为系统中最大故障计算机数目,加之1;
(4)Sm:(1~N)为1~W中最大的m个值的
和;
(5)Emuin(1~N)为1~W中最小的m个值的
和;
(6)p,为机的时钟精度误差,通常为10us/s
量级;
(7)P为同步操作的最小周期;
(8)卫为通信窗口的最大时间,<P;
(9)7为初始同步建立时对应的时间;
(10)4为传输路径最大延迟,网络为对称网络,
则d=一;
(11)e为硬件锁存最大误差;
(12)4y为;机和}机的时间差别5
(13)W,为机时钟稳定性误差;
(14)8为网络传输不对称性造成的误差.
BeTa(n)为系统实时时间,量化为系统主频的
数字量函数,Tu(n)=n/Ff,n为非负整数.系统内
单机;通过本地晶振产生本地数字时钟7.,其对应
的真实时间为(n/F)(1+p)+卫;+T,.
图 3 描述了此系统中某双机间数据交换流程.
以单机1为例,当其记录的本地时间7=Pe,(t为
非负整数)时,单机1将自己的IEPEE1588T打包发
送,并在[7T!T,+]时间内等待其他N-1单机的
时间信息.单机2~V在收到时间请求后,将收到信
息对应的本地时间T,~Ty打包并通过总线返回数
据-单机1通过大规模逻辑硬件记录其他N-1单
机的时间信息到达本地的准确时间72~7w.
(T, +T, - 27.)72 .
为减小软件处理IFEE1588带来的延迟,本文
采用硬件结合软件处理的方式.采用FPCA/ASIC锁
存IEEE1588到来的精确时间,然后处理IEEE1588
华议,当协议正确后,采用之前硬件锁存的时间进行
处理,将IEFEKE1588校时从毫秒量级减小到百纳秒
量级.
本文借鉴IEEE1588完成多模时间同步,设计
的多模为平等优先级,不采用主从模式.对于本文所
设计的实时嵌人式系统,同步间隔、时钟的稳定性、
网络传输过程中的抖动等因素对时钟同步精度影响
很小,可以不予考怀.
在设置系统仅有m个错误单机的条件下,通过
剔除4,,~Ay中m个误差最大值和m个误差最小
值可获得不包员错误的有效数据,并通过将有效的
误差数据的结果求罚均,可得出十机1与系统平均
REE.
将北值用于修正本地数字时间的计数器8(n)
=Ti(n)+A,,模拟等故压接振草器的频率,达到
时信咤加的一的.
此协议不仅可用于镁定状奋下的咖步跟蔡,也
适用于多模上电后皇初始同技和某机失步后的盂新
搜索建立哽步,具有一定的自适应性和故障容锦侥
复能力.
需要注意的是,此算法会造成系统时间回卷,包
括同步建立后的时间回卷和初始化同步时的时间回
卷.其中,同步建立后5单机时间回卷最大值为Ppi,
因此在[aP,(a+1)P-Pp:]内系统为时间非髂系
统,可用二非减系统运算,在初始同步时RETR
会较大范国回卷,需要教件进行初始同步的特残
处理.
初始局娄采用此方法会造咤间步建立时部分单
机的时间囱卷,需要系统应用时进行处理.文献[5]
证明,同步系统采用剖除m个最大借和最小值的误
差约为4=Se+4pP,p为时钟精度误差.
结合IEEE1588算法后:;p较大的单机会先进行
时间同步,因此敢个系统的哽步结果不能和真受如
间保持一致,仅在W个单机之阅悬持林互同步,NW
个单机乐间绩口IEEE1588协议后的鬓大系统误差
浑Ap二CE十心吾+′歙叠′pP`，v`醴〉_心河y_为`=′鳝『蛾.`系统亡与真
实时间的料率愚差小于puu.
对于FPGA/ASIC大规模逞辑电路,信号的镁存
误差通常小二1005s量级:对孙硬狗饮路对称皇入
交线网络,8小于百纳秒量级;精密晶摄的p运常为
10&e/s.固此,本箍法可支持的最高时闭同步精度为
百纳秽量级.实际系统征计时史捐炜上述公式计算
所霸的参数PAE,例如当系统要求谒差为sBR
封,警要特然lms进行周期性的数描名步.在Lon
内,时钟偏菱不超过100ns,则玉认在百纳秋量级校
据霁梯选戡.^′
3“仿眩结果
本文涉及的空间愉人式电子系统,梁用3朱热备
份冗余容锦结构,静够容恒!个任意嗣障.通迹Matlab
对此算法进行仿真,仿真系统的构建接煌真实系荫中
所能实现的参数进行设罡,以便真实模捣算法的运行
情 况 , 这 里 设 置 万 =40MtHs,N =5,m<1,9,~10ps/s.
图 4 为单机的时间育武效果.图5为路蹄误差
结果.为能够清晰暧示,增太p,后的路踪效果示意
图 妮 图6所示.图7冼增大p后的系统初始同步和
荣障机荠人系统的效杰示意图.
出版社,2005
[6]黎连业,王华,李淑春.软件测试与测试技术[M].北
京:清华大学出版社,2009
[7]赵国亮,蒋勇,孔令兵.用代码分析技术检测软件缺
陷[.计算机工程与设计,2011,32(8):2741-2744
Zhao G L, Jiang Y ,Kong L B. Software bug detection u-
sing code analysis technology[ J]. Computer Engineering
and Design ,2011 ,32(8) :2741-2744
[8]杨朝红,宫云战,肖庆,等.基于模型的软件测试[J.
北京化工大学学报,2007,34(增刊1):85-88
Yang Z H,Gong Y Z,Xiao Q W,et al. The software tes-
ting based on testing model[ J]. Journal of Beijing Uni-
versity of Chemical Technology ,2007 ,34 ( sup1 :85-88
(上接第48页)
通过分析和上述仿真可知,本算法在初始不同步
的条件下建立系统多模同步,在同步建立好后锁定并
保持时间同步,并在出现暂时故障后自主将错误单机
并人系统.在时钟频率大于10MHz的系统中,最高同
步精度可达到百纳秒量级,在3个节点的系统中,可
以容忍1个单机出现任意故障并进行修复.
根据前文可知,本算法的局限性在于时间会出
现部分回卷,需要系统设计时进行容错处理.上述问
题将在后续研究中进行政进.
[9]杨洪路,宫云战,高文龄,等.软件安全静态检测技术
与工具[J].微型机与应用,2009(9):70-72
Yang HL, Gong Y Z,Gao W L, et al. Static analysis of
software security techniques and tools J]. Microcomput-
er & Its Application, ,2009(9 ) ;70-72
[10]王光卫,范明钰.源代码分析技术的理论和实践发展
[刀.计算机安全,2011(1):7-10
Wang G W, Fan M Y. Theory and practice of source
code analysis[ J]. Network and Computer Security,2011
(1):7-10
作者简介:侯成杰(1972一),男,高级工程师,研究方
向为软件测试与软件产品保证技术.
rithm based on FPCA[ D] . Hangzhou: Zhejiang Univer-
sity ,2007
{ 3 ] Lundelius J,Lynch N A. A new fault-tolerant algorithm
for clock synchronization [ C ] The 3 Annual ACM
Symposium Principles Distributed Computer,Columbia ,
1984
[ 4 ] Morowitz E, Sahni S. Fundamentals of computer algo-
rithms [ M]. Rockville MD; Computer Science Press,
1978
[ 5 ] Lundekius-Welch J,Lynch N. A new fault-tolerant algo-
rithm for clock synchronization[ J]. Information and Con-
putation, ,1988 ,1(77) :1-36
[6}黄文君,遇彬.基于FPGA的精确时钟同步方法
[J1.浙江大学学报(工学版),200741(10):1697-
1700
Huang W J,Yu B. Method for precise time synchroniza-
tion based on FPGA[ J]. Journal of Zhejiang University
( Engineering Science) ,2007 , 41(10) : 1697-1700
[7]刘志朋.基于ECC肝签名的安全数字时间戳的研究
与实现[D].长沙:长沙理工大学,2008
Liu Z P. Research and implementation of security digital
time-stamping based on ECC blind signature[ D]. Chan-
gsha: Changsha University of Science and Technology,
2008
[8]周春莲.基于时间戳的数据同步技术实现研究[D].
南昌:南昌大学,2009
Zhou C L. Research and implementation of data syn-
chronization based on time-stamping [ D ]. Nanchang:
Nanchang University ,2009
