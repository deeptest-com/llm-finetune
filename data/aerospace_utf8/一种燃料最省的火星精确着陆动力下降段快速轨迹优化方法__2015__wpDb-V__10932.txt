一种燃料最省的火星精确着陆动力下降段快速轨迹优化方法
针对火星精确着陆问题,给出一种燃料最省的火星着陆动力下降段快速轨迹优化方法.首先以燃料最省为指标建立了着陆器动力下降段轨迹优化问题模型,然后利用极大值原理对该模型的推力大小、推力方向与协状态变量之间的关系进行分析,得出着陆器推力只能以最大或最小推力工作、推力方向和与速度对应的协状态矢量方向相同的结论.并以此为基础,将原问题的状态微分方程和协状态微分方程转换为有限个推力为常值的分段函数,推导每段内微分方程的解析表达式,给出了动力下降段轨迹优化方法的算法流程;最后通过数学仿真将所提出的方法与凸规划、多项式制导方法进行比较.结果表明该方法不仅避免了多项式方法没有考虑推力约束及燃料消耗的缺陷,而且在计算效率方面较凸规划方法有大幅度提高.

火星探测 精确着陆 动力下降段 燃料最省 轨迹优化  

05言
对于未来的火星探测任务,选择在科学价值高、
地形复杂的区域着陆成为必然的要求和发展趋势,
这要求火星着陆器具有较强的精确着陆能力“。
NASA的Wolf等人指出,在火星着陆的动力下降段
引人控制,是消除绘图误差(map-tieerror)、火星表
面阵风引起的误差,从而达到定点软着陆的有效途
径“。动力下降段的轨迹优化是动力下降段制导
控制问题中的重要研究内容,提高轨迹优化速度,使
着陆器具备在线实时生成着陆轨迹对提高着陆器的
生存能力和着陆精度具有重要意义。
针对动力下降段的轨迹优化问题,众多学者和
科研机构从实际工程到理论基础方面都进行了探
索。在实际工程方面,多项式制导算法在Apollo飞
船登月舱的着陆任务中得到了验证“-““「,该方法痊
着陆器的标称加速度用一个以飞行时间为自变量的
二阶多项式表示,继而积分得到着陆器的标称速度
和位置曲线,给定预测飞行时间,利用着陆器初始点
和期望着陆点的状态计算相应曲线当中的参数,从
而得到着陆嚣的期望着陆扔迹。然而,这种算法没
有考虑推力器推力限制及燃料消耗的问题,仅适用
于着陆命水平机动距离不大的情况。
在理论研究方面,有学者尝试使用直接法来求
解动力下降段的轨迹优化问题。加州理工大学JPL
实验室的Acikmese等人在使用直接法对动力下降
段的轨迹规划问题进行研究时,将着陆轨迹优化这
一约林集非凸的优化问题转换为一个二阶锥优化问
题进行求解““““,给出问题求解过程中最优飞行时
间的有效选择方法、由于直接法离散化带来的离散
点之间状态不满足约李等问题的处理方法“;并进
一步考虑实际任务中各种观测器的指向性约束,给
出了指向约束下燃料有限着陆器的最优制导算法,
并对算法进行了性能评估“““,哈尔滨工业大学的
林晓辉也采用这一方法对多约束情况下的动力下降
段轨迹规划问题进行了研究““。美国航空航天局
约翰逊空间中心的Sostaric则将着陆器的各个状态
曲线分别用一个Legendre多项式近似,继而将动力
下降段的辐迹规划问题转换成为一个求解Legendre
多项式系数的参数优化问题,得到着陆器的下降辐
HU,这些算法均是将着陆器状态用一个多项式表
示,将轨迹优化问题转换为一个多约林的静态参数
求解问题。对于这类算法,节点个数选择多少能够
满足精度要求还需要进一步的研究或者凭借经验选
取,并且算法随节点个数的增加计算量急剧增加。
另外,还有学者使用间接法对此问题进行研究。美
国CharlesStarkDraper实验室的D「Souza通过在目
标函数当中引入一个下降剩余时间权重因子,将原
问题转换成一个无约束的最优控制问题,给出了一
种解析的燃耗最优解,但其没有考虑推力受约束的
情况“““。日本大学的Uchiyama通过引人闸函数的
方法,将动力下降段的轨迹设计这一输人受限的最
优控制问题转换成了一个无约束的最优控制问题,
并通过选择闸函数的形式,推导了动力下降段制导
律的解析解““,北京控制工程研究所的胡锦昌则通
过引入饱和函数的方法,推出了推力有界的制导
律““,但均没有将燃料消耗纳人最优指标中,不是
燃料最省解。加州大学欧文分校的Najson将动力
下降段的制导问题描述为一个以能量最省为指标的
最优控制问题,并将原最优问题近似转换为两个状
态方程和协态方程具有解析表达式的最优控制问
题,降低了求解最优控制问题的计算量,得到了原问
题的次优解“1。文献[17]针对推力为常值的着陆
系统,将着陆系统简化为平面运动,以控制能量为指
标函数将原问题转换为一个两点边值问题,并进一
步将指标函数用三角函数近似表示,推导出了平面
运动假设下的以控制能量最省为目标函数的最优控
制问题的解析解。德州大学奥斯汀分校的Chomel
则通过假设在动力下降段推力加速度为常值,给出
动力下降段制导律的解析表达式““。
通过以上分析可知,文献[4-5]没有考虑燃料
消耗和推力器推力受约束的问题;文献[6-12]存
在节点个数如何选择及节点个数过多时的计算效率
问题;文献[13-18]获得的解析解形式多是建立在
原系统简化假设的基础上,求得的解本质上是一种
次优解。本文算法在没有简化情况下,将动力下降
段的轨迹优化问题归纳为一个三维空间的推力受
限、燃料最省的最优控制问题进行求解,利用极大值
原理对其推力形式进行讨论,将原闰题的状态微分
方程和协状态微分方程转换为有限个推力为常值的
分段函数,推导每段内微分方程的解析表达式,使得
选代求解最优控制问题的效率大大提高。
1“火星着陆动力下降段软迹优化问题建模
为了便于描述,定义着陆点坐标系如下:该坐标
系原点为预先选择的着陆点正上方某一高度处(此
高度可根据实际任务确定,通常取为30m),Z轻从
火星质心指向预定着陆点,X轴沿经线指向东方,
粘与Z轻、轲满足右手法则,记为罗:0,-乙Z,Z,。
定义着陆器在着陆点坐标系下的状态向量为;
着陆器在着陆点坐标系驯下的动力学方程为:
r二了
、丁
式中:g表示火星表面的重力加速度,在动力下降过
程中可以当作常量,a表示着陆器推力系统的特征
参数,e表示着陆器推力方向的单位矢量,m表示着
陆器的质量,7表示着陆器推力器推力的实际大小,
本文中所讨论的着陆器推力系统沿用文献[6-11]
的发动机模型,其推力可在一定范围内调整,开机后
不存在关机状态:
为了后续推导方便,将式(2)表示的动力学方
程写成分量形式,令“=[xjhl",v=
[x v w]',0= arctan(e,/e,) , 办 = arcsin(e, ) ,
则有;
对于火星着陆任务,燃耗一直是一个非常重要
的参考指标,性能指标和约束条件可以写为:
t为着陆器动力下降段制导起始点至制导结柱点的
末端飞行时间。
为了使得着陆器在动力下降段末端悬停于着陆
点正上方桅一高度处,结合对动力下降段着陆点坐
标系的定义,系统的末端约束方程可以表示为;
2“最优控制问题推力形式分析
对式(2)~(6)描述的最优控制模型,取哈密顿
函数:
zf(′.，l′，′.′′′′芗^′′′，入'′′′，入'′′_零7，,，霞〉二
HbAALA分别是对应于状态量r,,m的协
态变量。根据极大值原理,有:
H(r,v,m;A, A, AT" ,6“ = |
max H(r,v,m;A,,A,,A,;T,e) (8)
了e
由于推力大小“是一个非负量,根据式(7)和
式(8)可知最优推力矢量方向e「“与A,方向相同,
即:
将式(9)代人到式(7)中可以得到;
H(r,v,m;A,,A,,,;T,e") =
nL]使得开关函数H:=0,则存在7“=T,,,I.
<Toa<Top,使得哈密顿函数值最大,从而此最优
控制问题成为一个奇异值控制问题,不易求解。下
面将利用反证法说明此问题当中不存在一个区间
(t,t,使得H三0。
假设存在区间[t,1,使得在此区间内有
H,=0,则在此区间内有:
根据极大值原理,协态方程的微分方程表示为:
吴0光二二儿,A二二A(3
由式(13)可知,A,为常向量,而A,的表达式
为;
令A=ial,可以得到A,的表达式:
对式(12)求导可以得到:
又{，，_=皇′竟+-′暑(16)
由式(12)~(16)可以得到:
在 区 间 [t「 , 心 ] WH H = Hym = A, - dam =
0,对此式连续求导并结合式(12)~(17)可以得
到:
所以得到在区闽[t,t]AA,世0,A,三0,进一步
得到在整个区间内A.=0,并且A,(t)=0,进而得
到在整个区间内有A=0,而这样的解明显不能满
足式(2)~(6)所描述的最优控制模型。
通过以上分析可以得出结论:对于式(2)~(6)
所描述的最优控制问题,不存在任何一个连续区间
[t,如],使得开关函数Hy在此区间内满足F,万0。
3“基于分段解析函数的参数求解方法
3.1“横截条件
本文描述的燃料最省最优控制问题为一个末端
状态具有目标约束,且末端时间自由的最优控制问
题,根据其横截条件的求取方法可以得到另外两个
约束方程:
A,和质量m的末端值。
由此可知,最优控制模型的待求解参数(A.,
A,,An以及i)和约林方程(式(6)、式(19)、式
(20))均是8个,可以通过牛颓迭代等算法对参数
进行求解。然而,在迭代计算中,每一次对参数进行
修正,都需要对系统状态和协状态的微分方程进行
数值积分求取末端状态与约束方程给定的期望末端
状态进行对比,计算量大,难以满足着陆器轨迹规划
算法的实时性要求,为了提高追代算法的运算效率
和实用性,推导给定参数情况下状态方程和协态方
程的解析表达式很有必要。
3.2“状态变量和协态变量的分段解析表达式
通过第2节对控制形式的分析,推力TAREE
中间状态,只是在合适的时刻在最大值和最小值之
间进行切换,因此可以将系统状态方程和协态方程
当成是如图1所示的这续分段函数,在每个分段内,
着陆器推力为常值,则可以推导每个分段内状态变
量和协状态变量微分方程的解析解,如此,原来需要
积分整个时间区域对末端状态量和协状态量求解的
过程可以简化为利用分段解析函数求未端状态量和
许状态量的过程,下面推导对每个分段内微分方程
的解析解。
Xi ‘oy
在后面的推导中用A、,^A,MA,表示其分量。由A,
的解析表达式(14)可以看出,给定其末端值比给其
初始值更便于计算,为了谴免后绿推导中混滢,重新
将式(14)写为:
为了表达更加简练,在推导过程中每个分段内
的状态量和谐状态量初值均表示为(+),的形式,推
力记为7““,根据式(5)可以得到质量m的解析表达
式;
式中:m“,A,是时间;的函数,分别表示m(t)和
A(t),Ap表示A,在初始时刻的值。
由第2节的分析可以得到,当问题取得最优解
时,推力矢量方向e与协状态向量A,方向相同,速
度分量的微分方程可以写为:
利用速度矢量三个分量表达式之间的对称性,
由于速度三个分量的表达式第一项具有对称性,
方向仅比x,两个方向多了一个项常数,在积分时
可以单独计算并东计算简单,因此,本文中以u方向
的分量为例给出解析表达式的推导过程,另外两个
量则只给出结果。
2at +b 十 2AAa】 + uy +
外两个分量的解析表达式可以表示为;
(28)
(29)
对速度量进一步积分,从而得到位置量的解析
表 达 式。将式(27)~(29)中的常数项用符号代替:
式(33)~式(35)给出了位置分量的解析表达
式,其中式(33)给出了推导过程中的主要步骤,式
(34)和式(35)则是根据式(33)的结果和式子的对
称性直接给出结果,在式(33)的推导过程中,做了
相应的变量代换z==,结果如下:
3.3算法流程
(1〉》根据着陆器相对导航系统给出的着陆器位
置、速度矢量,在预先设定的着陆器动力下降段起始
点包络网格中以查表的方式寻找距离最近的点,用
此点对应的协态变量存储值给定A,AyAg,mg
及r的初值;
(2)根据A.,Ay,A,o。,mo及t的初值及着陆
器初始质量m,,计算开关函数的正货,继而确定初
始时刻推力“的值7“,然后将式(21),式(22),及
式(24)代人到开关函数当中以二分法寻找开关函
数的零点时刻b,记录此时刻的状态值A,(tLFF
根据式(27)~式(29),式(33)~(35)及式(22)计
算5时刻的状态值x(a)和华状态值AG))、
Ae)Boa,(ey),根据i+d(de为小量)时刻的
开关函数值给定推力值7“,并以t时刻的值为起
点,以同样的方式寻找开关函数的零点时刻b及其
STREET A, (2) + A, (8) ?AL (8,) FREE x( 书 ) ,
根据b+de(de为小量)时刻的开关函数值给定推
力值7“,以此类推,直至终端时刻;r,计算终端时
刻的状态值xz(tj)和协状态值A.(;)、A,(tr)及
An(t),写出约柬方程;
(3)利用第(2)步给出的状态变量和协态变量
未端值,结合式(7)和式(20)给出的最优控制问题
非线性约束,利用SQP算法对待求解参数进行选代
求角牵<〕
4“仿真分析
本文以火星着陆为背景,在相同仿真条件下分
别采用本文方法、Apollo多项式制导方法,以及凸规
划方法对着陆器动力下降段轨迹进行规划,并对结
果进行对比分析,仿真环境为IntelCore(TM2)
T6400 , WindowsXP 操 作 系 统 , Matlab7. 8 软 件 。
着陆器初始位置为[1900,1200,3100]m,初始
速度为[35,20,-40]m/s,期望末位置为
[0,0,01m,期望末速度为[L0,0,0j}m/s。选取文献
[9]中所描述的着陆器结构,如2所示,所有推力器
最大推力之和为7uu=16423N,推力器推力方向与
着陆器体轴夹角为p=0.4712rad,推力器净质量
my = 1505 kg , 燃 料 初 始 质 量 mx(0) = 400 kg , 推
力器比冲为L,=225s,地球表面引力加速度取gu
=9.807kg/s,火星表面引力加速度为gu=
3.711kg/s「,推力器许用推力在总推力的30%到
80%之间,即个=+T,,,0.3<7<0.8,对应于第
1节的系统动力学方程,有“=T.cosp,a=
乙pg…c0S碉“
在仿真中,本文算法在流程第二步计算开关函
数转换时刻时求解精度设为0.1s,第三步求解时使
用Matlab自带的fmincon函数;基于凸规划的轨迹
规划算法离散点数选择为120,求解时使用SeDuMi
工具包进行计算;而Apollo制导方法只需要根据初
始状态和期望末状态计算出多项式的系数,在相同
的条件下对同一问题进行50次求解。本文算法耗
时均值为7.684s,凸优化算法耗时68.472s,Apollo
算法耗时均值为0.000062s。可以看出,盛然本文
方法没有Apollo方法计算效率高,却比凸规划方法
计算效率有了大幅度的提高。图3~图8给出了求
得的着陆转迹各状态分量的时间历程,可以看出本
力器能够提供的最大推力,得到的解并不是可行解,
文方法和凸规划方法所得的结果相差很小,而且均方法的使用受到了限制。
能够满足系统的终点约束和控制力约李,本文方法
的未端质量为1596.447kg,凸规划方法末端质量5
1595.284kg,两者相差1.163kg,这是因为用凸规
划方法求解时,利用多项式拟合控制量的精度不够,的推力形式进行了分析.并利用分析绪果将着陆翩
,如图8所示。从图5和图6可以看出,与Apollo
导方法相比,本文方法得到的推力方向角变化缓
,更适合着陆器的姿态控制系统进行跟踪。另外,
图 8 可以看出,在8s以前及33.5s至44.5s之
,Apollo方法得到的解推力比例超过了着陆器推
结“论
本文对火星精确着陆动力下降段轨迹规划问题
状态方程和协态方程转化为有限个推力为常值的分
段函数,推导了分段函数的解析表达式,进而得到了
一种快速动力下降段轨迹优化方法,仿真结果表明,
该方法与Apollo制导方法相比,避免了Apollo制导
方法不能对推力约束的缺陷,与凸规划方法相比求
解精度相近,并具有更高的计算效率。
