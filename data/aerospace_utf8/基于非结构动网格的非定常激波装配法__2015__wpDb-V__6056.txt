基于非结构动网格的非定常激波装配法
从 ALE 方程出发，通过修正体积的新思路构建离散几何守恒律，基于非结构动网格的信息传递方法得到网格重构以后新网格的流场参数，采用一阶格式捕捉法得到的流场确定装配法的初始激波位置，成功地把激波装配法应用到非定常流动的模拟。模拟超声速飞行环境下整流罩分离的非定常流固耦合过程，在马赫数6条件下装配法和捕捉法的计算结果完全一致，随着马赫数增加，二阶精度格式的捕捉法需要进行调整限制器参数、时间步长等人工干预，但是装配法直到马赫数20计算过程没有出现异常。该基于非结构动网格技术的激波装配方法，与传统的激波装配方法相比，能够用于复杂外形产生的非规则形状激波和非定常流动产生的运动激波，解决二阶精度有限体积法用于高马赫数飞行条件下多体分离过程的流动模拟时遇到的稳定性问题。

激波装配 非结构动网格 非定常流动 高超声速  

051“言
激波是可压缩流体动力学中最重要的物理现象,
模拟激波自然也构成计算流体力学(CFD)主要的研
究内容。激波的模拟方法分为捕捉和装配两种。
“1953年,Lax提出自动捕捉双曲型守恒率方程间断
解的一阶格式,在应用中发现数值解存在非物理波
动;1959年,Godunovyv基于骏解理论,利用间断满足
的Riemann分解的特性,构造出物理背景清晰计算
稳定的一阶格式““。由于这两种格式都只有一阶精
度,计算得到的激波需要若干网格点过渡(所谓激波
较宽)。直到1983年Harten提出TVD格式才实现
二阶精度,使得激波分辨率得以提高。其后发履了许
多高精度格式,如NND.ENO.WENO等“,近几年
三阶乃至更高阶的WCNS也得到实际应用““1。
1966年,Moretti根据激波上下游流动参数满足R-H
关系式的特点提出激波装配法“1,高精度高效率地模
拟出钝体头部脱体激波,二维情况下装配法使用10
X16个网格得到的压力分布的精度不逊于当代捕提
法使用385X513个网格的精度““,极大地推动了当
时超声速流动的应用研究,直到上世纪80年代后期
依然是主流算法[“1。然而,这种算法需要事先确定激
波位置,应用受到极大限制,随着高精度捕捉法的发
展,装配法的研究热情逐渐消退。
激波空间尺度只有几个分子的平均自由程“。
在海平面标准状况下,马赫数M一2.95的正激波厚
度大约为6.6X10*m,而常见的飞行器在10m量级,
目前航天航空领域CFD应用中10*m量级网格很少
见,因此采用捕捉方法模拟出来的激波宽度要比实际
的激波厚度大得多。激波内部处于热力学非平衡状
态,而建立Euler或NS方程时采取了热力学局部平
衡假设、密度不存在剧烈变化的Stokes假设以及采
用了忽略松弛时间的状态方程等,从理论角度看,从
Euler或NS方程出发捕捉激波,即使未来几十年后
计算机发履使得激波厚度内布置若干网格成为常态,
只要过度区有1个网格点,也会产生非物理波动。描
述激波最完善的数学理论是双曲型守恒率方程的弱
解理论。它把激波看作无厚度的间断,流动参数在此
发生突跋。
'由于捕捉法计算激波存在诸多理论缺陷,文献
[6J中认为捕捉法经过36年(1966-2001)的发展依然
无法超越装配法。近几年国外一些学者重新审视装
配法,解决了高精度格式应用于高马赫数流动时在激
波附近出现波动的问题“““2。Paciorri等人采用在捕
捉法得到的流场基础上装配浮动激波的新思路突破
优珉袱阡哉的限制,研大推刘J丙用规研扦BE
浮动激波装配法通过局部网格重构来形成内部激波
边界,由于激波运动以后需要在背景网格上重新定位′
和插值,流场信息传递使其难以用于非定常流
乏-旦)彗〔1l-1二肇〕。
本文利用文献[14]建立在ALE(ArbitraryLa-
grangian-Eulerian)方程基础上的非结构动网格技术
发展能够用于非定常流动的装配法。
1_ALE形式控制方程及其计算方法
采用ALE描述的三维可压缩非定常N-S方程
的积分形式,
圣Il〕′Q(]\/'一卜蛭〔王罩c〈C2，.】C″)十F,(Q)],mdS一0
(DH
其中,Q为控制体,30为控制边界,n为控制体边界
外法向向量,dV为体积微元,dS为面积微元,x-为网
格运动速度。
计算方法采用文献[14]中介绍的基于混合网格
的有限体积方法,对于守恒变量存贮在单元中心的格
心格式,空间离散第i个控制体;
其中,FoonSe分别为第*个面元的通量、外法向单
位矢量和面积,N/为控制体表面个数。假设物理量
在单元内线性分布得到空间二阶精度的有限体积法
格式,第;个控制体的第&个表面中心点的变量值,
Qu 二 Qi + ga VQ; 。 (3)
其中,vQ是单元内物理量梯度,采用Green公式计
算梯度,rx是单元中心到表面中心的矢径,4ax是为
了抑制激波附近可能出现的非物理振荡而引人的限
制器,本文采用Venkatakrishman限制器。两侧单
元在表面&处的重建值形成物理量的间断,将其视为
近似的一维Riemann问题,可以利用Riemann问题
的各种求解方法计算单元&处的无粘通量。在本文
软件中包含有VanLeer、Roe、AUSM、HLLC等多种
分裂格式。时间离散采用二阶时间精度的四步
Runge-Kutta方法。计算中稳定性要求时间步长满
JCFL条件:
式中,为流体速度,ai是当地声速,V:是单元i的体
积。对四步Runge-Kutta格式,CFL<<2/2。全场
时间步长是所有当地时间步长的最小值,即At二
min(At;) 。
计算时还需要考虑离散几何守佩後CDiscrete
Geomettic Conservation Law—DGCL)s REN RM
格变形算法霁要结合网格重构实现大变形或大位移,
这又涉及刺新旧网格之间的信息传遮。
1.1离散凡何守恒律
对于均匀流圭,NS方程的质量方程:
在离敬空间,从x推进到n十1时刻,微元体积仑V变
HAV,对于晕式算法,第1个面SyLIERx.运动
形成的体积增量记为AV!=x;+nS,对于全隐算
法,第{个以速度x。运动形成的体积增量记为AVY+
=x, + nS" BRA:
其中,N。表示单元所含面元个数。这种儿何计算误
差必然影响流场计算,因此需要构建DGCL来消除。
根据所修正的参数把国内外文献构造的BGCL
分为三类算法:第一类修正网格面积,梁用平均面积:
StH一不(Sf+S)代等STRST,这种算法最早
和儿何守恒律褐念“一起提出,难以应用于涉及2
个以上时间屋的高防腭格式;第二类修正网格运动速
度,如果时间二阶格式离散左端项,
采用如下速度ws来代曾实际的网格运动途度x。计
隽二_:【“〕:
PT EY a
这种算法进行营固耦合模撒时,流体界面不能接照络
定速度运动,无法满足速度相等条件;第三类同时倬
改网格面积和网格速贼70,部分政进了以上不层。
在文献[19J]中通过数学模型证明离散儿何守恒
律是流域参数假设为常数条件下ALE坐标形式流
体力学方程的退化形式,不是独立的新约柬条件,不
满足元何守恒律引起非物理解的机理是在网格取彤
过程中体积增量与面积运动形战的体税不等靥东生
误鉴,在非定常流杜的计算过程中,随着时间推进步
数增加,误差不断景积,因此必须构建儿何守恒律算
法来深除这种误差。基于这种认诵分析以土3类
DGCL算泉;单一修正离髂方程有端项,必然导致与
求解流圭的空间离敬格式相关。本文作者捉出修正
离散方程左端项中体积的新思路“w,采用体积V“代
既保证流圆界面途度,也不烨空间离散按式限侧,完
全解决了DGCL问题,文献[20-21]中络出验证算例,
楠果很好。
L2 amie ,
门格重构以后,梁用插值传通新旧网格之间流场
信息,线彤插值导政激液分辨率降低,ENO插值引起
非物理签动,徘难构造造合激波的3阶插值、为了遮
兔新世网格之闰流圭倩息传递过程产生新误差,文猷
[22J]提出一种基于动网格的信息传递方法,下面以二
雄问题为例对其基本原瑾进行介绍。
闭题如图1Ca)所礼,已知x时封早网棠中O点
的湘在参数,需婉得到n十1时刻新闻格的九点和@
点流圭参数。如图1Cb)斯示,在旧网将的基碑上时
间方合推进At,计算得到a十1时刻葭场参数的咖
“时,梁用动何峥技术保持O点及周围所涉及的网拳
不变形信是同一速度运动,待得O点平移到PAFH
样,在旧网格基础上时间方向推进At,将O点平移到
乜点。由于乙和Q所在的空间位置正好是新网格的
点,助图Ite)所示,因武通进勐网粟裔术得刺n十1
时刻的派在参熟,在此基硬上政弃阜网格,采用新网
裂继续计算。可以证砂y对于以上时间圭闻二阶精度
的月限体杖法梧式,这柘一法个引人说差,因此栎为
高精度信息传递算法“.1。时间显式格式的稳定性限
制网格运动速度,在多维条件下少量网格需要多步时
间推进才能实现统一时间At流场,为此文献[21]提
出了一些改进措施。
1.3“非结构动网格技术
1990年Batina首次将弹簧比拟法用于三角形网
格的变形/“1。它的原理是将连接网格边视为弹簧,
整个计算区域网格构成弹簧系统,在弹簧系统内部节
点(网格点)列出力的平衡方程组,边界发生运动或变
形后使弹簧网络受到拉伸和挤压,整个弹簧系统受力
发生变化,通过求解弹簧网络的平衡方程来更新网格
节点的位置。这种方法只考虑了弹簧拉压,扭转变形
易出现网格折穿(snap-through)。1998年Farhat等
人在二维网格顶点处施加扭转弹簧增加抗扭转能力
取得实效,但在推广到三维网格遇到困难“““251。2000
年Blom等人根据三角形单元边对应的顶角来修正
线弹簧刚度系数,提出半扭转弹簧方法“51,2003年郭
正和刘君针对四面体,采用不包含该边的二面角作为
顶角,把这种方法推广到了三维情形,同时通过求解
固体导热方程得到的内部节点温度作为参数来增加
动边界附近网格层的弹簧刚度系数,提高了网格变形
能力[“7。本文采用[27]发展的弹簧比拟法,所求解
的力平衡方程组对角占优,采用Jacobia迭代能较快
收救。.
2“基于非结构动网格的激波装配法
半圆柱前形成脱体激波结构的无粘流场,计算网
格如图2所示。为了加快收敛速度和提高非定常流
场计算的初值精度,本文借鉴文献[11-13」的新思
路,在搬捉法流场基础上按照如下算法确定装配法的
初始激波位置:(1)寻找全场密度梯度最大单元,记为
E0,然后找出该单元顶点周围密度梯度最大的单元,
记为E1;(2)增加排除标记过的单元、到Ei-1格心大
FE与EKi-1格心距离约束,找出与Ei单元共点的
密度梯度最大的单元,记为E;十1,直到边界;(3)采
用Bézier方法进行拟合单元格心坐标,得到的初始
激波位置如图2中曲线所示,用作装配法生成网格的
边界。
对于装配法重新生成的新网格,除了激波边界网
格外,按照上面介绍的信息传递方法给出流动参数。
对于激波边界处新网格的流场参数,先在旧网格中定
位,然后取旧网格中对应单元的相邻单元中最大压力
作为激波后压力5:,结合激波前压力0可以计算激
波在静止环境中的运动速度:
7′zs=_′1一__甥〈羞一1〉(7》
在均匀来流速度为v的风粘系下,激波相对运
动速度:
其 中 , vy 二 AE。 oe n,u=sign(v, 。R) 。
要像文献[11-13-]那样处理浮动激波,网格按照以上
激波速度进行运动,即x.一w。为使激波边界新网
格的流在参数相容,引人相对激波马赫数M=v,十
x.on,根据R-H关系式确定波后密度和速度:
v,二Mzcz。十V9
其中vu为均匀来流在界面上切向分量。
按照以上捕捉法方法编制程序模拟马赫数大于
6的钝体无粘绕流场。如果初场取自由来流参数,先
用一阶迎风格式得到收敛流场,然后用二阶精度格式
进一步提高分辨率。对于如图2所示较稀疏的计算
网格,随着马薛数增大激波增强,采用二阶格式后需
要探索调整限制器参数、计算时间步长等才能避免发
散或振荡,到了马赫数20BF,5kAlRoe,AUSM、
HLLC等空间格式很难收敛到稳定解,基于非结构
动网格的激波装配法没有出现不收敛现象。图3为
马赫数等于20时采用二阶Vanleer分裂格式捕捉和
装配得到的马赫数等值线图的比较。物面压力和
Lyubimov的经典文献[28小文献[7J进行比较,符合
很好,由于篇幅有限,这里不再赘述。
本文采用基于非结构动网格的激波装配法成功
地计算出超高马赫数下的定常流场。下面对如图4
所示的整流罩分离动态过程进行模拟。整流罩初始
开启角度为5.,在气动力作用下整流罩绕法兰旋转
打开,达到30时整流罩分离进行六自由度自由运
动。该流场存在激波、膨胀波等诸多复杂的非定常流
量3马彗数等值押图
Fig.3 Mach iso-contours
重构生成新网格在激波后区域尺度接近和数目相当,
采用前面介绍的新旧网格之间信息传递方法给出新
网格上参数。文献[14]提供了采用捕捉法模拟超声
速多体分离干抢流场的大量验证算例,本文以捕捉法
的结果作为考核标准,模拟飞行马赫数6条件下整流
(a) 1ms (b) 2ms
囱5IMa=6整流罩分离过程中一回时刻马赫云图
黟i囊.s Mach contowrs change hange versus time in the process DCess of fairing separation at Ma= 一
覃顽怀分尽双租。河比要狒单分喜反粕巾振狱怦楠
装酒法得到的不同时刻的马蒙云图,如图5所示,议
及质心和姿态角随时间变化曲线,如图67所承。可
以看出,札用装配法得到的流李结构\气勐力驱动运
动特性与捕捉法符合较好。对比表明本文采用的基
于非结构动网格的激波装配法可以很好地糠挺非定
常激波。_
比较了搬捉法一阮迎风和二阶格式的怀改解得
到的初始激液位置,几乎没有区别,这一现象定性合
理,因为不同精度格式对于已经分献出来的激波主要
差异在于宽度(网格点数3,最大橘度的俘罡差异较
小。如果格式在激波区光滑过渡:尽管宽度不同,侦
是苹于网点后必然恢复到激波后参数,基于这样的认
识,提出采用旧网格的相邻网格单元中最大压方作为
激液边界网格压力的计算方法木消除不周精度格式
对初场的影响。通过图6那图?的对比发琨y标用两
种方法得刻的计算结果基本一改。由于激波装配法
无法诵除搬捉法提供初场带来的误差,可以得出绪
论:采用激液装配方法的计算过程没有引人新的误
兵。
随着马莲数增加,二阶格式艇捕捉法难以正常运
行,需要不断在计算发戬以后进行人工干预,基于一
阶迎几格式摇捉到激波位置作为初娼边界的装配法
计算没有任何问题,图8给出马莹数20时分离过程
中不同时刻的压力云图。
(c) 3ms (d) 4ms
(a) Oms (b) 0. 5ms
图 8 “Ma一20敲流罩分离过程中不同时刻压力云图
Fig. 8 Pressure contours change versus time in the process of fairing separation at Ma=20
3结“论
本文提出了以一种新的基于非结构动网格技术
的激波装配方法,采用一阶格式捕捉法得到的流场确
定装配法所需的初始激波位置,将激波装配法成功地
应用到非定常流动产生的运动激波的模拟,复杂外形
产生的非规则形状激波的模拟,解欢了高精度格式捕
捉强激波遏到的稳定性问题。
