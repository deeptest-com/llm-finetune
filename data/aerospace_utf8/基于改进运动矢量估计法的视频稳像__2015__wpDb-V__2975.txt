基于改进运动矢量估计法的视频稳像
提出用改进的运动矢量估计方法对视频序列进行运动补偿,以有效去除机载成像设备摄取视频序列的帧间抖动,实现电子稳像。介绍了BRISK算子提取特征的模型和算子描述方式,利用BRISK算子提取相邻帧的稳定特征点并进行匹配,结合参数仿射变换模型实现帧间运动矢量粗估计。为了提高运动矢量估计的精度,引入粒子滤波解决因特征点景深不同引起的运动矢量估计失准的问题,继而采用加权最小二乘法改进运动矢量估计。最后采用卡尔曼滤波从全局运动矢量里分离出运动补偿分量,对视频序列进行逐帧补偿。实验表明,视频序列稳像后的帧间变换保真度值提高了近3db,显示提出的的稳像算法可以处理复杂运动下视频的帧间抖动,且快速准确并具有一定的鲁棒性。

电子稳像 视频稳像 特征匹配 粒子滤波 运动补偿 评价指标  

1“引“言
机载摄像系统主要安装在无人机或直升机
上,无人机飞行高度在几千米左右,理想情况下,
其图像清晰度能达千万像素。但工作状态下,受
风力等外界因紫的影响,无人机会出现不规则运
动,从而导致所摄取的视频序列具有较大的晃动。
因此需要利用电子稳像技术对其进行稳像处理,
去除随机抖动的干扰。
国内外诸多学者对电子稳像技术展开了广泛
的研究L,其中采用基于特征匹配结合运动滤波
方法处理随机抖动视频取得了很好的效果。文献
[71%AHarris算子提取特征点,并结合自适应
Kalman滤波进行运动滤波。但由于这种方法所
采用的算子不具有尺度不变性,故不能处理带有
尺度变换的图像,同算子利用梯度信息提取特征
点所耗费的时间较长。文献L8]采用尺度不变特
征 变 抄熹 ( Scale Invariant Feature Transform,
SIFT)算子提取和描述特征点,并利用Kalman滤
波结合中值滤波处理航拍视频的稳像,但由于
SIFT描述子的维度太高,虽然其稳像效果良好,
但无法实时处理。文献[9-10-]采用加速鲁棒特征
(Speed-UP Robust Feature, SURF) 管 子 提 取 特
征点,再分别结司低通源波和粒子源波做稳像处
理,但SURF算子的描述子在计算特征点主方向
的时候要多次重复计算Harr小波的响应值,稳
像速度仍难以提高,文献[11]政进了SURF算
法,但效果并不明显。文献[12J利用KLT算子
提取特征点,并将特征点分为前景特征点和背景
特征点进行处理,该算法只利用背景特征点做运
动估计,但很多情况下区分困难,且只适用于前景
物体运动缓慢或者不动的情况。
特征点提取和描述子的匹配时间过长会严重
影响运动估计的速度,本文札用即能抗旋转又能
抗尺度变换二进制局部特征算子BRISK(Binary
Robust Invariant Scalable Keypoint)t314 以 提 高
运动估计速度。考虑特征点的景深不同会影响运
动估计的准确性,本文采用粒子滩波获得粒子权
重,以解决因景深不同而使运动矢量失准问题,文
中采用Kalman源波去除高频的抖动运动分量,
对视频序列进行补偿获得稳定视频序列。实验证
明,提出的算法有效且具有一定的鲁棒性。
2“特征点提取与描述
2.1BRISK特征点提取
2011年Stetan在ICCV会议上提出采用
BRISK算子进行特征提取和匹配。此算子的计
算复杂度何,是一种低存储、高功效的二进制算
子,与具有尺度不变性。在BRISK特征检测中,
尺度空间包含n个外层和n个内层,分别用c和
d;表示,其中i一0,1,...,n一1。n取多少与图像
尺度变化有关,一般尺度足够大才会保证计算的
精度。co层采用FAST5-8检测特征点,其余层
则主要采用FAST9-16进行检测““““5“51。为了
提高特征点的准确度,对检测出的特征点的同层
及其上、下层进行非极大值抑制,并对极大值做连
续的尺度优化。内层4:位于c:与ci;-1层之间,第
1内层aq,由初始图像使用因子1.5进行下采样
获得,其余内层通过对4,连续采样获得““0。
2.2BRISK描述符
BRISK描述符由二进制比特串组成,其采样
模式为在关键点附近取分布在以关键点为中心的
4个同心圆圈上的60个点,如图1所示。
它们的灰度值分别表示为TCpiya;)和1Cpj,oi),
则局部梯度为;
定义集合A为所有的特征点对集,S和工分
别是它的子集,其中S表示短距离采样点对的集
合,心表示长距离采样点对的集合,公式如下;
设t为关键点的尺度,则阎值分别设置为
Omax=9.75250min=13.674。为了减少计算量,对
长跌离采样点对和短距离札样点对分别处理,用
下式来求取长距离特征点的主方向;
在BRISK描述符中,为了实现旋转不变性,
把采样模式绕关键点旋转a二arctan(gy,,g:)后,
对所有短距离集合S内的采样点对进行对比,得
到级联的512bit的二进制串。每个比特位8由
丁式计算得到:
获得二进制比特串后,在进行匹配的时候,计
算每对描述子之间的汉明距离。设任意一对描述
子串分别为Str和Str,,则可以写成:
Sz7′'1=.Z:]-;【′`2"-`刃5l2， (6)
两式中z,y分别取0或1。通常采用最近邻
域汉明距离获得匹配点对,汊明距离越小,说明它
们的匹配度越高“。
3基于特征点加权的全局运动补偿
3.1传统运动矢量估计
获得相邻两帧图像的匹配特征点对的坐标
后,采用4参数的仿射变换模型“口计算运动矢量:
缩放和旋转分量,和;,分别代表图像间的平移
分量,(X,-i,Y-1)和(X,,Y,)分别代表参考峒和
当前帧的特征点坐标。式(8)为超定方程组,特征
点越多,计算量越大,因此必须合理控制特征点提
取算子的尺度和阚值。最后利用最小二乘法便可
求得参数的运动矢量。即:
M 二 [XT 友 ] 友 TY, 9
3.2“改进的运动矢量估计方法
实际上,采用上述方法只能大致计算出运动
矢量,因为不同的特征点景深会严重影响运动矢
量的准确性“)。因此本文提出采用粒子溏波的方
式获得特征点权重,以确保特征点之间景深的相
似性,继而利用加权最小二乘获得准确的运动矢
量。粒子源波的基本思想[“.152“1是从重要性概率
密度采样,即利用带权重的粒子{Xi,wi_1}六,近似
获得系统状态的后验概率密度P(X,|Z,-1),
并估计系统状态。其中X:为目标状态,Z.为t时
刻的观测值。
本算法中,随机选用一组特征点对组成粒子。
用式(8)计算运动矢量,特征点对要多于3对。一
个特征点可能属于多个粒子,获得N个粒子后,
它的权重由逐点均方准则确定,即,
式中:wi表示第;个粒子在5时刻的权重;-为
r一1时刻的图像;o:ATE.IBI,采用式(8)
基于第个粒子计算的第;帧补偿图像。由于补
偿图像存在无定义区,因此计算的时候只取参考
帧的中心区域w/2*h/2(rv,h分别为参考恼图
像的宽度和高度)。特征点的权重由粒子的权重
获得,即;
Ho.Wi为第}个特征点在t时刻的权重;Ni为
第j个特征点所对应的粒子数;为相应粒子的
权重。获得粒子权重后,运用加权最小二乘法来
准确估计当前帧的运动矢量。
目不同,则会影响到全局运动矢量的准确度,当特
征点数超过30个时,每个特征点的景深都一致,
此时粒子将对运动估计失去作用,因此要合理选
择特征点的数目。
3.3Kalman滤波获取补偿分量
Kalman滢波[“史用来从运动矢量中提取出
有意运助矢量,整个过程是根据前一时刻的估计
值和协方差估计值预测出当前时刻刊运动矢量。
其预测方程和更新方程分别为:
预测方程,
更新方程,:
SCk|RY=s(k|k—1) +k, (k) (Cz(&) 一 HsCX | & 一 17)
P(k|B)=U~k, (RYH) P(k|k—1)
k,(&)=HP(k—1| k— DH (HP (k | k—1)H' +R),
式中:去为状态矩阵,五HUME.wk),vk)
都为均值为零、方差分别为Q和跋的高斯燮声,
Q.R的取值不同会影响补偿的效果。
4“本文算法总结
本文算法流程卯图2所示,各个步骤的具体
实现总结如下
酒吹,裤得匹配点对,带人式(8),粗估诊锋间运动
矢量;
(2)利用粒子滤波获得粒子权重,刑用式(12)
(3)将上一步获得的运动矢量矩阵作为滩波
的观测矩阵,进行Kalman滤波,获取运动补偿
参数;
(4)对当前帧进行递帧补偿,首先在参考恭中
拖到相应的像河位置,然后按照没有抖动分量的
情况对参考蛤按照式(17)做变换,获得稳像后的
第 贾帝初。式中M秉源波后的有益运动
分量。
为才验证本文算法的有效性,根用4个典型
的航拍视频“Shaky-car““Viplane”,“Island”和
“University“作为研究对象,如图3所示。本
实验的计算机札用Intel奔鹄处理器,CPU主频
2. 90GHz, 内 存 4G。
这4个视频各具特点:“Shaky-car“和
4wWiplane* 分 别 为 132 frame #1 80 frame 的 含 运
动车体的料动视频。“Tsiand“和“Uniyersity“都
包含300frame的720X480的视频序列,前者在
水平方向具有小于2pixel的自身运动并带有高
娟的随机振动,后者含有规则的小于pixel的运
动,并带有高频的旋转和平移抖动。
确的匹配点对,采用RANSAC方法去除误匹配
点对。图4上图为直接匹配的结果,下图为采用
RANSAC方法之后的结果。通过比较可以看出,
下图位于车上的特征点已经被滤掉,仅剩下背景
面上的特征点。
在获取粗运动矢量估计后,参照文献[10]采
用加权最小二乘算子计算精确运动矢量。粒子滤
波中的粒子数目要根据具体视频来选取。为了验
证粒子滤波提取运动矢量的准确性,用已知的4
参数变换矩阵““1对4个视频序列的第一帧进行
变换,分别采用BRISK结合最小二乘(LS)方法
和BRISK结合加权最小二乘(WLS)方法对每个视
频帧变换前后2幅图像求取运动矢量,比较它们的
准确性。表1给出了给定的4参数为:[0.998
—0.062 7.675;0.062 0.998 1.176;0 0 1],
由表1可知,采用加权最小二乘提取的运动
矢量更为准确。由于采用相邻帧测试,因此尺度
因子和缩放因子相差不大,而主要差别体现在水
平和垂直的平移因子上。
接着对准确估计的运动矢量做运动滤波处
理,图5(彩图见期刊电子版)给出“Shaky-car“前
100frame序列做Kalman滤波前后的4参数曲
线,其他几个视频效果相似。
为了重直观地盼到本文算法的效果,图6上
图 给 出了“Shaky-car“视频经运动补偿后的一帧
图 像 与原图像进行对比,可见两幅图像匹职艮好。
图 6 下陆给出了19frame“Shaky-car“视频库列
穗像前,后的均值对比结枉(由于序列的扬景有变
化,桢数太多睹不到效果)。由于稳像前存在随机
抖动,均值图片很模糊,穗像后均值图像的车体已
经很清晰,说明很好地去掉了挎动干抗。
frame图像的差值图像。左图为稳像前相邻帧的
差值图像,右图为稳像后相邻带的差值图像。图
中信息也验证了本文算法的有效性。
5.4和其他算法比较
利用带间变换保真度ITFK“。史来客观地
说明算法的性能,其定义如式(18)所示;
HoMSE为两恽图像的均方差xf,RHEE
图 像 。
表 2 列出了本文算法与Zhu's"1Song's"
算法对4个实验视频图像稳像后的ITF结果,由
于本文对稳像后视频的无定义区没有处理,因此
对稳像前后视频做了适当的剪切处理,这样比较
ITF的值才具有实际意义。
￡23种算法ITTF值对比
Tab,2 ITF Comparison of three algorithms (dB)
VideoSeq. Original Zhu「s  Song’s Ours
Shaky-car 23.53 24,42 25, 81 25, 95
Viplane 22.86 23.01 25.12 25.44
Island 24,37 26.20 27.46 27.49
University 23.75 24.96 26.23 26. 20
为了验证本文算法在速度上的优势,表3给
出了3种算法处瑾单帧视频序列所耗时间。
由表2、表3可知,本文算法与Song「s算法对
各视频的ITF值很接近,这是因为都梁用了加权
粒子滤波方法,但本文算法耗时明显少于Zhu「s
和Song「s算法,它们采用的是HarrisflSURF
算子,这也体现了二进制算孙BRISK的时间优
势。由于Zhu「s算法没有考虑特征点景深的影
响,其穗像后视频的ITF值明显小于Song「s和本
文算法,但所用时间和本文算法相差不多。对不
同视频,本文算法的TTF值较其它两种算法平均
提离了近3dB,
￡33种算法时间对比
Tab, 3 Time comparison of three algorithms 《s》
Video Seq. Zhu's Song's Ours
Shaky-car(320X240) 0,38 0.43 0,32
Viplane(360X 168) 0.42 0.50 0.46
Island (720X480) 0.84 0.90 0. 82
University (720X480) 0.79 0.88 0.81
6“结“论
本文采用加权最小二乘法进行运动矢量提
取,以含有抖动矢量的航拍视频序列为研究对象,
进行了电子稳像实验。文中采用基于二进制的
BRISK算子提取特征点并通过汉明距离进行匹
配。利用匹配特征点,结合4参数仿射变换模型
大致求取帧间运动矢量。为了提高运动估计矢量
精度,利用加权最小二乘的粒子源波方法对运动
矢量进行增强,从而改进了运动矢量估计过程。
实验证明,这样处理会获得更准确的运动估计,从
而保证稳像的准确性。接着采用Kalman滤波获
得抖动分量进行补偿处理,较好地保留了视频序
列的自身运动。实验结果表明所采用的算法在时
间上具有优势,并提高了峰值信噪比,主观上获得
了去除抖动的稳定视频,减少了人眼不适的感觉。
本文的下一步工作是对无定义区进行重构,以保
证稳像视频的分勘率不变。
