基于最小损失函数的三视场天文定位定向
建立了三视场天文定位定向系统,以实现高精度的天文定位定向。阐述了天文定位定向的概念,介绍了三视场天文定位定向系统的工作原理。提出一种基于最小损失函数的天文定位定向算法,该算方法能够同时解算地理位置和载体的方位角信息。根据三视场系统与传统单视场系统的结构特点,从理论上分析了三视场系统的天文定位定向性能及优势。最后,就载体平台倾角测量误差和星敏感器单星测量误差对定位定向的影响进行了仿真分析并基于原理样机进行了外场实验。实验结果表明：该系统的定位精度为151.624 0m,定向精度为4.630 4″,且定位定向结果稳定。得到的结果基本满足高精度天文定位定向的要求。

天文导航 三视场 定位定向 损失函数  

1“引“言
天文导航作为最古老、最基本的定位定向方
式,以其精度高,隐蒲性好,可靠性高、自主性强等
优势,一直在舰船导航中占有重要地位01。随着
航海技术的发展,对天文导航系统的可靠性和定
位定向精度的要求也越来越高。
传统的基于单视场星敏感器的天文导航设备
性能受到以下儿方面的限制
(1)云层遮挡或强光照射所导致的设备失效;
〈2)星点在天球上分布不均匀,导致视场在某
些指向捕获的星点较少,不能完成星图识别;
(3)为了保证视场内能够捕获足够数量的恒
星,通常采用较大视场的系统设计,导致单星测量
精度较低“;
(4)在全天时应用中,由于白天强烈的天空背
景散射干扰,光学系统的星等探测能力较低,单个
视场内星点数量不足以完成星图识别“。
近年来,为了改善天文导航系统的可靠性,提
高导航精度,基于多视场光电探测系统的天文导
航成为一个新的发展方向。国外已经研发出相关
的产品,如法国SODERNMN公司的HYDRA星敏
感器“,可用于航天器的姿态测量;美国Trex公
司的多视场恒星跟踪器[,可全天时为航海提供
定位定向信息。国内在多视场天文导航方面起步
较晚,目前北京航空航天大学“,清华大学“以
及中科院长春光机所“等单位正在对多视场
天文导航系统的工作模式展开研究。
天文导航系统对于天文定位[z“的解算通
常是基于球面三角形或高度差法完成的,定
向“计算则通常在已知定位信息的基础上完
成。定位定向过程分开进行会导致定位误差的扩
散,无法完全满足三视场天文导航系统进行高精
度定位定向的需求。本文以三视场天文定位定向
系统为研究对象,介绍了定位定向的概念以及三
视场天文定位定向系统的工作原理,提出了一种
适用于三视场天文导航系统,能够同时进行定位
定向解算的基于最小损失函数的天文定位定向算
法。然后,分析了三视在天文定位定向系统的性
能,说明了该系统定位定向能力的优势。最后,通
过计算机仿真及三视场天文定位定向原理样机外
场实验,对使用本文算法的三视场天文定位定向
系统的性能进行了分析和验证。
2“三视场天文定位定向原理
2.1“定位定向的概念
定位就是求解载体的地理位置,即求解载体
的经纬度(+,p)信息,定向就是求解载体方位角
(4ha)。定位的概念是唯一的,容易理解,而定向
的概念则比较多样。
图 1 “天文定位定向系统的相关坐标系
Fig. 1 Coordinate systems of celestial positioning and
orientation system
载体方位角(4A4a4)是载体坐标系(〇XeYeZp)
中的某个参考矢量在水平面的投影与正北方向顺
时针的夹角。如图1所示,正北方向即东北天地
平坐标系(ENU)中N轴的方向。本文将载体坐
标系的Xs轴作为参考矢量,则AyXs在水平
面的投影与N轻的顺时针夹角。
2.2“天文定位定向的必要条件一一水平借息
根据定位定向的概念可知,完成定位定向的
一个必要条件是已知载体平台的水平信息,该信
息可以使用地平仪或其他双轴倾角测量设备获
系(As),与东北天地平坐标系和载体坐标系建立
联系,辅助定位定向的求解。Xnasx轴为Xa在东北
天地平坐标系(ENU)的水平面EON中的投影,
Znx轴与ENU坐标系中指向天顶的U轻重合,
Yasx轴在EON平面内由右手定则确定,则Xa.ph
与N轴的顺时针夹角即为待求的载体方位角。
2.3“三视场天文定位定向的工作原理
三视岂天文导航设备由3个小视场星敲感器
构成(见图23,3个光学视场的光轴在载体坐标系
中的水平投影均匀分布,即水平投影夹角为
120“;并且3个光学视场的光轴在载体坐标系中
具有相同的高度角。
三视场天文定位定向系统的工作厚理如图3
所示。天体目标由3个光学视场捕获,并成像在
探测器上,获取探测器中的图像,通过星图预处理
及质心计算获取各视场中天体的质心位置。根据
天体的质心位置、各视场光学系统的焦距、CCD
的像素尺寸、分辨率、主点、畸变参数、光轴在载体
中的矢量位置,UKCCD的安装旋转角等,计算出
各视场中天体目标在载体坐标系中的位置矢量,从
而在载体坐标系中算出各个星点目标之间的星角
图 3 三视场天文定位定向的原理框图
Fig. 3 Functional block diagram of positioning and
orientation equipment with three FOVs
3基于最小损失函数的天文定位定
向方法
在天文定位定向计算之前,已经获取导航星
与观测星的匹配组。利用时间信息可以精确地计
算出导航星在国际地球参考系(ITRS)中的矢量
Vugs。根据光学系统参数及各视场的安装参数,
可以得到观测星在载体坐标系中的矢量Va。这
里以Ves和Ve构成的星矢量匹配组作为已知
,对天文定位定向算法进行研究。
3.1“天文定位定向相关坐标系的转换关系
3.1.1“国际地球参考系与东北天地平坐标系的
转换关系
国际地球参考系(ITRS)中的矢量在东北天
地平坐标系(ENU)中可表示为:′
Vevwu 一 C 瞒 (4,90“ 一 g,90“)Vmgs, (1)
其中:(2,p)分别表示舰船所在的地理经纬度。
CL (2,90°— 0,90") WH R= +
乙轴逆时针旋转8角即可得到东北天地平坐标
系,且6角与待求的方位角Aa之间的关系满足,
Aj 二 90「 一 6, (3)
则东北天地平坐标系中的矢量在水平辅助坐标系
中可以表示为;
Vie =Cu (8) * Venu? (4)
3.1.3“水平辅助坐标系与载体坐标系的转换
关系
水平辅助坐标系中的矢量在载体坐标系中表
示为:
其中:C&u(a,6)为从水平辅助坐标系转换到载体
坐标系的姿态矩阵,该矩阵仅与倾角测量设备测
得的载体平台倾角(a,6)相关。
图 4 水平辅助坐标系与载体坐标系之间的几何关系
Fig. 4 Geometric relationship between assistant coordinate
system and body coordinate system
求解C&s(a,6)时,首先选取两个不平行的单
位矢量,分别获取它们在载体坐标系和水平辅助
坐标系中的位置。选取载体坐标系XsHAY,
轴的单位矢量V5二O4、砥一OB,这两个矢量在载
体坐标系中表示为硐=(10,07,V§=
(0,1,007,。如图4所示,根据载体坐标系和水平
辅助坐标系的几何关系以及测量得到的载体平台
倾角(a,8)TRIKEVE,VE在水平辅助坐标系中
表 示 为Via,V&st。
系转换到载体坐标系的姿态矩阵CRu(a,8)。
3.2基于最小损失函数的天文定位定向算法
本算法包括两个过程:首先,利用已知观测星
在载体坐标系中的矢量Vs以及倾角测量设备获
取的载体平台倾角信息(a,6),根据式(5)可计算
观测星在水平辅助坐标系中的矢量Van.RT,
利用Vras和Vax之间的关系迹行定位定向的
求解。
根据式(13RKB)、式(4)可获得Vmas和Fau
之间的关系:
V 一 Cu(90“ 一 A4ad) + CBIS(1,90° =, 90°) Virgs ,
式中,方位角4:、地理经纬度(2,p)为待求的未知
量,而Viers,Vasx为已知量,求解4s,2,g即可完成
定位定向。
令 矩 阵 4 二 ClNu (90 一 As ? CARs (190 一
9,907,则矩阵A可以看作带有3个未知量的姻
态转换短阵。假设天文导航系统识别出N颖星,
则可建立一系列转换关系式;
Vi=AVirgs, 1<i<KN. (7
通常情况下,有多个不平行的星点矢量匹配
组可以利用。当N乙3时,由于星点矢量存在误
差,一般无法求解能够同时满足式(7)中所有等式
的矩阵A,矩阵A的求解成为-一个“超定“何题。
为了充分利用全部的观测数据,只能利用统计方
法,寻找最优的结果,建立式(8),该式通常称为损
失函数:
求解满足损失函数最小的矩阵4,就是在星敏
感器定姿应用中经常需要解决的Wabha问题。该
问题的求解方法目前已经比较成熟,具体有支持向
量分解(SVD)法“、q-方法“0、QUEST半法等“。
获得满足损失函数最小的矩阵&,即可解算出满足
损失函数最小意义上的定位定向信息。
4“三视场系统的定位定向性能分析
三视场天文定位定向系统与传统的单视场天
文定位定向系统最根本的不同在于光学系统结构
内观测星点数量无法完成星图识别时,可以联合
3个视场中的观测星点完成星图识别,即通过3
个子星图数据融合的方法提高了测量数据的有效
率,故三视在系统较单视场系统更加高效。此外,
三视场系统结构的特点对定位定向性能也会产生
一定影响。
4.1“视场尺寸对定位定向性能的影响
天文定位定向是通过对星点目标的观测、提
取和计算实现的,所以星点目标的测量精度是天
文定位定向的基础。单星测量精度描述了星点在
光学坐标系中矢量位置的提取精度,该精度将最
终影响天文定位定向的精度。
星敏感器单星测量精度的计算公式为,
式中:S$uesu为单星测量精度,Arov为视场,Noa为
探测器像元的个数,coa为CCD坐标系中星点
质心的提取精度。当探测器的像元个数Nowa—
定,万使用相同的星点质心提取算法,即CCD上
星点质心提取精度c.uuoa一定时,视场尺寸Arov
越小,单星测量精度越高。
在光学系统极限探测能力相同的条件下,为
了能观测到一定数量的恒星,完成星图识别,单视
场系统的视场需大于三视场系统。故在观测星数
量一定的情况下,三视场系统的单星测量精度更
高,并且由于三视场系统中视场间星点的星对角
距较单视场更大,故三视场系统的定位定向结果
更准确。
4.2星点高度角对定向性能的影响
RES.1.2节的分析,天文定向的计算是在
水平辅助坐标系(AsO和东北天地平坐标系
(ENU)之间进行的。在此假设载体平台的地理
NEL)为已知量,则根据已知的导航星矢量
Vrrgs和地理位置信息,使用式(13可以得到导航
星矢量在ENU坐标系中的表示Vsvu。令VadHl
Vas分别为观测星矢量的真值和测量值,其中真
值为不存在任何误差的情况下,观测星点矢量的
图 5 星点高度角对定向性能影响的示意图
Fig. 5 Sketch map of star altitude affect on orientation
performance
根据几何关系可以得到由该星点匹配组的测
量误差导致的定向误差为:
式中,s为星点矢量的观测误差,4E(《0「,90)为星
点的高度角,0为定向误差。在星点的观测误差e
一定时,航向角的计算误差随h的增大而增大,如
图 6 所示。由于三视场系统视轴的高度角通常不
会很大,星点的高度角较小,所以三视场系统理论
上可以获取更高的定向精度。
上具有更好的天文定位定向性能。
基于最小损失丽数的天文定位定向方法主要
120“,高度角为45“,CCD尺寸为024pixelX
包括两个过程,在这两个过程中误差来源为载体
1024pixel,主点位置在CCD的靶面中心,且光
平台倾角测量误差和星敏感器单星测量误差。其
学系统无智变,极限探测能力为7等星。
中,星敏感器单星测量误差是以星敏感器单星测
采用可见光波段的Tycho2星表作为基本星
表 , 时间信息统一取UTC时间为2013-10-10:0:0,
统和探测器的特性星点成像的点扩散方程、星点
147「,载体平台的倾角为(一3,5“)。此仿真过程
质心提取算法等因素的综合影响。
表 1 载体平台倾角测量误差对定位定向结果的影响
Tab. 1 Effect of body tilt angle measurement error on positioning and orientation
倾角测量误差/(“经度计算误差/(“)纬度计算误差/(“)“方位角计算误差/(“)定位误差/m
3 —3.862 8 3.152 2 2.477 9 126.986 8
5 一 6. 438 2 5.2537 4,129 9 211.648 1
10 一 12. 875 8 10. 507 5 8. 259 5 423.288 9
15 —19,313 3 15.761 3 12.389 0 634.930 5
20 一 25. 750 4 21.015 3 16.518 6 846. 570 1
从表1中的数据可知,倾角测量误差的大小
与定位定向结果成线性关系。在单帧测量过程
中,载体平台倾角的测量误差可视为系统误差,不
能通过计算冼小。所以,天文定位定向系统需耍
高精度的倾角测量设备以获取准确的平台倾角,
从而完成高精度的天文定位定向。
5.1.2“星数感器单星测量误差对定位定向的
影响
仿真测试使用的三视场系统的系统参数、基
本星表及时间信息与5.1.1节相同,并且令载体
平台水平放置于地面,即载体坐标系与水平辅助
坐标系重司。仿真采用藩特卡洛法,仿真流程如
图 ? 所示。
首先,设置仿真次数Counts一1000,每次随
图 7 单星测量误差影响的仿真流程图
机选取载体平台所在的地理位置(A,g),载体
Fig. 7 Flow chart of simulation of single star
measurement error effect
平台的方位角As作为定位定向真值。其中,^在
光轴在载体坐标系中的矢量,通过坐标变换可以
得到视场光轲AxiVec在天球坐标系中的矢量。
根据光轴挡向AxiVec和视场的大小,从星
表 中 提取每个视场内的恒星集合Star.HTH
真对象为三视场定位定向算法,故仿真忽略星图
识别过程,直接集合视场内的星点并根据时间信
息荻得ITRS坐标系中的矢量Stiarirass,再根据定
位定向真值信息获得载体坐标系中的矢量Starb。
在不同的仿真条件下对Siarb中的星点矢量位置
加人正态分布的星敏感器单星测量误差,模拟观
测星点矢量。最后,使用观测星与导航星完成定
位定向并记录定位定向真值及仿真结果,即完成
一次定位定向,CountsW,1;重复此过程直至
Counts为0,仿真过程结束。
表 2 单星测量误差对定位定向的影响
Tab. 2 Effect of single star measurement error on
positioning and orientation
AEE家位诵蔡均值/口定向误差均值/,
1 9.214 2 0.3590
2 18. 315 6 0.744 2
3 27.076 6 1.073 3
4 38.442 8 1.531 3
5 45.975 2 1,805 4
从表2的仿真结果中可以看出,定位定向误差
随星敏感器单星测量误差的增大而增大。当单星
测量误差达到5时,定位误差均值为45.9752m,
定向误差均值为1.8054“,说明在单星测量误差较
大时,本算法仍能够得到较高精度的定位定向
结果。
5.2“野外实验与统果
图 8 为三视场天文定位定向系统的简易实验
平台。该原理样机的系统参数如下:3个视场视
轴在水平面的投影夹角为120.,高度角为45“;光
光波段的探测能力约为7等星。
图 8 三视场定位定向设备简易实验平台
Fig. 8 Experiment platform of positioning and
orientation equipment with three FOVs
图 9 三视在系统野外实验定位定向结果
Fig. 9 Field experiment results of positioning and
orientation system with three FOVs
实验前首先将载体平台水平放置于地面,使用
水平仪调平,此时可认为载体平台倾角为(0“,0“)。
使用GPS测量地理位置为(125“24「15.353"E,
43°50'42.547“N),GPS定位精度较高,故将此位
置作为系统位置的标定值。通过观测已知方位的
北极星标定系统平台,确定平台的方位角为
37.2576,此数据作为系统方位的标定值。实验
过程中,时间间隔1s采集一帧星图图像进行定
位定向解算,整个实验过程持续1000s。
图 9 中的3幅图分别为1000次定位定向实
验的经度、纬度和方位角的实验结果。统计结果
BR:定位误差为151.6240m,均方差为
42.8603m,定向误差为4.6304,均方差为
0.7352.。从图中可以看出,结果的均值与标定
值有一定的偏差,这是由载体平台的水平标校过
程存在误差所致,此误差在单帧定位中属于系统
误差,使用高精度的倾角测量设备可减小此误差。
野外实验结果表明,本文的算法可以满足三
视场天文导航系统高精度定位定向的要求,定位
定向均方差较小,说明算法是稳定高效的。
5“结“论
本文在分析天文定位定向概念及三视场天文
定位定向系统工作原理的基础上,提出了一种基
于最小损失函数的天文定位定向算法。该算法能
够同时解算地理位置和载体方位角信息。然后,分
析了三视场系统的定位定向性能优势。最后,就载
体平台倾角测量误差和星敏感器单星测量误差对
定位定向的影响进行了仿真分析,并进行了外场
实验。实验结果表明,使用本文算法的三视场天
文定位定向系统的定位精度为151.6240my,
向精度为4.6304“,且定位定向结果稳定,可以实
现高精度的天文定位定向。
